(window["webpackJsonpthree.quarks-editor"]=window["webpackJsonpthree.quarks-editor"]||[]).push([[0],{208:function(e,t,n){e.exports=n(417)},236:function(e,t,n){},400:function(e,t,n){},401:function(e,t,n){},402:function(e,t,n){},405:function(e,t,n){},406:function(e,t,n){},407:function(e,t,n){},417:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(18),o=n.n(i),s=n(1),l=n(4),c=n(5),u=n(6),d=n(424),p=n(463),m=n(453),h=n(448),v=n(451),f=n(74),w=n(423),g=n(449),y=n(72),b=n.n(y),S=n(194),O=n.n(S),C=Object(h.a)((function(e){return{root:{flexGrow:1},menuIcon:{marginRight:e.spacing(2)},menuButton:{marginRight:e.spacing(1)},title:{marginRight:e.spacing(1)}}})),E=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).fileRef=void 0,a.openFileDialog=function(e){a.fileRef.current&&a.fileRef.current.click()},a.importFile=function(e){e.target.files&&a.props.onImport(e.target.files)},a.openDemo=function(e){a.props.onOpenDemo(e)},a.handleMenuClick=function(e){console.log(e.currentTarget),a.setState({anchorEl:e.currentTarget})},a.handleMenuClose=function(){a.setState({anchorEl:void 0})},a.state={anchorEl:void 0},a.fileRef=r.createRef(),a}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.createElement("div",{className:t.root},r.createElement(g.a,{position:"static"},r.createElement(v.a,{variant:"dense"},r.createElement(w.a,{edge:"start",className:t.menuIcon,color:"inherit","aria-label":"menu"},r.createElement(O.a,null)),r.createElement(f.a,{variant:"h6",className:t.title},"Three.Quarks"),r.createElement(d.a,{color:"inherit",className:t.menuButton,"aria-controls":"simple-menu","aria-haspopup":"true",onClick:this.handleMenuClick,id:"file-button"},"File"),r.createElement(p.a,{id:"file-menu",anchorEl:this.state.anchorEl,keepMounted:!0,open:Boolean(this.state.anchorEl&&"file-button"===this.state.anchorEl.id),onClose:this.handleMenuClose},r.createElement(m.a,null,"New"),r.createElement(m.a,{onClick:this.openFileDialog},"Open"),r.createElement(m.a,{onClick:this.props.onSaveAs},"Download"),r.createElement("input",{ref:this.fileRef,type:"file",id:"fileElem",multiple:!0,accept:"application/json",style:{display:"none"},onChange:this.importFile})),r.createElement(d.a,{color:"inherit",className:t.menuButton,"aria-controls":"simple-menu","aria-haspopup":"true",onClick:this.handleMenuClick,id:"demo-button"},"Demo"),r.createElement(p.a,{id:"demo-menu",anchorEl:this.state.anchorEl,keepMounted:!0,open:Boolean(this.state.anchorEl&&"demo-button"===this.state.anchorEl.id),onClose:this.handleMenuClose},r.createElement(m.a,{onClick:function(){return e.openDemo(0)}},"Demo 1"),r.createElement(m.a,{onClick:function(){return e.openDemo(1)}},"Demo 2"),r.createElement(m.a,{onClick:function(){return e.openDemo(2)}},"Demo 3"),r.createElement(m.a,{onClick:function(){return e.openDemo(3)}},"Demo 4"),r.createElement(m.a,{onClick:function(){return e.openDemo(4)}},"Demo 5"),r.createElement(m.a,{onClick:function(){return e.openDemo(5)}},"Demo Explosion")))))}}]),n}(r.PureComponent),x=b()(C,{withTheme:!0})(E),j=n(195),k=n.n(j),P={isWebGLAvailable:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(t){return!1}},isWebGL2Available:function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(t){return!1}},getWebGLErrorMessage:function(){return this.getErrorMessage(1)},getWebGL2ErrorMessage:function(){return this.getErrorMessage(2)},getErrorMessage:function(e){var t={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext},n='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>',r=document.createElement("div");return r.id="webglmessage",r.style.fontFamily="monospace",r.style.fontSize="13px",r.style.fontWeight="normal",r.style.textAlign="center",r.style.background="#fff",r.style.color="#000",r.style.padding="1.5em",r.style.width="400px",r.style.margin="5em auto 0",n=(n=t[e]?n.replace("$0","graphics card"):n.replace("$0","browser")).replace("$1",{1:"WebGL",2:"WebGL 2"}[e]),r.innerHTML=n,r}},B=n(2),T=n(196),M=n(19),z=n(15),N=n(8);function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L,F="\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec4 vColor;\n\nvoid main() {\n\n    #include <clipping_planes_fragment>\n    \n    vec3 outgoingLight = vec3( 0.0 );\n    vec4 diffuseColor = vColor;\n    \n    #include <logdepthbuf_fragment>\n    \n    #ifdef USE_MAP\n    vec4 texelColor = texture2D( map, vUv);\n    diffuseColor *= texelColor;\n    #endif\n\n    outgoingLight = diffuseColor.rgb;\n\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    \n    #include <tonemapping_fragment>\n\n}\n",R="\n\n#include <uv_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 offset;\nattribute float rotation;\nattribute float size;\nattribute vec4 color;\nattribute float uvTile;\n\nvarying vec4 vColor;\n\n#ifdef UV_TILE\nuniform vec2 tileCount;\n#endif\n\nvoid main() {\n\n    #ifdef UV_TILE\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\n    #else\n        #include <uv_vertex>\n    #endif\n\t\n\t#ifdef WORLD_SPACE\n\t    vec4 mvPosition = viewMatrix * vec4( offset, 1.0 );\n\t#else\n\t    vec4 mvPosition = modelViewMatrix * vec4( offset, 1.0 );\n\t#endif\n\t\n    vec2 alignedPosition = ( position.xy ) * size;\n    \n    vec2 rotatedPosition;\n    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n    \n    mvPosition.xy += rotatedPosition;\n\n\tvColor = color;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",D="\n\n#include <uv_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 offset;\nattribute float rotation;\nattribute float size;\nattribute vec4 color;\nattribute float uvTile;\n\nvarying vec4 vColor;\n\n#ifdef UV_TILE\nuniform vec2 tileCount;\n#endif\n\nvoid main() {\n\n    #ifdef UV_TILE\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\n    #else\n        #include <uv_vertex>\n    #endif\n\t\n    vec2 alignedPosition = ( position.xy ) * size;\n    \n    vec2 rotatedPosition;\n    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n    \n\t#ifdef WORLD_SPACE\n\t    vec4 mvPosition = viewMatrix * vec4( offset + vec3(rotatedPosition, 0.0), 1.0 );\n\t#else\n\t    vec4 mvPosition = modelViewMatrix * vec4( offset + vec3(rotatedPosition, 0.0), 1.0 );\n\t#endif\n\n\tvColor = color;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",V="\n\n#include <uv_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 offset;\nattribute float rotation;\nattribute float size;\nattribute vec4 color;\nattribute vec3 velocity;\nattribute float uvTile;\n\nvarying vec4 vColor;\n\n#ifdef UV_TILE\nuniform vec2 tileCount;\n#endif\n\nuniform float speedFactor;\n\nvoid main() {\n\n    #ifdef UV_TILE\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\n    #else\n        #include <uv_vertex>\n    #endif\n\t\n\t#ifdef WORLD_SPACE\n\t    vec4 mvPosition = viewMatrix * vec4( offset, 1.0 );\n        vec3 viewVelocity = vec3(viewMatrix * vec4(velocity, 1.0));\n\t#else\n\t    vec4 mvPosition = modelViewMatrix * vec4( offset, 1.0 );\n        vec3 viewVelocity = vec3(modelViewMatrix * vec4(velocity, 1.0));\n\t#endif\n\n    vec3 scaledPos = vec3(position.xy * size, position.z);\n    mvPosition.xyz += scaledPos + dot(scaledPos, viewVelocity) * viewVelocity / length(viewVelocity) * speedFactor;\n\n\tvColor = color;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n";!function(e){e[e.BillBoard=0]="BillBoard",e[e.StretchedBillBoard=1]="StretchedBillBoard",e[e.LocalSpaceBillBoard=2]="LocalSpaceBillBoard"}(L||(L={}));var A=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e,r){var a;Object(s.a)(this,n),a=t.call(this),I(Object(z.a)(a),"type","ParticleEmitter"),I(Object(z.a)(a),"system",void 0),I(Object(z.a)(a),"geometry",void 0),I(Object(z.a)(a),"material",void 0),I(Object(z.a)(a),"interleavedBuffer",void 0),I(Object(z.a)(a),"rotationBuffer",void 0),I(Object(z.a)(a),"sizeBuffer",void 0),I(Object(z.a)(a),"colorBuffer",void 0),I(Object(z.a)(a),"offsetBuffer",void 0),I(Object(z.a)(a),"velocityBuffer",void 0),I(Object(z.a)(a),"tiling",void 0),I(Object(z.a)(a),"uvTileBuffer",void 0),I(Object(z.a)(a),"renderMode",void 0),I(Object(z.a)(a),"speedFactor",void 0),a.system=e,a.geometry=new N.r,a.renderMode=r.renderMode||L.BillBoard,a.speedFactor=r.speedFactor||1;var i=new Float32Array(r.instancingGeometry||[-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),o={},l={};if(a.interleavedBuffer=new N.s(i,5),a.geometry.setIndex([0,1,2,0,2,3]),a.geometry.setAttribute("position",new N.t(a.interleavedBuffer,3,0,!1)),a.geometry.setAttribute("uv",new N.t(a.interleavedBuffer,2,3,!1)),a.offsetBuffer=new N.q(new Float32Array(3*e.maxParticle),3),a.offsetBuffer.setUsage(N.j),a.geometry.setAttribute("offset",a.offsetBuffer),a.colorBuffer=new N.q(new Float32Array(4*e.maxParticle),4),a.offsetBuffer.setUsage(N.j),a.geometry.setAttribute("color",a.colorBuffer),a.rotationBuffer=new N.q(new Float32Array(e.maxParticle),1),a.offsetBuffer.setUsage(N.j),a.geometry.setAttribute("rotation",a.rotationBuffer),a.sizeBuffer=new N.q(new Float32Array(e.maxParticle),1),a.offsetBuffer.setUsage(N.j),a.geometry.setAttribute("size",a.sizeBuffer),a.tiling=!0,r.texture){l.USE_MAP="",l.USE_UV="",o.map=new N.L(r.texture),o.uvTransform=new N.L((new N.A).copy(r.texture.matrix));var c=r.uTileCount||1,u=r.vTileCount||1;a.system.tileCount=c*u,a.tiling&&(a.uvTileBuffer=new N.q(new Float32Array(e.maxParticle),1),a.uvTileBuffer.setUsage(N.j),a.geometry.setAttribute("uvTile",a.uvTileBuffer),l.UV_TILE="",o.tileCount=new N.L(new N.M(c,u)))}if((void 0===r.worldSpace||r.worldSpace)&&(l.WORLD_SPACE=""),a.renderMode===L.BillBoard||a.renderMode===L.LocalSpaceBillBoard){var d,p;a.renderMode===L.LocalSpaceBillBoard?(d=D,p=N.i):(d=R,p=N.n),a.material=new N.I({uniforms:o,defines:l,vertexShader:d,fragmentShader:F,transparent:!0,depthWrite:!1,blending:r.blending||N.a,side:p})}else{if(a.renderMode!==L.StretchedBillBoard)throw new Error("render mode unavailable");a.velocityBuffer=new N.q(new Float32Array(3*e.maxParticle),3),a.velocityBuffer.setUsage(N.j),a.geometry.setAttribute("velocity",a.velocityBuffer),o.speedFactor=new N.L(r.speedFactor),a.material=new N.I({uniforms:o,defines:l,vertexShader:V,fragmentShader:F,transparent:!0,depthWrite:!1,blending:r.blending||N.a})}return a.frustumCulled=!1,a}return Object(l.a)(n,[{key:"update",value:function(){var e=this.system.particles,t=this.system.particleNum;this.geometry.instanceCount=t;for(var n=0;n<t;n++){var r=e[n];this.offsetBuffer.setXYZ(n,r.position.x,r.position.y,r.position.z),this.colorBuffer.setXYZW(n,r.color.x,r.color.y,r.color.z,r.color.w),this.rotationBuffer.setX(n,r.rotation),this.sizeBuffer.setX(n,r.size),this.renderMode===L.StretchedBillBoard&&this.velocityBuffer.setXYZ(n,r.velocity.x,r.velocity.y,r.velocity.z),this.tiling&&this.uvTileBuffer.setX(n,r.uvTile)}t>0&&(this.offsetBuffer.updateRange.count=3*t,this.offsetBuffer.needsUpdate=!0,this.colorBuffer.updateRange.count=4*t,this.colorBuffer.needsUpdate=!0,this.rotationBuffer.updateRange.count=t,this.rotationBuffer.needsUpdate=!0,this.sizeBuffer.updateRange.count=t,this.sizeBuffer.needsUpdate=!0,this.renderMode===L.StretchedBillBoard&&(this.velocityBuffer.updateRange.count=3*t,this.velocityBuffer.needsUpdate=!0),this.tiling&&(this.uvTileBuffer.updateRange.count=t,this.uvTileBuffer.needsUpdate=!0))}},{key:"dispose",value:function(){this.geometry.dispose()}},{key:"extractFromCache",value:function(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),null!==this.system&&(r.ps=this.system.toJSON(e)),this.children.length>0){r.children=[];for(var a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(t){var i=this.extractFromCache(e.geometries),o=this.extractFromCache(e.materials),s=this.extractFromCache(e.textures),l=this.extractFromCache(e.images);i.length>0&&(n.geometries=i),o.length>0&&(n.materials=o),s.length>0&&(n.textures=s),l.length>0&&(n.images=l)}return n.object=r,n}}]),n}(N.B),_=function e(){Object(s.a)(this,e),I(this,"startSpeed",0),I(this,"startColor",new N.O),I(this,"startSize",1),I(this,"velocity",new N.N),I(this,"age",0),I(this,"life",1),I(this,"angularVelocity",void 0),I(this,"position",new N.N),I(this,"rotation",0),I(this,"size",1),I(this,"color",new N.O),I(this,"uvTile",0)},J=function(){function e(t){Object(s.a)(this,e),this.value=t,I(this,"type",void 0),this.type="value"}return Object(l.a)(e,[{key:"genValue",value:function(){return this.value}},{key:"toJSON",value:function(){return{type:"ConstantValue",value:this.value}}}],[{key:"fromJSON",value:function(t){return new e(t.value)}}]),e}(),U=function(){function e(t,n){Object(s.a)(this,e),this.a=t,this.b=n,I(this,"type",void 0),this.type="value"}return Object(l.a)(e,[{key:"genValue",value:function(){return N.z.lerp(this.a,this.b,Math.random())}},{key:"toJSON",value:function(){return{type:"IntervalValue",a:this.a,b:this.b}}}],[{key:"fromJSON",value:function(t){return new e(t.a,t.b)}}]),e}(),W=function(){function e(){Object(s.a)(this,e),I(this,"functions",void 0),this.functions=new Array}return Object(l.a)(e,[{key:"findFunction",value:function(e){for(var t=0,n=0,r=this.functions.length-1;n+1<r;)if(t=(n+r)/2,e<this.getStartX(t))r=t-1;else{if(!(e>this.getEndX(t)))return t;n=t+1}for(var a=n;a<=r;a++)if(e>=this.functions[a][1]&&e<=this.getEndX(a))return a;return-1}},{key:"getStartX",value:function(e){return this.functions[e][1]}},{key:"setStartX",value:function(e,t){e>0&&(this.functions[e][1]=t)}},{key:"getEndX",value:function(e){return e+1<this.functions.length?this.functions[e+1][1]:1}},{key:"setEndX",value:function(e,t){e+1<this.functions.length&&(this.functions[e+1][1]=t)}},{key:"getFunction",value:function(e){return this.functions[e][0]}},{key:"setFunction",value:function(e,t){this.functions[e][0]=t}},{key:"numOfFunctions",get:function(){return this.functions.length}}]),e}(),G=function(){function e(t,n,r,a){Object(s.a)(this,e),I(this,"p",void 0),this.p=[t,n,r,a]}return Object(l.a)(e,[{key:"genValue",value:function(e){var t=e*e,n=e*e*e,r=1-e,a=r*r,i=a*r;return this.p[0]*i+this.p[1]*a*e*3+this.p[2]*r*t*3+this.p[3]*n}},{key:"derivativeCoefficients",value:function(e){for(var t=[],n=e,r=n.length-1;r>0;r--){for(var a=[],i=0;i<r;i++){var o=r*(n[i+1]-n[i]);a.push(o)}t.push(a),n=a}return t}},{key:"getSlope",value:function(e){var t=this.derivativeCoefficients(this.p)[0],n=1-e,r=n*e*2,a=e*e;return n*n*t[0]+r*t[1]+a*t[2]}},{key:"controlCurve",value:function(e,t){this.p[1]=e/3+this.p[0],this.p[2]=this.p[3]-t/3}},{key:"hull",value:function(e){var t,n=this.p,r=[],a=[],i=0,o=0,s=0;for(a[i++]=n[0],a[i++]=n[1],a[i++]=n[2],a[i++]=n[3];n.length>1;){for(r=[],o=0,s=n.length-1;o<s;o++)t=e*n[o]+(1-e)*n[o+1],a[i++]=t,r.push(t);n=r}return a}},{key:"split",value:function(t){var n=this.hull(t);return{left:new e(n[0],n[4],n[7],n[9]),right:new e(n[9],n[8],n[6],n[3]),span:n}}},{key:"clone",value:function(){return new e(this.p[0],this.p[1],this.p[2],this.p[3])}},{key:"toJSON",value:function(){return{p0:this.p[0],p1:this.p[1],p2:this.p[2],p3:this.p[3]}}}],[{key:"fromJSON",value:function(t){return new e(t.p0,t.p1,t.p2,t.p3)}}]),e}(),H=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[new G(0,1/3,1/3*2,1),0]];return Object(s.a)(this,n),e=t.call(this),I(Object(z.a)(e),"type",void 0),e.type="function",e.functions=r,e}return Object(l.a)(n,[{key:"genValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.findFunction(e);return-1===t?(console.error(e),0):this.functions[t][0].genValue((e-this.getStartX(t))/(this.getEndX(t)-this.getStartX(t)))}},{key:"toSVG",value:function(e,t){if(t<1)return"";for(var n=["M",0,this.functions[0][0].p[0]].join(" "),r=1/t;r<=1;r+=1/t)n=[n,"L",r*e,this.genValue(r)].join(" ");return n}},{key:"toJSON",value:function(){return{type:"PiecewiseBezier",functions:this.functions.map((function(e){var t=Object(M.a)(e,2),n=t[0],r=t[1];return{function:n.toJSON(),start:r}}))}}}],[{key:"fromJSON",value:function(e){return new n(e.functions.map((function(e){return[G.fromJSON(e.function),e.start]})))}}]),n}(W);function X(e){switch(e.type){case"ConstantValue":return J.fromJSON(e);case"IntervalValue":return U.fromJSON(e);case"PiecewiseBezier":return H.fromJSON(e);default:return new J(0)}}var q=function(e){return{r:e.x,g:e.y,b:e.z,a:e.w}},Y=function(e){return new N.O(e.r,e.g,e.b,e.a)},$=function(){function e(t,n){Object(s.a)(this,e),this.a=t,this.b=n,I(this,"type",void 0),this.type="value"}return Object(l.a)(e,[{key:"genColor",value:function(e){var t=Math.random();return e.copy(this.a).lerp(this.b,t)}},{key:"toJSON",value:function(){return{type:"RandomColor",a:q(this.a),b:q(this.b)}}}],[{key:"fromJSON",value:function(t){return new e(Y(t.a),Y(t.b))}}]),e}(),K=function(){function e(t,n){Object(s.a)(this,e),this.a=t,this.b=n,I(this,"type",void 0),this.type="function"}return Object(l.a)(e,[{key:"genColor",value:function(e,t){return e.copy(this.a).lerp(this.b,t)}},{key:"toJSON",value:function(){return{type:"ColorRange",a:q(this.a),b:q(this.b)}}}],[{key:"fromJSON",value:function(t){return new e(Y(t.a),Y(t.b))}}]),e}(),Z=function(){function e(t){Object(s.a)(this,e),this.color=t,I(this,"type",void 0),this.type="value"}return Object(l.a)(e,[{key:"genColor",value:function(e){return e.copy(this.color)}},{key:"toJSON",value:function(){return{type:"ConstantColor",color:q(this.color)}}}],[{key:"fromJSON",value:function(t){return new e(Y(t.color))}}]),e}();function Q(e){switch(e.type){case"ConstantColor":return Z.fromJSON(e);case"ColorRange":return K.fromJSON(e);case"RandomColor":return $.fromJSON(e);default:return new Z(new N.O(1,1,1,1))}}var ee=function(){function e(t){Object(s.a)(this,e),this.func=t,I(this,"type","ColorOverLife")}return Object(l.a)(e,[{key:"initialize",value:function(e){}},{key:"update",value:function(e,t){this.func.genColor(e.color,e.age/e.life).dot(e.startColor)}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}}]),e}(),te=function(){function e(t){Object(s.a)(this,e),this.angularVelocityFunc=t,I(this,"type","RotationOverLife")}return Object(l.a)(e,[{key:"initialize",value:function(e){"value"===this.angularVelocityFunc.type?e.angularVelocity=this.angularVelocityFunc.genValue():e.angularVelocity=0}},{key:"update",value:function(e,t){"value"===this.angularVelocityFunc.type?e.rotation+=t*e.angularVelocity:e.rotation+=t*this.angularVelocityFunc.genValue(e.age/e.life)}},{key:"toJSON",value:function(){return{type:this.type,func:this.angularVelocityFunc.toJSON()}}}]),e}(),ne=function(){function e(t){Object(s.a)(this,e),this.func=t,I(this,"type","SizeOverLife")}return Object(l.a)(e,[{key:"initialize",value:function(e){}}]),Object(l.a)(e,[{key:"update",value:function(e){e.size=e.startSize*this.func.genValue(e.age/e.life)}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}}]),e}(),re=function(){function e(t){Object(s.a)(this,e),this.func=t,I(this,"type","FrameOverLife")}return Object(l.a)(e,[{key:"initialize",value:function(e){}},{key:"update",value:function(e,t){e.uvTile=Math.floor(this.func.genValue(e.age/e.life))}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}}]),e}();var ae=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),I(this,"radius",void 0),I(this,"arc",void 0),I(this,"thickness",void 0),I(this,"angle",void 0),this.radius=t.radius||10,this.arc=t.arc||2*Math.PI,this.thickness=t.thickness||1,this.angle=t.angle||Math.PI/6}return Object(l.a)(e,[{key:"initialize",value:function(e){var t=Math.random(),n=N.z.lerp(1-this.thickness,1,Math.random()),r=t*this.arc,a=Math.sqrt(n),i=Math.sin(r),o=Math.cos(r);e.position.x=a*o,e.position.y=a*i,e.position.z=0;var s=this.angle*a;e.velocity.set(0,0,Math.cos(s)).addScaledVector(e.position,Math.sin(s)).multiplyScalar(e.startSpeed),e.position.multiplyScalar(this.radius)}},{key:"toJSON",value:function(){return{type:"cone",radius:this.radius,arc:this.arc,thickness:this.thickness,angle:this.angle}}}]),e}(),ie=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),I(this,"radius",void 0),I(this,"arc",void 0),I(this,"thickness",void 0),this.radius=t.radius||10,this.arc=t.arc||2*Math.PI,this.thickness=t.thickness||1}return Object(l.a)(e,[{key:"initialize",value:function(e){var t=Math.random(),n=Math.random(),r=N.z.lerp(1-this.thickness,1,Math.random()),a=t*this.arc,i=Math.acos(2*n-1),o=Math.cbrt(r),s=Math.sin(a),l=Math.cos(a),c=Math.sin(i),u=Math.cos(i);e.position.x=o*c*l,e.position.y=o*c*s,e.position.z=o*u,e.velocity.setScalar(0).addScaledVector(e.position,e.startSpeed),e.position.multiplyScalar(this.radius)}},{key:"toJSON",value:function(){return{type:"sphere",radius:this.radius,arc:this.arc,thickness:this.thickness}}}]),e}(),oe=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"initialize",value:function(e){var t=Math.random(),n=Math.random(),r=t*Math.PI*2,a=Math.acos(2*n-1),i=Math.cbrt(Math.random()),o=Math.sin(r),s=Math.cos(r),l=Math.sin(a),c=Math.cos(a);e.velocity.x=i*l*s,e.velocity.y=i*l*o,e.velocity.z=i*c,e.velocity.multiplyScalar(e.startSpeed),e.position.setScalar(0)}},{key:"toJSON",value:function(){return{type:"point"}}}]),e}(),se=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),I(this,"radius",void 0),I(this,"arc",void 0),I(this,"thickness",void 0),I(this,"angle",void 0),this.radius=t.radius||10,this.arc=t.arc||2*Math.PI,this.thickness=t.thickness||1,this.angle=t.angle||Math.PI/6}return Object(l.a)(e,[{key:"initialize",value:function(e){var t=Math.random(),n=N.z.lerp(this.thickness,1,Math.random()),r=t*this.arc,a=Math.sqrt(n),i=Math.sin(r),o=Math.cos(r);e.position.x=a*o,e.position.y=a*i,e.position.z=0;var s=this.angle*a;e.velocity.set(0,0,Math.cos(s)).addScaledVector(e.position,Math.sin(s)).multiplyScalar(e.startSpeed),e.position.multiplyScalar(this.radius)}},{key:"toJSON",value:function(){return{type:"donut",radius:this.radius,arc:this.arc,thickness:this.thickness,angle:this.angle}}}]),e}(),le=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),I(this,"autoDestroy",void 0),I(this,"looping",void 0),I(this,"duration",void 0),I(this,"maxParticle",void 0),I(this,"startLife",void 0),I(this,"startSpeed",void 0),I(this,"startRotation",void 0),I(this,"startSize",void 0),I(this,"startColor",void 0),I(this,"startTileIndex",void 0),I(this,"emissionOverTime",void 0),I(this,"emissionOverDistance",void 0),I(this,"emissionBursts",void 0),I(this,"tileCount",1),I(this,"worldSpace",void 0),I(this,"particleNum",void 0),I(this,"burstIndex",void 0),I(this,"burstWaveIndex",void 0),I(this,"time",void 0),I(this,"paused",void 0),I(this,"waitEmiting",void 0),I(this,"emitEnded",void 0),I(this,"markForDestroy",void 0),I(this,"behaviors",void 0),I(this,"particles",void 0),I(this,"emitterShape",void 0),I(this,"emitter",void 0),I(this,"normalMatrix",new N.A),this.autoDestroy=void 0!==t.autoDestroy&&t.autoDestroy,this.duration=t.duration||1,this.maxParticle=t.maxParticle||100,this.looping=void 0===t.looping||t.looping,this.startLife=t.startLife||new J(5),this.startSpeed=t.startSpeed||new J(0),this.startRotation=t.startRotation||new J(0),this.startSize=t.startSize||new J(1),this.startColor=t.startColor||new Z(new N.O(1,1,1,1)),this.emissionOverTime=t.emissionOverTime||new J(10),this.emissionOverDistance=t.emissionOverDistance||new J(0),this.emissionBursts=t.emissionBursts||[],this.emitterShape=t.shape||new ie,this.behaviors=t.behaviors||new Array,this.worldSpace=void 0!==t.worldSpace&&t.worldSpace,this.particles=new Array,this.startTileIndex=t.startTileIndex||0,this.emitter=new A(this,t),this.particleNum=0,this.burstIndex=0,this.burstWaveIndex=0,this.time=0,this.paused=!1,this.waitEmiting=0,this.emitEnded=!1,this.markForDestroy=!1}return Object(l.a)(e,[{key:"texture",get:function(){return this.emitter.material.uniforms.map.value},set:function(e){this.emitter.material.uniforms.map.value=e}},{key:"uTileCount",get:function(){return this.emitter.material.uniforms.tileCount.value.x},set:function(e){this.emitter.material.uniforms.tileCount.value.x=e}},{key:"vTileCount",get:function(){return this.emitter.material.uniforms.tileCount.value.y},set:function(e){this.emitter.material.uniforms.tileCount.value.y=e}},{key:"renderMode",get:function(){return this.emitter.renderMode}},{key:"speedFactor",get:function(){return this.emitter.material.uniforms.speedFactor.value},set:function(e){this.emitter.material.uniforms.speedFactor.value=e}},{key:"blending",get:function(){return this.emitter.material.blending},set:function(e){this.emitter.material.blending=e}}]),Object(l.a)(e,[{key:"pause",value:function(){this.paused=!0}},{key:"play",value:function(){this.paused=!1}},{key:"spawn",value:function(){for(;this.particleNum>=this.particles.length;)this.particles.push(new _);this.particleNum++;var e=this.particles[this.particleNum-1];this.startColor.genColor(e.startColor,this.time),e.color.copy(e.startColor),e.startSpeed=this.startSpeed.genValue(this.time),e.life=this.startLife.genValue(this.time),e.age=0,e.rotation=this.startRotation.genValue(this.time),e.startSize=e.size=this.startSize.genValue(this.time),e.uvTile=this.startTileIndex,this.emitterShape.initialize(e),this.worldSpace&&(e.position.applyMatrix4(this.emitter.matrixWorld),e.velocity.applyMatrix3(this.normalMatrix));for(var t=0;t<this.behaviors.length;t++)this.behaviors[t].initialize(e)}},{key:"endEmit",value:function(){this.emitEnded=!0,this.autoDestroy&&(this.markForDestroy=!0)}},{key:"dispose",value:function(){this.emitter.dispose(),this.emitter.parent&&this.emitter.parent.remove(this.emitter)}},{key:"restart",value:function(){this.paused=!1,this.particleNum=0,this.burstIndex=0,this.burstWaveIndex=0,this.time=0,this.waitEmiting=0,this.emitEnded=!1,this.markForDestroy=!1}},{key:"update",value:function(e){if(e>.1&&(e=.1),!this.paused)if(this.emitEnded&&0===this.particleNum)this.markForDestroy&&this.emitter.parent&&this.dispose();else{this.time>this.duration&&(this.looping?this.time-=this.duration:this.emitEnded||this.endEmit()),this.normalMatrix.getNormalMatrix(this.emitter.matrixWorld);for(var t=0;t<this.particleNum;t++){var n=this.particles[t];n.age>=n.life&&(this.particles[t]=this.particles[this.particleNum-1],this.particles[this.particleNum-1]=n,this.particleNum--,t--)}for(;this.waitEmiting>0&&this.particleNum<this.maxParticle&&!this.emitEnded;)this.spawn(),this.waitEmiting--;for(;this.burstIndex<this.emissionBursts.length&&this.emissionBursts[this.burstIndex].time<=this.time;){if(Math.random()<this.emissionBursts[this.burstIndex].probability)for(var r=this.emissionBursts[this.burstIndex].count;r>0&&this.particleNum<this.maxParticle;)this.spawn(),r--;this.burstIndex++}for(var a=0;a<this.particleNum;a++){for(var i=this.particles[a],o=0;o<this.behaviors.length;o++)this.behaviors[o].update(i,e);i.position.addScaledVector(i.velocity,e),i.age+=e}this.emitter.update(),this.emitEnded||(this.waitEmiting+=e*this.emissionOverTime.genValue(this.time)),this.time+=e}}},{key:"toJSON",value:function(e){if(this.texture.toJSON(e),void 0!==this.texture.image){var t=this.texture.image;e.images[t.uuid]={uuid:t.uuid,url:this.texture.name}}return{autoDestroy:this.autoDestroy,looping:this.looping,duration:this.duration,maxParticle:this.maxParticle,shape:this.emitterShape.toJSON(),startLife:this.startLife.toJSON(),startSpeed:this.startSpeed.toJSON(),startRotation:this.startRotation.toJSON(),startSize:this.startSize.toJSON(),startColor:this.startColor.toJSON(),emissionOverTime:this.emissionOverTime.toJSON(),emissionOverDistance:this.emissionOverDistance.toJSON(),emissionBursts:this.emissionBursts,instancingGeometry:Array.from(this.emitter.interleavedBuffer.array),renderMode:this.renderMode,speedFactor:this.renderMode===L.StretchedBillBoard?this.speedFactor:0,texture:this.texture.uuid,startTileIndex:this.startTileIndex,uTileCount:this.uTileCount,vTileCount:this.vTileCount,blending:this.blending,behaviors:this.behaviors.map((function(e){return e.toJSON()})),worldSpace:this.worldSpace}}},{key:"addBehavior",value:function(e){this.behaviors.push(e)}}],[{key:"fromJSON",value:function(t,n){var r;switch(t.shape.type){case"cone":r=new ae(t.shape);break;case"donut":r=new se(t.shape);break;case"point":r=new oe;break;case"sphere":r=new ie(t.shape);break;default:r=new oe}return new e({autoDestroy:t.autoDestroy,looping:t.looping,duration:t.duration,maxParticle:t.maxParticle,shape:r,startLife:X(t.startLife),startSpeed:X(t.startSpeed),startRotation:X(t.startRotation),startSize:X(t.startSize),startColor:Q(t.startColor),emissionOverTime:X(t.emissionOverTime),emissionOverDistance:X(t.emissionOverDistance),emissionBursts:t.emissionBursts,instancingGeometry:t.instancingGeometry,renderMode:t.renderMode,speedFactor:t.speedFactor,texture:n[t.texture],startTileIndex:t.startTileIndex,uTileCount:t.uTileCount,vTileCount:t.vTileCount,blending:t.blending,behaviors:t.behaviors.map((function(e){return function(e){switch(e.type){case"ColorOverLife":return new ee(Q(e.func));case"RotationOverLife":return new te(X(e.func));case"SizeOverLife":return new ne(X(e.func));case"FrameOverLife":return new re(X(e.func));default:return new ee(new K(new N.O(1,1,1,1),new N.O(1,1,1,1)))}}(e)})),worldSpace:t.worldSpace})}}]),e}(),ce={UVMapping:N.K,CubeReflectionMapping:N.c,CubeRefractionMapping:N.d,EquirectangularReflectionMapping:N.k,EquirectangularRefractionMapping:N.l,CubeUVReflectionMapping:N.f,CubeUVRefractionMapping:N.g},ue={RepeatWrapping:N.H,ClampToEdgeWrapping:N.b,MirroredRepeatWrapping:N.C},de={NearestFilter:N.D,NearestMipmapNearestFilter:N.F,NearestMipmapLinearFilter:N.E,LinearFilter:N.u,LinearMipmapNearestFilter:N.w,LinearMipmapLinearFilter:N.v},pe=function(){function e(t){Object(s.a)(this,e),I(this,"manager",void 0),I(this,"crossOrigin","anonymous"),I(this,"path",void 0),I(this,"resourcePath",void 0),this.manager=void 0!==t?t:N.h,this.resourcePath=""}return Object(l.a)(e,[{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"load",value:function(e,t,n,r){var a=this,i=void 0===this.path?N.x.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;var o=new N.m(a.manager);this.path&&o.setPath(this.path),o.load(e,(function(n){var i=null;try{i=JSON.parse(n)}catch(s){return void 0!==r&&r(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}var o=i.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?a.parse(i,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)}},{key:"loadImage",value:function(e,t){var n=this;return n.manager.itemStart(t),e.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}},{key:"parseImages",value:function(e,t){var n={};if(void 0!==e&&e.length>0){var r=new N.y(t),a=new N.p(r);a.setCrossOrigin(this.crossOrigin);for(var i=0,o=e.length;i<o;i++){var s=e[i],l=s.url;if(Array.isArray(l)){n[s.uuid]=[];for(var c=0,u=l.length;c<u;c++){var d=l[c],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:this.resourcePath+d;n[s.uuid].push(this.loadImage(a,p))}}else{p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:this.resourcePath+s.url;n[s.uuid]=this.loadImage(a,p)}}}return n}},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var a=0,i=e.length;a<i;a++){var o,s=e[a];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(t[s.image])?new N.e(t[s.image]):new N.J(t[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=n(s.mapping,ce)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=n(s.wrap[0],ue),o.wrapT=n(s.wrap[1],ue)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=n(s.minFilter,de)),void 0!==s.magFilter&&(o.magFilter=n(s.magFilter,de)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),r[s.uuid]=o}return r}},{key:"parseObject",value:function(e,t){var n;switch(e.type){case"ParticleEmitter":n=le.fromJSON(e.ps,t).emitter;break;case"Group":n=new N.o;break;default:n=new N.G}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(n.matrixAutoUpdate=e.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.layers&&(n.layers.mask=e.layers),void 0!==e.children)for(var r=e.children,a=0;a<r.length;a++)n.add(this.parseObject(r[a],t));return n}},{key:"parse",value:function(e,t){var n=this.parseImages(e.images,(function(){void 0!==t&&t(a)})),r=this.parseTextures(e.textures,n),a=this.parseObject(e.object,r);return void 0!==e.images&&0!==e.images.length||void 0!==t&&t(a),a}}]),e}(),me=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[new K(new N.O(0,0,0,1),new N.O(1,1,1,1)),0]];return Object(s.a)(this,n),e=t.call(this),I(Object(z.a)(e),"type",void 0),e.type="function",e.functions=r,e}return Object(l.a)(n,[{key:"genColor",value:function(e,t){var n=this.findFunction(t);return-1===n?(console.error(t),e.copy(this.functions[0][0].a)):this.getFunction(n).genColor(e,t)}},{key:"toJSON",value:function(){return{type:"Gradient",functions:this.functions.map((function(e){var t=Object(M.a)(e,2),n=t[0],r=t[1];return{function:n.toJSON(),start:r}}))}}}],[{key:"fromJSON",value:function(e){return new n(e.functions.map((function(e){return[K.fromJSON(e.function),e.start]})))}}]),n}(W),he=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n),(e=t.call(this)).particles=void 0,e.smoke=void 0,e.glowBeam=void 0,e.mainBeam=void 0;var r=(new B.t).load("textures/texture1.png");return r.name="textures/texture1.png",e.mainBeam=new le({duration:1,looping:!0,startLife:new U(.1,.15),startSpeed:new J(0),startSize:new J(1.25),startColor:new Z(new B.w(1,1,1,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(40),shape:new ie({radius:1e-4,thickness:1,arc:2*Math.PI}),texture:r,blending:B.a,startTileIndex:0,uTileCount:10,vTileCount:10}),e.mainBeam.addBehavior(new ne(new H([[new G(1,.25,.05,0),0]]))),e.mainBeam.emitter.renderOrder=2,e.mainBeam.emitter.name="mainBeam",e.add(e.mainBeam.emitter),e.glowBeam=new le({duration:1,looping:!0,startLife:new U(.1,.15),startSpeed:new J(0),startSize:new J(3.5),startColor:new Z(new B.w(1,.1509503,.07352942,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(40),shape:new ie({radius:1e-4,thickness:1,arc:2*Math.PI}),texture:r,blending:B.a,startTileIndex:1,uTileCount:10,vTileCount:10}),e.glowBeam.addBehavior(new ne(new H([[new G(1,.95,.75,0),0]]))),e.glowBeam.emitter.renderOrder=2,e.glowBeam.emitter.name="glowBeam",e.add(e.glowBeam.emitter),e.particles=new le({duration:1,looping:!0,startLife:new U(.3,.6),startSpeed:new U(2,5),startSize:new U(.1,.4),startColor:new $(new B.w(1,1,1,.5),new B.w(1,.1509503,.07352942,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(60),shape:new ae({angle:4.8423/180*Math.PI,radius:.3,thickness:1,arc:2*Math.PI}),texture:r,renderMode:L.StretchedBillBoard,speedFactor:.01,blending:B.l,startTileIndex:0,uTileCount:10,vTileCount:10}),e.particles.addBehavior(new ne(new H([[new G(1,.25,.05,0),0]]))),e.particles.emitter.renderOrder=0,e.particles.emitter.rotateY(-Math.PI/2),e.particles.emitter.name="particles",e.add(e.particles.emitter),e.smoke=new le({startLife:new U(.25,.3),startSpeed:new J(0),startSize:new U(.75,1.25),startRotation:new U(0,2*Math.PI),startColor:new Z(new B.w(1,1,1,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(20),shape:new ie({radius:.2,thickness:1}),texture:r,blending:B.l,startTileIndex:2,uTileCount:10,vTileCount:10}),e.smoke.addBehavior(new ne(new H([[new G(1,.95,.75,0),0]]))),e.smoke.addBehavior(new ee(new K(new B.w(1,.1509503,.07352942,1),new B.w(0,0,0,0)))),e.smoke.addBehavior(new te(new U(2*-Math.PI,2*Math.PI))),e.smoke.emitter.renderOrder=-2,e.smoke.emitter.name="smoke",e.add(e.smoke.emitter),e}return Object(l.a)(n,[{key:"update",value:function(e){this.mainBeam.update(e),this.glowBeam.update(e),this.particles.update(e),this.smoke.update(e)}}]),n}(B.h),ve=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n),(e=t.call(this)).beam=void 0,e.muzzle1=void 0,e.muzzle2=void 0,e.flash=void 0,e.smoke=void 0,e.particles=void 0;var r=(new B.t).load("textures/texture1.png");r.name="textures/texture1.png",e.beam=new le({duration:1,looping:!1,startLife:new U(.1,.2),startSpeed:new J(0),startSize:new J(4),startColor:new Z(new B.w(1,.585716,.1691176,1)),worldSpace:!1,maxParticle:10,emissionOverTime:new J(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:r,blending:B.a,startTileIndex:1,uTileCount:10,vTileCount:10}),e.beam.emitter.renderOrder=0,e.beam.emitter.name="beam",e.beam.addBehavior(new ne(new H([[new G(1,.95,.75,0),0]]))),e.add(e.beam.emitter);var a={duration:1,looping:!1,startLife:new U(.1,.2),startSpeed:new J(0),startSize:new U(1,5),startColor:new Z(new B.w(1,1,1,1)),worldSpace:!1,maxParticle:5,emissionOverTime:new J(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:r,blending:B.a,startTileIndex:91,uTileCount:10,vTileCount:10,renderMode:L.LocalSpaceBillBoard};return e.muzzle1=new le(a),e.muzzle1.addBehavior(new ee(new K(new B.w(1,.3882312,.125,1),new B.w(1,.826827,.3014706,1)))),e.muzzle1.addBehavior(new ne(new H([[new G(1,.95,.75,0),0]]))),e.muzzle1.addBehavior(new re(new H([[new G(91,94,97,100),0]]))),e.muzzle1.emitter.renderOrder=2,e.muzzle1.emitter.name="muzzle1",e.muzzle1.emitter.position.x=1,e.add(e.muzzle1.emitter),e.muzzle2=new le(a),e.muzzle2.addBehavior(new ee(new K(new B.w(1,.3882312,.125,1),new B.w(1,.826827,.3014706,1)))),e.muzzle2.addBehavior(new ne(new H([[new G(1,.95,.75,0),0]]))),e.muzzle2.addBehavior(new re(new H([[new G(91,94,97,100),0]]))),e.muzzle2.emitter.renderOrder=2,e.muzzle2.emitter.name="muzzle2",e.muzzle2.emitter.position.x=1,e.muzzle2.emitter.rotation.x=Math.PI/2,e.add(e.muzzle2.emitter),e.flash=new le({duration:1,looping:!1,startLife:new U(.1,.2),startSpeed:new J(0),startSize:new U(1,2.5),startRotation:new U(-Math.PI,Math.PI),startColor:new Z(new B.w(1,1,1,1)),worldSpace:!1,maxParticle:5,emissionOverTime:new J(0),emissionBursts:[{time:0,count:2,cycle:1,interval:.01,probability:1}],shape:new oe,texture:r,blending:B.a,startTileIndex:81,uTileCount:10,vTileCount:10,renderMode:L.BillBoard}),e.flash.addBehavior(new ee(new K(new B.w(1,.95,.82,1),new B.w(1,.38,.12,1)))),e.flash.addBehavior(new re(new H([[new G(81,84.333,87.666,91),0]]))),e.flash.emitter.renderOrder=2,e.flash.emitter.name="flash",e.add(e.flash.emitter),e.smoke=new le({duration:2.5,looping:!1,startLife:new U(.6,.8),startSpeed:new U(.1,3),startSize:new U(.75,1.5),startRotation:new U(-Math.PI,Math.PI),startColor:new $(new B.w(.6323,.6323,.6323,.31),new B.w(1,1,1,.54)),worldSpace:!0,maxParticle:10,emissionOverTime:new J(0),emissionBursts:[{time:0,count:5,cycle:1,interval:.01,probability:1}],shape:new ae({angle:20*Math.PI/180,radius:.3,thickness:1,arc:2*Math.PI}),texture:r,blending:B.l,startTileIndex:81,uTileCount:10,vTileCount:10,renderMode:L.BillBoard}),e.smoke.addBehavior(new ee(new K(new B.w(1,1,1,1),new B.w(1,1,1,0)))),e.smoke.addBehavior(new te(new U(-Math.PI/4,Math.PI/4))),e.smoke.addBehavior(new re(new H([[new G(28,31,34,37),0]]))),e.smoke.emitter.renderOrder=-2,e.smoke.emitter.name="smoke",e.smoke.emitter.rotation.y=Math.PI/2,e.add(e.smoke.emitter),e.particles=new le({duration:1,looping:!1,startLife:new U(.2,.6),startSpeed:new U(1,15),startSize:new U(.1,.3),startColor:new $(new B.w(1,.91,.51,1),new B.w(1,.44,.16,1)),worldSpace:!0,maxParticle:10,emissionOverTime:new J(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ae({angle:20*Math.PI/180,radius:.3,thickness:1,arc:2*Math.PI}),texture:r,blending:B.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:L.StretchedBillBoard,speedFactor:.5}),e.particles.addBehavior(new ne(new H([[new G(1,.95,.75,0),0]]))),e.particles.emitter.renderOrder=1,e.particles.emitter.name="particles",e.particles.emitter.rotation.y=Math.PI/2,e.add(e.particles.emitter),e}return Object(l.a)(n,[{key:"update",value:function(e){this.beam.update(e),this.muzzle1.update(e),this.muzzle2.update(e),this.flash.update(e),this.smoke.update(e),this.particles.update(e)}}]),n}(B.h),fe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n),(e=t.call(this)).hProjectile=void 0,e.vProjectile=void 0;var r=(new B.t).load("textures/projectile.png");r.name="textures/projectile.png";var a={duration:1,looping:!0,startLife:new J(.5),startSpeed:new J(0),startSize:new U(1,2),startColor:new Z(new B.w(1,1,1,1)),worldSpace:!1,maxParticle:10,emissionOverTime:new J(4),shape:new oe,texture:r,blending:B.a,startTileIndex:0,uTileCount:1,vTileCount:1,instancingGeometry:[-2,-.5,0,0,0,2,-.5,0,1,0,2,.5,0,1,1,-2,.5,0,0,1],renderMode:L.LocalSpaceBillBoard};return e.hProjectile=new le(a),e.hProjectile.addBehavior(new ee(new me([[new K(new B.w(1,1,1,0),new B.w(0,1,.25,1)),0],[new K(new B.w(0,1,.25,1),new B.w(1,1,1,0)),.5]]))),e.hProjectile.emitter.renderOrder=2,e.hProjectile.emitter.name="hProjectile",e.add(e.hProjectile.emitter),e.vProjectile=new le(a),e.vProjectile.addBehavior(new ee(new me([[new K(new B.w(1,1,1,0),new B.w(0,1,.25,1)),0],[new K(new B.w(0,1,.25,1),new B.w(1,1,1,0)),.5]]))),e.vProjectile.emitter.renderOrder=2,e.vProjectile.emitter.name="vProjectile",e.vProjectile.emitter.rotation.x=Math.PI/2,e.add(e.vProjectile.emitter),e}return Object(l.a)(n,[{key:"update",value:function(e){this.hProjectile.update(e),this.vProjectile.update(e)}}]),n}(B.h),we=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n),(e=t.call(this)).hProjectile=void 0,e.vProjectile=void 0;var r=(new B.t).load("textures/projectile.png");r.name="textures/projectile.png";var a={duration:1,looping:!0,startLife:new J(.5),startSpeed:new J(0),startSize:new U(1.5,2),startColor:new Z(new B.w(1,1,1,1)),worldSpace:!1,maxParticle:10,emissionOverTime:new J(4),shape:new oe,texture:r,blending:B.a,startTileIndex:0,uTileCount:1,vTileCount:1,renderMode:L.LocalSpaceBillBoard};return e.hProjectile=new le(a),e.hProjectile.addBehavior(new ee(new me([[new K(new B.w(1,1,1,0),new B.w(0,1,.25,1)),0],[new K(new B.w(0,1,.25,1),new B.w(1,1,1,0)),.5]]))),e.hProjectile.emitter.renderOrder=2,e.hProjectile.emitter.name="hProjectile",e.hProjectile.emitter.scale.x=2,e.add(e.hProjectile.emitter),e.vProjectile=new le(a),e.vProjectile.addBehavior(new ee(new me([[new K(new B.w(1,1,1,0),new B.w(0,1,.25,1)),0],[new K(new B.w(0,1,.25,1),new B.w(1,1,1,0)),.5]]))),e.vProjectile.emitter.renderOrder=2,e.vProjectile.emitter.name="vProjectile",e.vProjectile.emitter.rotation.x=Math.PI/2,e.vProjectile.emitter.scale.x=10,e.add(e.vProjectile.emitter),e}return Object(l.a)(n,[{key:"update",value:function(e){this.hProjectile.update(e),this.vProjectile.update(e)}}]),n}(B.h),ge=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n),(e=t.call(this)).mainBeam=void 0,e.glowBeam=void 0,e.particles=void 0,e.beam=void 0,e.smoke=void 0,e.circle=void 0;var r=(new B.t).load("textures/texture1.png");return r.name="textures/texture1.png",e.mainBeam=new le({duration:2,looping:!1,startLife:new U(.1,.3),startSpeed:new U(5,15),startSize:new U(1.5,1.25),startColor:new Z(new B.w(1,1,1,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ae({angle:25*Math.PI/180,radius:.2,thickness:1,arc:2*Math.PI}),texture:r,blending:B.a,startTileIndex:0,uTileCount:10,vTileCount:10}),e.mainBeam.addBehavior(new ne(new H([[new G(1,.25,.05,0),0]]))),e.mainBeam.emitter.renderOrder=2,e.mainBeam.emitter.name="mainBeam",e.add(e.mainBeam.emitter),e.glowBeam=new le({duration:1,looping:!1,startLife:new U(1,1.6),startSpeed:new U(.7,1.5),startSize:new U(.4,.8),startColor:new Z(new B.w(1,.1509503,.07352942,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ae({angle:80*Math.PI/180,radius:.25,thickness:.5,arc:2*Math.PI}),texture:r,blending:B.a,startTileIndex:0,uTileCount:10,vTileCount:10}),e.glowBeam.addBehavior(new ne(new H([[new G(1,.25,.05,0),0]]))),e.glowBeam.emitter.renderOrder=2,e.glowBeam.emitter.name="glowBeam",e.add(e.glowBeam.emitter),e.smoke=new le({duration:1,looping:!1,startLife:new U(.5,.8),startSpeed:new U(1,2.5),startSize:new U(1,1.5),startRotation:new U(0,2*Math.PI),startColor:new Z(new B.w(1,1,1,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:0,count:12,cycle:1,interval:.01,probability:1}],shape:new ie({radius:.75,thickness:1}),texture:r,blending:B.l,startTileIndex:2,uTileCount:10,vTileCount:10}),e.smoke.addBehavior(new ne(new H([[new G(1,.95,.75,0),0]]))),e.smoke.addBehavior(new ee(new K(new B.w(1,.1509503,.07352942,1),new B.w(0,0,0,0)))),e.smoke.addBehavior(new te(new U(2*-Math.PI,2*Math.PI))),e.smoke.emitter.renderOrder=-2,e.smoke.emitter.name="smoke",e.add(e.smoke.emitter),e.particles=new le({duration:1,looping:!1,startLife:new U(.6,1.2),startSpeed:new U(2,10),startSize:new U(.1,.4),startColor:new $(new B.w(1,1,1,1),new B.w(1,.1509503,.07352942,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:0,count:12,cycle:1,interval:.01,probability:1}],shape:new ae({angle:50/180*Math.PI,radius:.5,thickness:1,arc:2*Math.PI}),texture:r,blending:B.l,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:L.StretchedBillBoard,speedFactor:.5}),e.particles.addBehavior(new ne(new H([[new G(1,.25,.05,0),0]]))),e.particles.emitter.renderOrder=0,e.particles.emitter.name="particles",e.add(e.particles.emitter),e.beam=new le({duration:1,looping:!1,startLife:new J(.2),startSpeed:new J(0),startSize:new J(7),startColor:new Z(new B.w(1,.3059356,.2426471,1)),worldSpace:!0,maxParticle:10,emissionOverTime:new J(0),emissionBursts:[{time:0,count:2,cycle:1,interval:.01,probability:1}],shape:new oe,texture:r,blending:B.a,startTileIndex:1,uTileCount:10,vTileCount:10}),e.beam.emitter.renderOrder=0,e.beam.emitter.name="beam",e.beam.addBehavior(new ne(new H([[new G(1,.66666,.33333,0),0]]))),e.add(e.beam.emitter),e.circle=new le({duration:1,looping:!1,startLife:new J(.4),startSpeed:new J(0),startSize:new J(4),startColor:new Z(new B.w(1,.3059356,.2426471,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:r,blending:B.a,startTileIndex:10,uTileCount:10,vTileCount:10}),e.circle.addBehavior(new ne(new H([[new G(.3,.6,.9,1),0]]))),e.circle.addBehavior(new re(new H([[new G(10,13,16,19),0]]))),e.circle.emitter.renderOrder=2,e.circle.emitter.name="circle",e.add(e.circle.emitter),e}return Object(l.a)(n,[{key:"update",value:function(e){this.mainBeam.update(e),this.glowBeam.update(e),this.particles.update(e),this.smoke.update(e),this.beam.update(e),this.circle.update(e)}}]),n}(B.h),ye=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n),(e=t.call(this)).gatherParticles=void 0,e.mainBeam=void 0,e.glowBeam=void 0,e.smoke=void 0,e.particles=void 0,e.beam=void 0,e.circle=void 0;var r=(new B.t).load("textures/texture1.png");r.name="textures/texture1.png";var a=n.yellowColor,i=n.yellowColor2;return e.gatherParticles=new le({duration:1,looping:!1,startLife:new U(.3,.4),startSpeed:new U(-100,-150),startSize:new U(1,3),startColor:new Z(new B.w(1,1,1,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:0,count:30,cycle:1,interval:.01,probability:1}],shape:new ie({radius:40,thickness:1,arc:2*Math.PI}),texture:r,blending:B.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:L.BillBoard}),e.gatherParticles.addBehavior(new ee(new K(new B.w(a.x,a.y,a.z,.2),new B.w(a.x,a.y,a.z,1)))),e.gatherParticles.emitter.renderOrder=2,e.gatherParticles.emitter.name="gatherParticles",e.add(e.gatherParticles.emitter),e.mainBeam=new le({duration:2,looping:!1,startLife:new U(.1,.3),startSpeed:new U(100,300),startSize:new U(1.5,12.5),startColor:new Z(new B.w(1,1,1,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:.4,count:8,cycle:1,interval:.01,probability:1}],shape:new ie({radius:2,thickness:1,arc:2*Math.PI}),texture:r,blending:B.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:L.BillBoard}),e.mainBeam.addBehavior(new ne(new H([[new G(1,.25,.05,0),0]]))),e.mainBeam.emitter.renderOrder=2,e.mainBeam.emitter.name="mainBeam",e.add(e.mainBeam.emitter),e.glowBeam=new le({duration:1,looping:!1,startLife:new U(1,1.6),startSpeed:new U(20,45),startSize:new U(4,8),startColor:new Z(a),worldSpace:!1,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:.4,count:8,cycle:1,interval:.01,probability:1}],shape:new ie({radius:2,thickness:1,arc:2*Math.PI}),texture:r,blending:B.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:L.BillBoard}),e.glowBeam.addBehavior(new ne(new H([[new G(1,.25,.05,0),0]]))),e.glowBeam.emitter.renderOrder=2,e.glowBeam.emitter.name="glowBeam",e.add(e.glowBeam.emitter),e.smoke=new le({duration:1,looping:!1,startLife:new U(.5,.8),startSpeed:new U(20,50),startSize:new U(10,15),startRotation:new U(0,2*Math.PI),startColor:new Z(new B.w(1,1,1,.5)),worldSpace:!1,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:.4,count:12,cycle:1,interval:.01,probability:1}],shape:new ie({radius:7.5,thickness:1}),texture:r,blending:B.l,startTileIndex:2,uTileCount:10,vTileCount:10,renderMode:L.BillBoard}),e.smoke.addBehavior(new ne(new H([[new G(1,.95,.75,0),0]]))),e.smoke.addBehavior(new ee(new K(a,new B.w(0,0,0,0)))),e.smoke.addBehavior(new te(new U(2*-Math.PI,2*Math.PI))),e.smoke.emitter.renderOrder=-2,e.smoke.emitter.name="smoke",e.add(e.smoke.emitter),e.particles=new le({duration:1,looping:!1,startLife:new U(.6,1.2),startSpeed:new U(40,200),startSize:new U(1,4),startColor:new $(new B.w(1,1,1,1),a),worldSpace:!1,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:.4,count:12,cycle:1,interval:.01,probability:1}],shape:new ie({radius:2,thickness:1,arc:2*Math.PI}),texture:r,blending:B.l,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:L.StretchedBillBoard,speedFactor:.1}),e.particles.addBehavior(new ne(new H([[new G(1,.25,.05,0),0]]))),e.particles.emitter.renderOrder=0,e.particles.emitter.name="particles",e.add(e.particles.emitter),e.beam=new le({duration:1,looping:!1,startLife:new J(.2),startSpeed:new J(0),startSize:new J(100),startColor:new Z(i),worldSpace:!1,maxParticle:10,emissionOverTime:new J(0),emissionBursts:[{time:.35,count:2,cycle:1,interval:.01,probability:1}],shape:new oe,texture:r,blending:B.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:L.BillBoard}),e.beam.emitter.renderOrder=-2,e.beam.emitter.name="beam",e.beam.addBehavior(new ne(new H([[new G(1,.66666,.33333,0),0]]))),e.add(e.beam.emitter),e.circle=new le({duration:1,looping:!1,startLife:new J(.4),startSpeed:new J(0),startSize:new J(40),startColor:new Z(i),worldSpace:!1,maxParticle:100,emissionOverTime:new J(0),emissionBursts:[{time:.4,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:r,blending:B.a,startTileIndex:10,uTileCount:10,vTileCount:10,renderMode:L.BillBoard}),e.circle.addBehavior(new ne(new H([[new G(.3,.6,.9,1),0]]))),e.circle.addBehavior(new re(new H([[new G(10,13,16,19),0]]))),e.circle.emitter.renderOrder=2,e.circle.emitter.name="circle",e.add(e.circle.emitter),e}return Object(l.a)(n,[{key:"update",value:function(e){this.gatherParticles.update(e),this.beam.update(e),this.mainBeam.update(e),this.glowBeam.update(e),this.circle.update(e),this.smoke.update(e),this.particles.update(e)}}]),n}(B.h);ye.yellowColor=new B.w(.9,.6,.25,1),ye.yellowColor2=new B.w(1,.95,.4,1);var be=r.createContext(null),Se=be.Consumer,Oe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).removeObject3d=function(e){e.parent&&e.parent.remove(e)},r.addObject3d=function(e,t){var n;switch(e){case"particle":var a=(new B.t).load("textures/texture1.png");n=new le({maxParticle:1e4,shape:new ae,emissionOverTime:new J(100),startLife:new J(30),startSpeed:new J(10),startSize:new J(1),startColor:new Z(new B.w(1,1,1,1)),texture:a,blending:B.a,startTileIndex:0,uTileCount:10,vTileCount:10,worldSpace:!0}).emitter,r.state.scene.add(n);break;case"box":n=new B.j(new B.d(10,10,10),new B.k({color:13421772})),r.state.scene.add(n)}n&&(t.add(n),r.state.actions.select(n),r.setState({}))},r.update=0,r.animate=function(e){r.update+=e,r.update>.1&&(r.state.actions.updateProperties(),r.update=0)};var a={scene:r.createScene(0),script:r.animate,selection:[],actions:{onOpenDemo:function(e){var t=r.createScene(e);r.setState({scene:t})},onSaveAs:function(){var e=document.createElement("a"),t=new Blob([JSON.stringify(r.state.scene.toJSON())],{type:"application/json"});e.href=URL.createObjectURL(t),e.download="scene.json",e.click()},onImport:function(e){for(var t=e.length,n=0;n<t;n++){var a=URL.createObjectURL(e[n]),i=new pe;i.setCrossOrigin(""),i.load(a,(function(e){r.state.scene.add(e)}),(function(){}),(function(){}))}},select:function(e){r.setState({selection:[e]})},selectAddition:function(e){-1===r.state.selection.indexOf(e)&&(r.state.selection.push(e),r.setState({selection:r.state.selection}))},addObject3d:r.addObject3d,removeObject3d:r.removeObject3d,duplicateObject3d:function(){},updateParticleSystem:function(){},updateProperties:function(){r.setState({scene:r.state.scene})}}};return r.state=a,r}return Object(l.a)(n,[{key:"createScene",value:function(e){var t,n=new B.p;n.background=new B.f(6710886),0===e?((t=new he).name="Toon Projectile",t.userData={script:"    this.position.x += delta * 30;\n    if (this.position.x > 20)\n        this.position.x = -20;\n"},t.userData.func=new Function("delta",t.userData.script)):1===e?(t=new ve).name="BulletMuzzle":2===e?(t=new fe).name="BulletProjectile":3===e?(t=new we).name="BulletHit":4===e?(t=new ge).name="ToonExplosion":(t=new ye).name="Explosion",n.add(t);var r=new B.c(100);r.name="axisHelper",n.add(r);var a=new B.n(new B.f(1,1,1),.8,200);a.position.set(50,50,50),n.add(a);var i=new B.b(new B.f(1,1,1),.2);return n.add(i),n}}]),Object(l.a)(n,[{key:"render",value:function(){return r.createElement(be.Provider,{value:this.state},this.props.children)}}]),n}(r.Component),Ce=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).container=void 0,a.stats=void 0,a.camera=void 0,a.renderer=void 0,a.clock=void 0,a.controls=void 0,a.appContext=void 0,a.onResize=function(e){if(a.renderer.domElement.parentElement.clientWidth-10!==a.renderer.domElement.width||a.renderer.domElement.parentElement.clientHeight-10!==a.renderer.domElement.height){var t=a.renderer.domElement.parentElement.clientWidth-10,n=a.renderer.domElement.parentElement.clientHeight-10;a.camera.aspect=t/n,a.camera.updateProjectionMatrix(),a.renderer.domElement.style.width="100%",a.renderer.domElement.style.height="100%",a.renderer.setSize(t,n)}},a.animate=function(){requestAnimationFrame(a.animate),a.onResize(null),a.renderScene(),a.stats.update()},a.container=r.createRef(),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.init()&&this.animate()}},{key:"componentDidUpdate",value:function(e,t,n){this.camera.aspect=this.props.width/this.props.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.props.width,this.props.height)}},{key:"init",value:function(){if(!this.container.current)return!1;if(!P.isWebGLAvailable())return document.body.appendChild(P.getWebGLErrorMessage()),!1;this.renderer=new B.x;var e=this.props.width,t=this.props.height;return this.clock=new B.e,this.camera=new B.m(50,e/t,1,1e3),this.camera.position.set(50,50,50),this.controls=new T.a(this.camera,this.renderer.domElement),this.controls.enableKeys=!1,this.controls.enableDamping=!0,this.controls.dampingFactor=.1,this.controls.rotateSpeed=.2,this.controls.update(),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(e,t),this.container.current.appendChild(this.renderer.domElement),this.stats=new k.a,this.stats.dom.style.position="absolute",this.stats.dom.style.left="",this.stats.dom.style.right="0",this.container.current.appendChild(this.stats.dom),this.onResize(null),!0}},{key:"renderScene",value:function(){if(this.appContext){this.controls.update();var e=this.clock.getDelta();this.appContext.script(e),this.appContext.scene.traverse((function(t){t.userData&&t.userData.func&&t.userData.func.call(t,e),t instanceof A&&t.system.update(e)})),this.renderer.render(this.appContext.scene,this.camera)}}},{key:"render",value:function(){var e=this;return console.log("rendering ThreejsViewPort"),r.createElement(Se,null,(function(t){if(t)return e.appContext=t,r.createElement("div",{ref:e.container,style:{width:"100%",height:"100%"}})}))}}]),n}(r.PureComponent),Ee=(n(236),function(e){var t=r.useState(e.value+""),n=Object(M.a)(t,2),a=n[0],i=n[1],o=r.useState(!1),s=Object(M.a)(o,2),l=s[0],c=s[1];return r.createElement("input",{className:"number-input",value:l?a:e.value,size:5,onChange:function(e){l&&i(e.target.value)},onBlur:function(t){var n=parseFloat(a);n!==e.value&&e.onChange(n),c(!1)},onFocus:function(t){a!==e.value+""&&i(e.value+""),c(!0)},onKeyDown:function(t){if("Enter"===t.key){var n=parseFloat(a);n!==e.value&&e.onChange(n)}}})}),xe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){console.log("rendered Vector3");var e=this.props,t=e.x,n=e.y,a=e.z,i=e.unitConversion,o=void 0===i?1:i,s=e.onChange,l=e.name;return r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},l),r.createElement("label",null,"X:"),r.createElement(Ee,{value:t*o,onChange:function(e){s(e/o,n,a)}}),r.createElement("label",null,"Y:"),r.createElement(Ee,{value:n*o,onChange:function(e){s(t,e/o,a)}}),r.createElement("label",null,"Z:"),r.createElement(Ee,{value:a*o,onChange:function(e){s(t,n,e/o)}}))}}]),n}(r.PureComponent),je=function(e){var t=r.useState(e.value),n=Object(M.a)(t,2),a=n[0],i=n[1],o=r.useState(!1),s=Object(M.a)(o,2),l=s[0],c=s[1];return r.createElement("input",{className:"string-input",value:l?a:e.value,size:20,onChange:function(e){l&&i(e.target.value)},onBlur:function(t){a!==e.value&&e.onChange(a),c(!1)},onFocus:function(t){a!==e.value&&i(e.value),c(!0)},onKeyDown:function(t){"Enter"===t.key&&a!==e.value&&e.onChange(a)}})},ke=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeName=function(e){r.props.object3d.name=e,r.props.updateProperties()},r.onChangePosition=function(e,t,n){r.props.object3d.position.set(e,t,n),r.props.updateProperties()},r.onChangeScale=function(e,t,n){r.props.object3d.scale.set(e,t,n),r.props.updateProperties()},r.onChangeRotation=function(e,t,n){r.props.object3d.rotation.set(e,t,n),r.props.updateProperties()},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return console.log("rendered objectProperties"),r.createElement("div",null,r.createElement(Se,null,(function(t){return t&&r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"Name:"),r.createElement(je,{value:e.props.object3d.name,onChange:e.onChangeName}))})),r.createElement(Se,null,(function(t){return t&&r.createElement(xe,{name:"Position",x:e.props.object3d.position.x,y:e.props.object3d.position.y,z:e.props.object3d.position.z,onChange:e.onChangePosition})})),r.createElement(Se,null,(function(t){return t&&r.createElement(xe,{name:"Rotation",x:e.props.object3d.rotation.x,y:e.props.object3d.rotation.y,z:e.props.object3d.rotation.z,onChange:e.onChangeRotation,unitConversion:180/Math.PI})})),r.createElement(Se,null,(function(t){return t&&r.createElement(xe,{name:"Scale",x:e.props.object3d.scale.x,y:e.props.object3d.scale.y,z:e.props.object3d.scale.z,onChange:e.onChangeScale})})))}}]),n}(r.PureComponent),Pe=n(62),Be=n(197);n(400);function Te(e){return"rgba(".concat(255*e.x|0,",").concat(255*e.y|0,",").concat(255*e.z|0,",").concat(e.w,")")}var Me=function(e){var t=r.useState(!1),n=Object(M.a)(t,2),a=n[0],i=n[1],o=e.color,s=e.onChange;return r.createElement("div",{className:"color-editor"},r.createElement("button",{style:{backgroundColor:Te(o),height:"20px"},onClick:function(){i(!a)}}),Te(o),a?r.createElement("div",{className:"popover"},r.createElement("div",{className:"cover",onClick:function(){i(!1)}}),r.createElement(Be.SketchPicker,{color:{r:255*o.x|0,g:255*o.y|0,b:255*o.z|0,a:o.w},onChange:function(e){var t=new B.w;t.x=Math.min(255,e.rgb.r)/255,t.y=Math.min(255,e.rgb.g)/255,t.z=Math.min(255,e.rgb.b)/255,t.w=e.rgb.a,s(t)}})):null)},ze=(n(401),n(21)),Ne=n(16);function Ie(e,t,n){return e*(1-n)+t*n}var Le=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).x=function(t){return Ie(e.props.xFrom,e.props.xTo,t)},e.y=function(t){return Ie(e.props.yFrom,e.props.yTo,t)},e}return Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=t.xFrom,r=t.yFrom,a=t.xTo,i=t.yTo;return e.xFrom!==n||e.yFrom!==r||e.xTo!==a||e.yTo!==i}}]),n}(a.a.Component),Fe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(e){if(Object(ze.a)(Object(Ne.a)(n.prototype),"shouldComponentUpdate",this).call(this,e))return!0;var t=this.props,r=t.curveColor,a=t.curveWidth,i=t.value,o=Object(M.a)(i.p,4);o[0],o[1],o[2],o[3];return e.curveColor!==r||e.curveWidth!==a||e.value!==i}},{key:"render",value:function(){var e=this.props,t=e.curveColor,n=e.curveWidth,r=e.value,i=this.x,o=this.y,s=Math.floor((i(1)-i(0))/5),l="M".concat(i(0),",").concat(o(r.genValue(0))," ");if(s>0)for(var c=1/s;c<=1;c+=1/s)l+="L".concat(i(c),",").concat(o(r.genValue(c))," ");return l+="L".concat(i(1),",").concat(o(r.genValue(1))," "),a.a.createElement("path",{fill:"none",stroke:t,strokeWidth:n,d:l})}}]),n}(Le),Re=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(e){if(Object(ze.a)(Object(Ne.a)(n.prototype),"shouldComponentUpdate",this).call(this,e))return!0;var t=this.props,r=t.xstart,a=t.ystart,i=t.handleRadius,o=t.handleColor,s=t.hover,l=t.down,c=t.background,u=t.handleStroke,d=t.xval,p=t.yval,m=t.onMouseEnter,h=t.onMouseLeave,v=t.onMouseDown;return e.xstart!==r||e.ystart!==a||e.handleRadius!==i||e.handleColor!==o||e.hover!==s||e.down!==l||e.background!==c||e.handleStroke!==u||e.xval!==d||e.yval!==p||e.onMouseDown!==v||e.onMouseLeave!==h||e.onMouseEnter!==m}},{key:"render",value:function(){var e=this.x,t=this.y,n=this.props,r=n.xstart,i=n.ystart,o=n.handleRadius,s=n.handleColor,l=n.hover,c=n.down,u=n.background,d=n.handleStroke,p=n.xval,m=n.yval,h=n.onMouseEnter,v=n.onMouseLeave,f=n.onMouseDown,w=e(r),g=t(i),y=e(p),b=t(m),S=Math.atan2(b-g,y-w),O=y-o*Math.cos(S),C=b-o*Math.sin(S);return a.a.createElement("g",null,a.a.createElement("line",{stroke:s,strokeWidth:l||c?1+d:d,x1:O,y1:C,x2:w,y2:g}),a.a.createElement("circle",{cx:y,cy:b,r:o,stroke:s,strokeWidth:c?2*d:d,fill:c?u:s,onMouseEnter:h,onMouseLeave:v,onMouseDown:f}))}}]),n}(Le),De=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).rootRef=Object(r.createRef)(),a.positionForEvent=function(e){if(a.rootRef.current){var t=a.rootRef.current.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]}return[0,0]},a.x=function(e){},a.y=function(e){},a.inversex=function(e){},a.inversey=function(e){},a.onDownLeave=function(e){a.state.down&&(a.onDownMove(e),a.setState({down:-1,hover:-1}))},a.onDownMove=function(e){if(a.state.down>=0){e.preventDefault();var t=a.positionForEvent(e),n=Object(M.a)(t,2),r=n[0],i=n[1],o=new H(a.props.value.functions),s=(a.props.width,a.state.curve),l=o.getFunction(s);if(0===a.state.down){var c=l.p[0];if(l.p[0]=(a.props.height-i)/a.props.height,l.p[1]+=l.p[0]-c,o.setStartX(s,r/a.props.width),s-1>=0){var u=o.getFunction(s-1);u.p[3]=(a.props.height-i)/a.props.height,u.p[2]+=l.p[0]-c,o.setFunction(s-1,o.getFunction(s-1).clone())}o.setFunction(s,l.clone())}if(3===a.state.down){var d=l.p[3];if(l.p[3]=(a.props.height-i)/a.props.height,l.p[2]+=l.p[3]-d,o.setEndX(s,r/a.props.width),s+1<o.numOfFunctions){var p=o.getFunction(s+1);p.p[0]=(a.props.height-i)/a.props.height,p.p[1]+=l.p[3]-d,o.setFunction(s+1,o.getFunction(s+1).clone())}o.setFunction(s,l.clone())}1===a.state.down&&(l.p[1]=(a.props.height-i)/a.props.height,o.setFunction(s,l.clone())),2===a.state.down&&(l.p[2]=(a.props.height-i)/a.props.height,o.setFunction(s,l.clone())),a.props.onChange&&a.props.onChange(o)}},a.onDownUp=function(){a.setState({down:-1})},a.state={curve:-1,down:-1,hover:-1},a}return Object(l.a)(n,[{key:"onEnterHandle",value:function(e,t){this.state.down||this.setState({hover:t,curve:e})}},{key:"onDownHandle",value:function(e,t,n){n.preventDefault(),this.setState({hover:-1,down:t,curve:e})}},{key:"onLeaveHandle",value:function(){this.state.down||this.setState({hover:-1})}},{key:"render",value:function(){for(var e=this,t=this.props,a=t.width,i=t.height,o=t.value,s=t.curveWidth,l=void 0===s?1:s,c=t.curveColor,u=void 0===c?"#000":c,d=t.handleRadius,p=void 0===d?n.defaultP.handleRadius:d,m=t.handleColor,h=void 0===m?"#f00":m,v=t.handleStroke,f=void 0===v?1:v,w=t.background,g=void 0===w?"#fff":w,y=this.state,b=y.curve,S=y.down,O=y.hover,C=[],E=function(t){var n=o.getStartX(t),s=o.getEndX(t),c=o.getFunction(t),d=c.getSlope(0),m=c.getSlope(1);C.push(r.createElement("g",{key:t},r.createElement(Fe,{xFrom:n*a,xTo:s*a,yFrom:i,yTo:0,curveColor:u,curveWidth:l,value:c}),r.createElement(Re,{xFrom:n*a,xTo:s*a,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,0,n)},onMouseEnter:function(n){return e.onEnterHandle(t,0)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:0,ystart:c.p[0],xval:0,yval:c.p[0],handleRadius:p,handleColor:h,down:b===t&&0===S,hover:b===t&&0===O,handleStroke:f,background:g}),r.createElement(Re,{xFrom:n*a,xTo:s*a,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,1,n)},onMouseEnter:function(n){return e.onEnterHandle(t,1)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:0,ystart:c.p[0],xval:1/3,yval:1/3*d+c.p[0],handleRadius:p,handleColor:h,down:b===t&&1===S,hover:b===t&&1===O,handleStroke:f,background:g}),r.createElement(Re,{xFrom:n*a,xTo:s*a,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,2,n)},onMouseEnter:function(n){return e.onEnterHandle(t,2)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:1,ystart:c.p[3],xval:1-1/3,yval:c.p[3]-1/3*m,handleRadius:p,handleColor:h,down:b===t&&2===S,hover:b===t&&2===O,handleStroke:f,background:g}),r.createElement(Re,{xFrom:n*a,xTo:s*a,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,3,n)},onMouseEnter:function(n){return e.onEnterHandle(t,3)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:1,ystart:c.p[3],xval:1,yval:c.p[3],handleRadius:p,handleColor:h,down:b===t&&3===S,hover:b===t&&3===O,handleStroke:f,background:g})))},x=0;x<o.numOfFunctions;x++)E(x);return r.createElement("div",{ref:this.rootRef,onMouseMove:this.onDownMove,onMouseUp:this.onDownUp,onMouseLeave:this.onDownLeave},r.createElement("svg",{width:a,height:i},C))}}]),n}(r.Component);De.defaultP={padding:[0,0,0,0],handleRadius:4};var Ve={value:["constant","intervalValue"],functionValue:["piecewiseBezier"],color:["color","randomColor"],functionColor:["colorRange","gradient"]},Ae=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).changeEditor=function(e){var t=null;switch(e.target.value){case"constant":t=new J(0);break;case"color":t=new Z(new B.w(1,1,1,1));break;case"intervalValue":t=new U(0,1);break;case"colorRange":t=new K(new B.w(0,0,0,1),new B.w(1,1,1,1));break;case"randomColor":t=new $(new B.w(0,0,0,1),new B.w(1,1,1,1))}t&&r.props.updateGenerator(t)},r.changeValue=function(e){r.props.updateGenerator(new J(e))},r.changeColor=function(e){r.props.updateGenerator(new Z(e))},r.changeValueA=function(e){var t=r.props.generator;r.props.updateGenerator(new U(e,t.b))},r.changeValueB=function(e){var t=r.props.generator;r.props.updateGenerator(new U(t.a,e))},r.changeColorRangeA=function(e){var t=r.props.generator;r.props.updateGenerator(new K(e,t.b))},r.changeColorRangeB=function(e){var t=r.props.generator;r.props.updateGenerator(new K(t.a,e))},r.changeRandomColorA=function(e){var t=r.props.generator;r.props.updateGenerator(new $(e,t.b))},r.changeRandomColorB=function(e){var t=r.props.generator;r.props.updateGenerator(new $(t.a,e))},r.changeCurve=function(e){r.props.updateGenerator(new H(e.functions))};Ve[e.allowedType[0]][0];return r.state={open:!1},r}return Object(l.a)(n,[{key:"getEditorType",value:function(e){return e instanceof J?"constant":e instanceof U?"intervalValue":e instanceof H?"piecewiseBezier":e instanceof Z?"color":e instanceof $?"randomColor":e instanceof K?"colorRange":e instanceof me?"gradient":"constant"}},{key:"render",value:function(){console.log("render GeneratorEditor");var e,t=this.props,n=t.name,a=t.generator,i=t.allowedType,o=[],s=Object(Pe.a)(i);try{for(s.s();!(e=s.n()).done;){var l=e.value;console.log(l),console.log(Ve[l]);var c,u=Object(Pe.a)(Ve[l]);try{for(u.s();!(c=u.n()).done;){var d=c.value;o.push(d)}}catch(h){u.e(h)}finally{u.f()}}}catch(h){s.e(h)}finally{s.f()}var p,m=this.getEditorType(a);switch(m){case"constant":p=r.createElement(r.Fragment,null,r.createElement(Ee,{value:a.value,onChange:this.changeValue}));break;case"color":p=r.createElement(r.Fragment,null,r.createElement(Me,{color:a.color,onChange:this.changeColor}));break;case"intervalValue":p=r.createElement(r.Fragment,null,r.createElement(Ee,{value:a.a,onChange:this.changeValueA}),"-",r.createElement(Ee,{value:a.b,onChange:this.changeValueB}));break;case"piecewiseBezier":p=r.createElement(r.Fragment,null,r.createElement(De,{height:40,width:240,value:a,onChange:this.changeCurve}));break;case"colorRange":p=r.createElement(r.Fragment,null,r.createElement(Me,{color:a.a,onChange:this.changeColorRangeA}),"-",r.createElement(Me,{color:a.b,onChange:this.changeColorRangeB}));break;case"randomColor":p=r.createElement(r.Fragment,null,r.createElement(Me,{color:a.a,onChange:this.changeRandomColorA}),"-",r.createElement(Me,{color:a.b,onChange:this.changeRandomColorB}))}return r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},n),p,r.createElement("select",{className:"editor-select",onChange:this.changeEditor},o.map((function(e){return r.createElement("option",{key:e,value:e,selected:m===e},e)}))))}}]),n}(r.PureComponent),_e=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeStartSpeed=function(e){console.log("change start speed"),r.props.particleSystem.startSpeed=e,r.props.updateProperties()},r.onChangeStartLife=function(e){console.log("change start life"),r.props.particleSystem.startLife=e,r.props.updateProperties()},r.onChangeStartSize=function(e){console.log("change start size"),r.props.particleSystem.startSize=e,r.props.updateProperties()},r.onChangeStartColor=function(e){console.log("change start color"),r.props.particleSystem.startColor=e,r.props.updateProperties()},r.OnChangeStartRotation=function(e){console.log("change start rotation"),r.props.particleSystem.startRotation=e,r.props.updateProperties()},r.OnChangeEmissionOverTime=function(e){console.log("change start rotation"),r.props.particleSystem.emissionOverTime=e,r.props.updateProperties()},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;console.log("rendered objectProperties");var t=["value","functionValue"],n=["color","functionColor"];return r.createElement("div",null,r.createElement(Se,null,(function(n){return n&&r.createElement(Ae,{name:"Start Life",allowedType:t,generator:e.props.particleSystem.startLife,updateGenerator:e.onChangeStartLife})})),r.createElement(Se,null,(function(n){return n&&r.createElement(Ae,{name:"Start Size",allowedType:t,generator:e.props.particleSystem.startSize,updateGenerator:e.onChangeStartSize})})),r.createElement(Se,null,(function(n){return n&&r.createElement(Ae,{name:"Start Speed",allowedType:t,generator:e.props.particleSystem.startSpeed,updateGenerator:e.onChangeStartSpeed})})),r.createElement(Se,null,(function(t){return t&&r.createElement(Ae,{name:"Start Color",allowedType:n,generator:e.props.particleSystem.startColor,updateGenerator:e.onChangeStartColor})})),r.createElement(Se,null,(function(n){return n&&r.createElement(Ae,{name:"Start Rotation",allowedType:t,generator:e.props.particleSystem.startRotation,updateGenerator:e.OnChangeStartRotation})})),r.createElement(Se,null,(function(n){return n&&r.createElement(Ae,{name:"Emission Over Time",allowedType:t,generator:e.props.particleSystem.emissionOverTime,updateGenerator:e.OnChangeEmissionOverTime})})))}}]),n}(r.PureComponent),Je=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).handleChange=function(e){e.target.files&&r.props.onChange(e.target.files)},r}return Object(l.a)(n,[{key:"render",value:function(){return r.createElement("div",null,r.createElement("input",{type:"file",onChange:this.handleChange}),this.props.fileName)}}]),n}(r.Component),Ue=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeTexture=function(e){console.log("change texture");var t=document.createElement("img"),n=new B.s(t);if(t.onload=function(){n.needsUpdate=!0},e&&e[0]){var a=new FileReader;a.onload=function(e){t.src=a.result},a.readAsDataURL(e[0])}r.props.particleSystem.texture=n,r.props.updateProperties()},r.onChangeStartTile=function(e){r.props.particleSystem.startTileIndex=e,r.props.updateProperties()},r.onChangeUTileCount=function(e){r.props.particleSystem.uTileCount=e,r.props.updateProperties()},r.onChangeVTileCount=function(e){r.props.particleSystem.vTileCount=e,r.props.updateProperties()},r.onChangeBlending=function(e){switch(console.log(e.target.value),e.target.value){case"Normal":r.props.particleSystem.blending=B.l,r.props.particleSystem.emitter.material.blending=B.l;break;case"Additive":r.props.particleSystem.blending=B.a,r.props.particleSystem.emitter.material.blending=B.a}r.props.updateProperties()},r.getValueOfBlending=function(e){switch(e){case B.l:return"Normal";case B.a:return"Additive"}},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return console.log("rendered particleRendererProperties"),r.createElement("div",null,"texture?: Texture; blending?: Blending; worldSpace?: boolean;",r.createElement(Se,null,(function(t){return t&&r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"Blend Mode"),r.createElement("select",{className:"editor-select",onChange:e.onChangeBlending,value:e.getValueOfBlending(e.props.particleSystem.blending)},r.createElement("option",{key:0,value:"Normal"},"Normal"),r.createElement("option",{key:1,value:"Additive"},"Additive")))})),r.createElement(Se,null,(function(t){return t&&r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"UVTile"),r.createElement("label",null,"Column:"),r.createElement(Ee,{value:e.props.particleSystem.uTileCount,onChange:e.onChangeUTileCount}),r.createElement("label",null,"Row:"),r.createElement(Ee,{value:e.props.particleSystem.vTileCount,onChange:e.onChangeVTileCount}))})),r.createElement(Se,null,(function(t){return t&&r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"Start Tile Index"),r.createElement(Ee,{value:e.props.particleSystem.startTileIndex,onChange:e.onChangeStartTile}))})),r.createElement(Se,null,(function(t){return t&&r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"Texture"),r.createElement(Je,{fileName:e.props.particleSystem.texture?e.props.particleSystem.texture.name:"..",onChange:e.onChangeTexture}))})))}}]),n}(r.PureComponent),We=n(198),Ge=n.n(We),He=n(140),Xe=(n(402),function(e){var t=r.useState(e.value),n=Object(M.a)(t,2),a=n[0],i=n[1],o=r.useState(!1),s=Object(M.a)(o,2),l=s[0],c=s[1];return r.createElement(Ge.a,{value:l?a:e.value,onValueChange:function(e){l&&i(e)},highlight:function(e){return Object(He.highlight)(e,He.languages.javascript,"javascript")},padding:10,onBlur:function(t){a!==e.value&&e.onChange(a),c(!1)},onFocus:function(t){a!==e.value&&i(e.value),c(!0)},style:{fontFamily:'"Consolas", monospace',fontSize:12}})}),qe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeScript=function(e){null===r.props.object3d.userData&&(r.props.object3d.userData={}),r.props.object3d.userData.script=e,r.props.object3d.userData.func=new Function("delta",e),r.props.updateProperties()},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.createElement("div",null,r.createElement(Se,null,(function(t){return t&&r.createElement("div",{className:"property"},r.createElement("label",{className:"script"},"Script:"),r.createElement(Xe,{value:e.props.object3d.userData.script||"",onChange:e.onChangeScript}))})))}}]),n}(r.PureComponent),Ye=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).getValueOfShape=function(e){return r.props.particleSystem.emitterShape instanceof oe?"PointEmitter":r.props.particleSystem.emitterShape instanceof ae?"ConeEmitter":r.props.particleSystem.emitterShape instanceof ie?"SphereEmitter":r.props.particleSystem.emitterShape instanceof se?"DonutEmitter":""},r.onChangeShape=function(e){switch(e.target.value){case"PointEmitter":r.props.particleSystem.emitterShape instanceof oe||(r.props.particleSystem.emitterShape=new oe,r.props.updateProperties());break;case"ConeEmitter":r.props.particleSystem.emitterShape instanceof ae||(r.props.particleSystem.emitterShape=new ae,r.props.updateProperties());break;case"SphereEmitter":r.props.particleSystem.emitterShape instanceof ie||(r.props.particleSystem.emitterShape=new ie,r.props.updateProperties());break;case"DonutEmitter":r.props.particleSystem.emitterShape instanceof se||(r.props.particleSystem.emitterShape=new se,r.props.updateProperties())}},r.onChangeKeyValue=function(e,t){r.props.particleSystem.emitterShape[e]=t,r.props.updateProperties()},r}return Object(l.a)(n,[{key:"renderShapeProperties",value:function(){var e=this,t=[],n=function(n){t.push(a.a.createElement("div",{key:n,className:"property"},a.a.createElement("label",{className:"name"},n,":"),a.a.createElement(Ee,{value:e.props.particleSystem.emitterShape[n],onChange:function(t){return e.onChangeKeyValue(n,t)}})))};for(var r in this.props.particleSystem.emitterShape)n(r);return t}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement(Se,null,(function(t){return t&&a.a.createElement("div",{className:"property"},a.a.createElement("label",{className:"name"},"Shape"),a.a.createElement("select",{className:"editor-select",onChange:e.onChangeShape,value:e.getValueOfShape(e.props.particleSystem.emitterShape)},a.a.createElement("option",{key:0,value:"PointEmitter"},"PointEmitter"),a.a.createElement("option",{key:1,value:"ConeEmitter"},"ConeEmitter"),a.a.createElement("option",{key:2,value:"SphereEmitter"},"SphereEmitter"),a.a.createElement("option",{key:3,value:"DonutEmitter"},"DonutEmitter")))})),a.a.createElement(Se,null,(function(t){return t&&e.renderShapeProperties()})))}}]),n}(a.a.PureComponent),$e=n(455),Ke=n(466),Ze=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).getSystems=function(){var e=[];return r.props.object3d instanceof A&&e.push(r.props.object3d.system),r.props.object3d.traverse((function(t){t instanceof A&&e.push(t.system)})),e},r.checkPause=function(e){var t=!0;return e.forEach((function(e){e.paused||(t=!1)})),t},r.togglePause=function(){var e=r.getSystems();r.checkPause(e)?e.forEach((function(e){e.play()})):e.forEach((function(e){e.pause()})),r.props.updateProperties()},r.onRestart=function(){r.getSystems().forEach((function(e){e.restart()})),r.props.updateProperties()},r.onStop=function(){r.getSystems().forEach((function(e){e.restart(),e.pause()})),r.props.updateProperties()},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.createElement("div",null,r.createElement(Ke.a,{color:"primary","aria-label":"primary button group"}),r.createElement(Se,null,(function(t){return t&&r.createElement($e.a,{color:"primary","aria-label":"primary button group"},r.createElement(d.a,{disabled:!e.checkPause(e.getSystems()),onClick:e.togglePause},"Play"),r.createElement(d.a,{disabled:e.checkPause(e.getSystems()),onClick:e.togglePause},"Pause"),r.createElement(d.a,{onClick:e.onRestart},"Restart"),r.createElement(d.a,{onClick:e.onStop},"Stop"))})))}}]),n}(r.PureComponent),Qe=n(459),et=n(458),tt=n(465),nt=n(37),rt=n.n(nt),at=n(460),it=(n(405),n(201)),ot=n(452),st=n(426),lt=n(456),ct=n(457),ut=n(464),dt=n(199),pt=n.n(dt)()((function(e){return Object(h.a)({root:{width:"100%"},listRoot:{width:"100%",backgroundColor:e.palette.background.paper}})}));function mt(e){var t=pt(),n=r.useState([0,1,2,3]),a=Object(M.a)(n,2),i=a[0],o=a[1],s=r.useState(1),l=Object(M.a)(s,2),c=l[0],u=l[1],h=r.useState(null),v=Object(M.a)(h,2),f=v[0],w=v[1],g=function(){w(null)},y=function(t){return function(n){var r=e.particleSystem.behaviors[t];switch(r.type){case"ColorOverLife":r.func=n;break;case"RotationOverLife":r.angularVelocityFunc=n;break;case"SizeOverLife":case"FrameOverLife":r.func=n}e.updateProperties()}};return r.createElement("div",{className:t.root},r.createElement($e.a,{color:"primary","aria-label":"primary button group"},r.createElement(d.a,{color:"inherit","aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){w(e.currentTarget)},id:"new-button"},"New"),r.createElement(p.a,{id:"simple-menu",anchorEl:f,keepMounted:!0,open:Boolean(f),onClose:g},r.createElement(m.a,{onClick:g},"SizeOverLife"),r.createElement(m.a,{onClick:g},"ColorOverLife"),r.createElement(m.a,{onClick:g},"RotationOverLife"),r.createElement(m.a,{onClick:g},"FrameOverLife")),r.createElement(d.a,null,"Remove")),r.createElement(Se,null,(function(n){return n&&r.createElement(ot.a,{dense:!0,className:t.listRoot},e.particleSystem.behaviors.map((function(e,t){var n,a,s,l="behavior-list-label-".concat(t),d=null;switch(e.type){case"ColorOverLife":n=["functionColor"],d=e.func;break;case"RotationOverLife":n=["functionValue","value"],d=e.angularVelocityFunc;break;case"SizeOverLife":case"FrameOverLife":n=["functionValue"],d=e.func;break;default:n=["functionValue"]}return d&&(a=r.createElement(Ae,{name:"Func",allowedType:n,generator:d,updateGenerator:y(t)})),r.createElement(st.a,{key:t,selected:c===t,onClick:function(e){return function(e,t){u(t)}(0,t)}},r.createElement(lt.a,null,r.createElement(ut.a,{edge:"end",onChange:(s=t,function(){var e=i.indexOf(s),t=Object(it.a)(i);-1===e?t.push(s):t.splice(e,1),o(t)}),checked:-1!==i.indexOf(t),inputProps:{"aria-labelledby":l}})),r.createElement(ct.a,{id:l,primary:e.type,secondary:a}))})))})))}var ht=b()({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(tt.a),vt=b()({root:{backgroundColor:"rgba(0, 0, 0, .03)",borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:32,"&$expanded":{minHeight:32}},content:{margin:0,"&$expanded":{margin:0}},expandIcon:{padding:0},expanded:{}})(et.a),ft=Object(Qe.a)((function(e){return Object(h.a)({root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}})}));function wt(e){var t=ft();return r.createElement("div",{className:t.root},r.createElement(ht,null,r.createElement(vt,{expandIcon:r.createElement(rt.a,null),"aria-controls":"object-content",id:"object-header"},r.createElement(f.a,{className:t.heading},"Object")),r.createElement(at.a,null,r.createElement(Se,null,(function(t){return t&&r.createElement(ke,{object3d:e.object3d,updateProperties:t.actions.updateProperties})})))),r.createElement(ht,null,r.createElement(vt,{expandIcon:r.createElement(rt.a,null),"aria-controls":"particle-controller-content",id:"particle-controller-header"},r.createElement(f.a,{className:t.heading},"Particle Controller")),r.createElement(at.a,null,r.createElement(Se,null,(function(t){return t&&r.createElement(Ze,{object3d:e.object3d,updateProperties:t.actions.updateProperties})})))),e.object3d instanceof A&&r.createElement(ht,null,r.createElement(vt,{expandIcon:r.createElement(rt.a,null),"aria-controls":"emitter-shape-content",id:"emitter-shape-header"},r.createElement(f.a,{className:t.heading},"Emitter Shape")),r.createElement(at.a,null,r.createElement(Se,null,(function(t){return t&&r.createElement(Ye,{particleSystem:e.object3d.system,updateProperties:t.actions.updateProperties})})))),e.object3d instanceof A&&r.createElement(ht,null,r.createElement(vt,{expandIcon:r.createElement(rt.a,null),"aria-controls":"particle-renderer-content",id:"particle-renderer-header"},r.createElement(f.a,{className:t.heading},"Particle Renderer")),r.createElement(at.a,null,r.createElement(Se,null,(function(t){return t&&r.createElement(Ue,{particleSystem:e.object3d.system,updateProperties:t.actions.updateProperties})})))),e.object3d instanceof A&&r.createElement(ht,null,r.createElement(vt,{expandIcon:r.createElement(rt.a,null),"aria-controls":"particle-emitter-content",id:"particle-emitter-header"},r.createElement(f.a,{className:t.heading},"Particle Emitter")),r.createElement(at.a,null,r.createElement(Se,null,(function(t){return t&&r.createElement(_e,{particleSystem:e.object3d.system,updateProperties:t.actions.updateProperties})})))),e.object3d instanceof A&&r.createElement(ht,null,r.createElement(vt,{expandIcon:r.createElement(rt.a,null),"aria-controls":"behaviors-content",id:"behaviors-header"},r.createElement(f.a,{className:t.heading},"Behaviors")),r.createElement(at.a,null,r.createElement(Se,null,(function(t){return t&&r.createElement(mt,{particleSystem:e.object3d.system,updateProperties:t.actions.updateProperties})})))),r.createElement(ht,null,r.createElement(vt,{expandIcon:r.createElement(rt.a,null),"aria-controls":"script-content",id:"script-header"},r.createElement(f.a,{className:t.heading},"Script")),r.createElement(at.a,null,r.createElement(Se,null,(function(t){return t&&r.createElement(qe,{object3d:e.object3d,updateProperties:t.actions.updateProperties})})))))}n(406),n(407);var gt=n(38),yt=(n(416),n(462)),bt=n(200),St=n.n(bt),Ot=n(461),Ct=Object(Qe.a)((function(e){return Object(h.a)({root:{height:240,flexGrow:1},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}})}));function Et(e){var t,n,r=Ct(),i=a.a.useState([]),o=Object(M.a)(i,2),s=o[0],l=o[1],c=function(t,n){if(n.length>0){var r=function e(t,n){if(0==t)return n;t--;var r,a=Object(Pe.a)(n.children);try{for(a.s();!(r=a.n()).done;){var i=e(t,r.value);if(i)return i;t--}}catch(o){a.e(o)}finally{a.f()}return null}(parseInt(n[0]),e.scene);r&&e.context.actions.select(r)}l(n)},u=function(e){var t="object";t=e instanceof A?"ParticleSystem":e.type;var n="unnamed";return e.name&&(n=e.name),"[".concat(t,"] ").concat(n)};return a.a.createElement("div",null,a.a.createElement(f.a,{className:r.heading}," Scene Graph "),(t=e.context,n=e.scene,a.a.createElement(yt.a,{className:r.root,selected:s,onNodeSelect:c,defaultCollapseIcon:a.a.createElement(rt.a,null),defaultExpandIcon:a.a.createElement(St.a,null)},function e(t,n,r){var i=[],o=r;r++;var s,l=Object(Pe.a)(n.children);try{for(l.s();!(s=l.n()).done;){var c=e(t,s.value,r);i.push(c[0]),r=c[1]}}catch(d){l.e(d)}finally{l.f()}return[a.a.createElement(Ot.a,{key:n.uuid,nodeId:""+o,label:u(n)},i),r]}(t,n,0)[0])),a.a.createElement(gt.Menu,{id:"scene-graph-menu"},a.a.createElement(gt.Submenu,{label:"Add"},a.a.createElement(gt.Item,{onClick:function(t){t.event;t.props.object3d&&e.context.actions.addObject3d("particle",e.object3d)}},"Particle System"),a.a.createElement(gt.Item,{onClick:function(e){var t=e.event,n=e.props;return console.log(t,n)}},"Ball")),a.a.createElement(gt.Separator,null),a.a.createElement(gt.Item,{onClick:function(t){t.event;t.props.object3d&&e.context.actions.removeObject3d(e.object3d)}},"Remove"),a.a.createElement(gt.Separator,null),a.a.createElement(gt.Item,{onClick:function(t){t.event;if(t.props.object3d){var n=document.createElement("a"),r=e.object3d.toJSON(),a=new Blob([JSON.stringify(r)],{type:"application/json"});n.href=URL.createObjectURL(a),n.download="scene.json",n.click()}}},"Export"),a.a.createElement(gt.Item,{disabled:!0},"Dolor")))}var xt=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"render",value:function(){return console.log("render application"),r.createElement(Oe,null,r.createElement("div",{className:"application"},r.createElement("div",{className:"main-menu"},r.createElement(Se,null,(function(e){return e&&r.createElement(x,{onSaveAs:e.actions.onSaveAs,onImport:e.actions.onImport,onOpenDemo:e.actions.onOpenDemo})}))),r.createElement("div",{className:"main"},r.createElement("div",{className:"viewport"},r.createElement(Ce,{width:600,height:600})),r.createElement("div",{className:"sidebar"},r.createElement(Se,null,(function(e){return e&&r.createElement(Et,{context:e,scene:e.scene})})),r.createElement(Se,null,(function(e){return e&&e.selection.length>0&&r.createElement(wt,{object3d:e.selection[0]})}))))))}}]),n}(r.Component),jt=n(137),kt=n.n(jt),Pt=n(136),Bt=n.n(Pt),Tt=n(135),Mt=n.n(Tt),zt=n(454),Nt=Mt()({palette:{primary:{main:kt.a[500]},secondary:{main:Bt.a[500]}},typography:{fontSize:12}}),It=function(){return a.a.createElement(zt.a,{theme:Nt},a.a.createElement(xt,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(It,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[208,1,2]]]);
//# sourceMappingURL=main.6fe8a7a4.chunk.js.map