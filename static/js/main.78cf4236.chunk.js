(window["webpackJsonpthree.quarks-editor"]=window["webpackJsonpthree.quarks-editor"]||[]).push([[0],{221:function(e,t,n){e.exports=n(432)},250:function(e,t,n){},414:function(e,t,n){},415:function(e,t,n){},416:function(e,t,n){},417:function(e,t,n){},420:function(e,t,n){},421:function(e,t,n){},422:function(e,t,n){},432:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(19),o=n.n(i),s=n(1),l=n(4),c=n(5),u=n(6),d=n(439),p=n(488),m=n(470),h=n(465),v=n(468),f=n(74),w=n(438),g=n(466),b=n(87),y=n.n(b),x=n(200),S=n.n(x),C=Object(h.a)((function(e){return{root:{flexGrow:1},menuIcon:{marginRight:e.spacing(2)},menuButton:{marginRight:e.spacing(1)},title:{marginRight:e.spacing(1)}}})),O=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).fileRef=void 0,a.openFileDialog=function(e){a.fileRef.current&&a.fileRef.current.click()},a.importFile=function(e){e.target.files&&a.props.onImport(e.target.files)},a.openDemo=function(e){a.props.onOpenDemo(e)},a.handleMenuClick=function(e){console.log(e.currentTarget),a.setState({anchorEl:e.currentTarget})},a.handleMenuClose=function(){a.setState({anchorEl:void 0})},a.state={anchorEl:void 0},a.fileRef=r.createRef(),a}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.createElement("div",{className:t.root},r.createElement(g.a,{position:"static"},r.createElement(v.a,{variant:"dense"},r.createElement(w.a,{edge:"start",className:t.menuIcon,color:"inherit","aria-label":"menu"},r.createElement(S.a,null)),r.createElement(f.a,{variant:"h6",className:t.title},"Three.Quarks"),r.createElement(d.a,{color:"inherit",className:t.menuButton,"aria-controls":"simple-menu","aria-haspopup":"true",onClick:this.handleMenuClick,id:"file-button"},"File"),r.createElement(p.a,{id:"file-menu",anchorEl:this.state.anchorEl,keepMounted:!0,open:Boolean(this.state.anchorEl&&"file-button"===this.state.anchorEl.id),onClose:this.handleMenuClose},r.createElement(m.a,null,"New"),r.createElement(m.a,{onClick:this.openFileDialog},"Open"),r.createElement(m.a,{onClick:this.props.onSaveAs},"Download"),r.createElement("input",{ref:this.fileRef,type:"file",id:"fileElem",multiple:!0,accept:"application/json",style:{display:"none"},onChange:this.importFile})),r.createElement(d.a,{color:"inherit",className:t.menuButton,"aria-controls":"simple-menu","aria-haspopup":"true",onClick:this.handleMenuClick,id:"demo-button"},"Demo"),r.createElement(p.a,{id:"demo-menu",anchorEl:this.state.anchorEl,keepMounted:!0,open:Boolean(this.state.anchorEl&&"demo-button"===this.state.anchorEl.id),onClose:this.handleMenuClose},r.createElement(m.a,{onClick:function(){return e.openDemo(0)}},"PlasmaProjectile"),r.createElement(m.a,{onClick:function(){return e.openDemo(1)}},"BulletMuzzle"),r.createElement(m.a,{onClick:function(){return e.openDemo(2)}},"BulletProjectile"),r.createElement(m.a,{onClick:function(){return e.openDemo(3)}},"ShipSmoke"),r.createElement(m.a,{onClick:function(){return e.openDemo(4)}},"HitImpact"),r.createElement(m.a,{onClick:function(){return e.openDemo(5)}},"Explosion"),r.createElement(m.a,{onClick:function(){return e.openDemo(6)}},"Levelup"),r.createElement(m.a,{onClick:function(){return e.openDemo(7)}},"EnergyMuzzle"),r.createElement(m.a,{onClick:function(){return e.openDemo(8)}},"ElectricBall"),r.createElement(m.a,{onClick:function(){return e.openDemo(9)}},"ShipTrail"),r.createElement(m.a,{onClick:function(){return e.openDemo(10)}},"Explosion2")))))}}]),n}(r.PureComponent),k=y()(C,{withTheme:!0})(O),E=n(201),B=n.n(E),j={isWebGLAvailable:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(t){return!1}},isWebGL2Available:function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(t){return!1}},getWebGLErrorMessage:function(){return this.getErrorMessage(1)},getWebGL2ErrorMessage:function(){return this.getErrorMessage(2)},getErrorMessage:function(e){var t={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext},n='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>',r=document.createElement("div");return r.id="webglmessage",r.style.fontFamily="monospace",r.style.fontSize="13px",r.style.fontWeight="normal",r.style.textAlign="center",r.style.background="#fff",r.style.color="#000",r.style.padding="1.5em",r.style.width="400px",r.style.margin="5em auto 0",n=(n=t[e]?n.replace("$0","graphics card"):n.replace("$0","browser")).replace("$1",{1:"WebGL",2:"WebGL 2"}[e]),r.innerHTML=n,r}},T=n(2),P=n(202),M=n(43),z=n(14),L=n(16),I=n(10);function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F,R="\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec4 vColor;\n\nvoid main() {\n\n    #include <clipping_planes_fragment>\n    \n    vec3 outgoingLight = vec3( 0.0 );\n    vec4 diffuseColor = vColor;\n    \n    #include <logdepthbuf_fragment>\n    \n    #ifdef USE_MAP\n    vec4 texelColor = texture2D( map, vUv);\n    diffuseColor *= texelColor;\n    #endif\n\n    outgoingLight = diffuseColor.rgb;\n\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    \n    #include <tonemapping_fragment>\n\n}\n";!function(e){e[e.BillBoard=0]="BillBoard",e[e.StretchedBillBoard=1]="StretchedBillBoard",e[e.LocalSpaceBillBoard=2]="LocalSpaceBillBoard"}(F||(F={}));var V=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e,r){var a;return Object(s.a)(this,n),a=t.call(this),N(Object(L.a)(a),"type","ParticleEmitter"),N(Object(L.a)(a),"system",void 0),N(Object(L.a)(a),"geometry",void 0),N(Object(L.a)(a),"material",void 0),N(Object(L.a)(a),"rotationBuffer",void 0),N(Object(L.a)(a),"sizeBuffer",void 0),N(Object(L.a)(a),"colorBuffer",void 0),N(Object(L.a)(a),"offsetBuffer",void 0),N(Object(L.a)(a),"velocityBuffer",void 0),N(Object(L.a)(a),"tiling",void 0),N(Object(L.a)(a),"uvTileBuffer",void 0),N(Object(L.a)(a),"renderMode",void 0),N(Object(L.a)(a),"speedFactor",void 0),N(Object(L.a)(a),"texture",void 0),N(Object(L.a)(a),"blending",void 0),N(Object(L.a)(a),"instancingGeometry",void 0),a.system=e,a.geometry=new I.r,a.renderMode=r.renderMode||F.BillBoard,a.speedFactor=r.speedFactor||1,a.instancingGeometry=r.instancingGeometry||new I.H(1,1,1,1),a.texture=r.texture,a.blending=r.blending||I.F,a.geometry.setIndex(a.instancingGeometry.getIndex()),a.geometry.setAttribute("position",a.instancingGeometry.getAttribute("position")),a.geometry.setAttribute("uv",a.instancingGeometry.getAttribute("uv")),a.offsetBuffer=new I.q(new Float32Array(3*e.maxParticle),3),a.offsetBuffer.setUsage(I.j),a.geometry.setAttribute("offset",a.offsetBuffer),a.colorBuffer=new I.q(new Float32Array(4*e.maxParticle),4),a.offsetBuffer.setUsage(I.j),a.geometry.setAttribute("color",a.colorBuffer),a.rotationBuffer=new I.q(new Float32Array(e.maxParticle),1),a.offsetBuffer.setUsage(I.j),a.geometry.setAttribute("rotation",a.rotationBuffer),a.sizeBuffer=new I.q(new Float32Array(e.maxParticle),1),a.offsetBuffer.setUsage(I.j),a.geometry.setAttribute("size",a.sizeBuffer),a.tiling=!0,a.rebuildMaterial(),a.frustumCulled=!1,a}return Object(l.a)(n,[{key:"rebuildMaterial",value:function(){var e={},t={};if(this.texture){t.USE_MAP="",t.USE_UV="",e.map=new I.M(this.texture),e.uvTransform=new I.M((new I.y).copy(this.texture.matrix));var n=this.system.uTileCount||1,r=this.system.vTileCount||1;this.tiling&&(this.uvTileBuffer=new I.q(new Float32Array(this.system.maxParticle),1),this.uvTileBuffer.setUsage(I.j),this.geometry.setAttribute("uvTile",this.uvTileBuffer),t.UV_TILE="",e.tileCount=new I.M(new I.N(n,r)))}if(this.system.worldSpace&&(t.WORLD_SPACE=""),this.renderMode===F.BillBoard||this.renderMode===F.LocalSpaceBillBoard){var a,i;this.renderMode===F.LocalSpaceBillBoard?(a="\n\n#include <uv_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 offset;\nattribute float rotation;\nattribute float size;\nattribute vec4 color;\nattribute float uvTile;\n\nvarying vec4 vColor;\n\n#ifdef UV_TILE\nuniform vec2 tileCount;\n#endif\n\nvoid main() {\n\n    #ifdef UV_TILE\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\n    #else\n        #include <uv_vertex>\n    #endif\n\t\n    vec2 alignedPosition = ( position.xy ) * size;\n    \n    vec2 rotatedPosition;\n    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n    \n\t#ifdef WORLD_SPACE\n\t    vec4 mvPosition = viewMatrix * vec4( offset + vec3(rotatedPosition, position.z), 1.0 );\n\t#else\n\t    vec4 mvPosition = modelViewMatrix * vec4( offset + vec3(rotatedPosition, position.z), 1.0 );\n\t#endif\n\n\tvColor = color;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",i=I.i):(a="\n\n#include <uv_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 offset;\nattribute float rotation;\nattribute float size;\nattribute vec4 color;\nattribute float uvTile;\n\nvarying vec4 vColor;\n\n#ifdef UV_TILE\nuniform vec2 tileCount;\n#endif\n\nvoid main() {\n\n    #ifdef UV_TILE\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\n    #else\n        #include <uv_vertex>\n    #endif\n\t\n\t#ifdef WORLD_SPACE\n\t    vec4 mvPosition = viewMatrix * vec4( offset, 1.0 );\n\t#else\n\t    vec4 mvPosition = modelViewMatrix * vec4( offset, 1.0 );\n\t#endif\n\t\n    vec2 alignedPosition = ( position.xy ) * size;\n    \n    vec2 rotatedPosition;\n    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n    \n    mvPosition.xy += rotatedPosition;\n\n\tvColor = color;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",i=I.n),this.material=new I.J({uniforms:e,defines:t,vertexShader:a,fragmentShader:R,transparent:!0,depthWrite:!1,blending:this.blending||I.a,side:i})}else{if(this.renderMode!==F.StretchedBillBoard)throw new Error("render mode unavailable");this.velocityBuffer=new I.q(new Float32Array(3*this.system.maxParticle),3),this.velocityBuffer.setUsage(I.j),this.geometry.setAttribute("velocity",this.velocityBuffer),e.speedFactor=new I.M(this.speedFactor),this.material=new I.J({uniforms:e,defines:t,vertexShader:"\n\n#include <uv_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 offset;\nattribute float rotation;\nattribute float size;\nattribute vec4 color;\nattribute vec3 velocity;\nattribute float uvTile;\n\nvarying vec4 vColor;\n\n#ifdef UV_TILE\nuniform vec2 tileCount;\n#endif\n\nuniform float speedFactor;\n\nvoid main() {\n\n    #ifdef UV_TILE\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\n    #else\n        #include <uv_vertex>\n    #endif\n\t\n\t#ifdef WORLD_SPACE\n\t    vec4 mvPosition = viewMatrix * vec4( offset, 1.0 );\n        vec3 viewVelocity = vec3(viewMatrix * vec4(velocity, 1.0));\n\t#else\n\t    vec4 mvPosition = modelViewMatrix * vec4( offset, 1.0 );\n        vec3 viewVelocity = vec3(modelViewMatrix * vec4(velocity, 1.0));\n\t#endif\n\n    vec3 scaledPos = vec3(position.xy * size, position.z);\n    mvPosition.xyz += scaledPos + dot(scaledPos, viewVelocity) * viewVelocity / length(viewVelocity) * speedFactor;\n\n\tvColor = color;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",fragmentShader:R,transparent:!0,depthWrite:!1,blending:this.blending||I.a})}}},{key:"clone",value:function(){return this.system.clone().emitter}},{key:"update",value:function(){var e=this.system.particles,t=this.system.particleNum;this.geometry.instanceCount=t;for(var n=0;n<t;n++){var r=e[n];this.offsetBuffer.setXYZ(n,r.position.x,r.position.y,r.position.z),this.colorBuffer.setXYZW(n,r.color.x,r.color.y,r.color.z,r.color.w),this.rotationBuffer.setX(n,r.rotation),this.sizeBuffer.setX(n,r.size),this.renderMode===F.StretchedBillBoard&&this.velocityBuffer.setXYZ(n,r.velocity.x,r.velocity.y,r.velocity.z),this.tiling&&this.uvTileBuffer.setX(n,r.uvTile)}t>0&&(this.offsetBuffer.updateRange.count=3*t,this.offsetBuffer.needsUpdate=!0,this.colorBuffer.updateRange.count=4*t,this.colorBuffer.needsUpdate=!0,this.rotationBuffer.updateRange.count=t,this.rotationBuffer.needsUpdate=!0,this.sizeBuffer.updateRange.count=t,this.sizeBuffer.needsUpdate=!0,this.renderMode===F.StretchedBillBoard&&(this.velocityBuffer.updateRange.count=3*t,this.velocityBuffer.needsUpdate=!0),this.tiling&&(this.uvTileBuffer.updateRange.count=t,this.uvTileBuffer.needsUpdate=!0))}},{key:"dispose",value:function(){this.geometry.dispose()}},{key:"extractFromCache",value:function(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),null!==this.system&&(r.ps=this.system.toJSON(e)),this.children.length>0){r.children=[];for(var a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(t){var i=this.extractFromCache(e.geometries),o=this.extractFromCache(e.materials),s=this.extractFromCache(e.textures),l=this.extractFromCache(e.images);i.length>0&&(n.geometries=i),o.length>0&&(n.materials=o),s.length>0&&(n.textures=s),l.length>0&&(n.images=l)}return n.object=r,n}}]),n}(I.A),D=function e(){Object(s.a)(this,e),N(this,"startSpeed",0),N(this,"startColor",new I.P),N(this,"startSize",1),N(this,"velocity",new I.O),N(this,"age",0),N(this,"life",1),N(this,"angularVelocity",void 0),N(this,"position",new I.O),N(this,"rotation",0),N(this,"size",1),N(this,"color",new I.P),N(this,"uvTile",0)},A=function(){function e(t){Object(s.a)(this,e),this.value=t,N(this,"type",void 0),this.type="value"}return Object(l.a)(e,[{key:"genValue",value:function(){return this.value}},{key:"toJSON",value:function(){return{type:"ConstantValue",value:this.value}}},{key:"clone",value:function(){return new e(this.value)}}],[{key:"fromJSON",value:function(t){return new e(t.value)}}]),e}(),J=function(){function e(t,n){Object(s.a)(this,e),this.a=t,this.b=n,N(this,"type",void 0),this.type="value"}return Object(l.a)(e,[{key:"genValue",value:function(){return I.x.lerp(this.a,this.b,Math.random())}},{key:"toJSON",value:function(){return{type:"IntervalValue",a:this.a,b:this.b}}},{key:"clone",value:function(){return new e(this.a,this.b)}}],[{key:"fromJSON",value:function(t){return new e(t.a,t.b)}}]),e}(),U=function(){function e(){Object(s.a)(this,e),N(this,"functions",void 0),this.functions=new Array}return Object(l.a)(e,[{key:"findFunction",value:function(e){for(var t=0,n=0,r=this.functions.length-1;n+1<r;)if(t=(n+r)/2,e<this.getStartX(t))r=t-1;else{if(!(e>this.getEndX(t)))return t;n=t+1}for(var a=n;a<=r;a++)if(e>=this.functions[a][1]&&e<=this.getEndX(a))return a;return-1}},{key:"getStartX",value:function(e){return this.functions[e][1]}},{key:"setStartX",value:function(e,t){e>0&&(this.functions[e][1]=t)}},{key:"getEndX",value:function(e){return e+1<this.functions.length?this.functions[e+1][1]:1}},{key:"setEndX",value:function(e,t){e+1<this.functions.length&&(this.functions[e+1][1]=t)}},{key:"getFunction",value:function(e){return this.functions[e][0]}},{key:"setFunction",value:function(e,t){this.functions[e][0]=t}},{key:"numOfFunctions",get:function(){return this.functions.length}}]),e}(),_=function(){function e(t,n,r,a){Object(s.a)(this,e),N(this,"p",void 0),this.p=[t,n,r,a]}return Object(l.a)(e,[{key:"genValue",value:function(e){var t=e*e,n=e*e*e,r=1-e,a=r*r,i=a*r;return this.p[0]*i+this.p[1]*a*e*3+this.p[2]*r*t*3+this.p[3]*n}},{key:"derivativeCoefficients",value:function(e){for(var t=[],n=e,r=n.length-1;r>0;r--){for(var a=[],i=0;i<r;i++){var o=r*(n[i+1]-n[i]);a.push(o)}t.push(a),n=a}return t}},{key:"getSlope",value:function(e){var t=this.derivativeCoefficients(this.p)[0],n=1-e,r=n*e*2,a=e*e;return n*n*t[0]+r*t[1]+a*t[2]}},{key:"controlCurve",value:function(e,t){this.p[1]=e/3+this.p[0],this.p[2]=this.p[3]-t/3}},{key:"hull",value:function(e){var t,n=this.p,r=[],a=[],i=0,o=0,s=0;for(a[i++]=n[0],a[i++]=n[1],a[i++]=n[2],a[i++]=n[3];n.length>1;){for(r=[],o=0,s=n.length-1;o<s;o++)t=e*n[o]+(1-e)*n[o+1],a[i++]=t,r.push(t);n=r}return a}},{key:"split",value:function(t){var n=this.hull(t);return{left:new e(n[0],n[4],n[7],n[9]),right:new e(n[9],n[8],n[6],n[3]),span:n}}},{key:"clone",value:function(){return new e(this.p[0],this.p[1],this.p[2],this.p[3])}},{key:"toJSON",value:function(){return{p0:this.p[0],p1:this.p[1],p2:this.p[2],p3:this.p[3]}}}],[{key:"fromJSON",value:function(t){return new e(t.p0,t.p1,t.p2,t.p3)}}]),e}(),W=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[new _(0,1/3,1/3*2,1),0]];return Object(s.a)(this,n),e=t.call(this),N(Object(L.a)(e),"type",void 0),e.type="function",e.functions=r,e}return Object(l.a)(n,[{key:"genValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.findFunction(e);return-1===t?(console.error(e),0):this.functions[t][0].genValue((e-this.getStartX(t))/(this.getEndX(t)-this.getStartX(t)))}},{key:"toSVG",value:function(e,t){if(t<1)return"";for(var n=["M",0,this.functions[0][0].p[0]].join(" "),r=1/t;r<=1;r+=1/t)n=[n,"L",r*e,this.genValue(r)].join(" ");return n}},{key:"toJSON",value:function(){return{type:"PiecewiseBezier",functions:this.functions.map((function(e){var t=Object(z.a)(e,2),n=t[0],r=t[1];return{function:n.toJSON(),start:r}}))}}},{key:"clone",value:function(){return new n(this.functions.map((function(e){var t=Object(z.a)(e,2),n=t[0],r=t[1];return[n.clone(),r]})))}}],[{key:"fromJSON",value:function(e){return new n(e.functions.map((function(e){return[_.fromJSON(e.function),e.start]})))}}]),n}(U);function G(e){switch(e.type){case"ConstantValue":return A.fromJSON(e);case"IntervalValue":return J.fromJSON(e);case"PiecewiseBezier":return W.fromJSON(e);default:return new A(0)}}var H=function(e){return{r:e.x,g:e.y,b:e.z,a:e.w}},X=function(e){return new I.P(e.r,e.g,e.b,e.a)},q=function(){function e(t,n){Object(s.a)(this,e),this.a=t,this.b=n,N(this,"type",void 0),this.type="value"}return Object(l.a)(e,[{key:"genColor",value:function(e){var t=Math.random();return e.copy(this.a).lerp(this.b,t)}},{key:"toJSON",value:function(){return{type:"RandomColor",a:H(this.a),b:H(this.b)}}},{key:"clone",value:function(){return new e(this.a.clone(),this.b.clone())}}],[{key:"fromJSON",value:function(t){return new e(X(t.a),X(t.b))}}]),e}(),Y=function(){function e(t,n){Object(s.a)(this,e),this.a=t,this.b=n,N(this,"type",void 0),this.type="function"}return Object(l.a)(e,[{key:"genColor",value:function(e,t){return e.copy(this.a).lerp(this.b,t)}},{key:"toJSON",value:function(){return{type:"ColorRange",a:H(this.a),b:H(this.b)}}},{key:"clone",value:function(){return new e(this.a.clone(),this.b.clone())}}],[{key:"fromJSON",value:function(t){return new e(X(t.a),X(t.b))}}]),e}(),$=function(){function e(t){Object(s.a)(this,e),this.color=t,N(this,"type",void 0),this.type="value"}return Object(l.a)(e,[{key:"genColor",value:function(e){return e.copy(this.color)}},{key:"toJSON",value:function(){return{type:"ConstantColor",color:H(this.color)}}},{key:"clone",value:function(){return new e(this.color.clone())}}],[{key:"fromJSON",value:function(t){return new e(X(t.color))}}]),e}();function K(e){switch(e.type){case"ConstantColor":return $.fromJSON(e);case"ColorRange":return Y.fromJSON(e);case"RandomColor":return q.fromJSON(e);default:return new $(new I.P(1,1,1,1))}}var Z=function(){function e(t){Object(s.a)(this,e),this.func=t,N(this,"type","ColorOverLife")}return Object(l.a)(e,[{key:"initialize",value:function(e){}},{key:"update",value:function(e,t){this.func.genColor(e.color,e.age/e.life),e.color.x*=e.startColor.x,e.color.y*=e.startColor.y,e.color.z*=e.startColor.z,e.color.w*=e.startColor.w}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}},{key:"clone",value:function(){return new e(this.func.clone())}}]),e}(),Q=function(){function e(t){Object(s.a)(this,e),this.angularVelocityFunc=t,N(this,"type","RotationOverLife")}return Object(l.a)(e,[{key:"initialize",value:function(e){"value"===this.angularVelocityFunc.type?e.angularVelocity=this.angularVelocityFunc.genValue():e.angularVelocity=0}},{key:"update",value:function(e,t){"value"===this.angularVelocityFunc.type?e.rotation+=t*e.angularVelocity:e.rotation+=t*this.angularVelocityFunc.genValue(e.age/e.life)}},{key:"toJSON",value:function(){return{type:this.type,func:this.angularVelocityFunc.toJSON()}}},{key:"clone",value:function(){return new e(this.angularVelocityFunc)}}]),e}(),ee=function(){function e(t){Object(s.a)(this,e),this.func=t,N(this,"type","SizeOverLife")}return Object(l.a)(e,[{key:"initialize",value:function(e){}}]),Object(l.a)(e,[{key:"update",value:function(e){e.size=e.startSize*this.func.genValue(e.age/e.life)}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}},{key:"clone",value:function(){return new e(this.func.clone())}}]),e}(),te=function(){function e(t){Object(s.a)(this,e),this.func=t,N(this,"type","SpeedOverLife")}return Object(l.a)(e,[{key:"initialize",value:function(e){}}]),Object(l.a)(e,[{key:"update",value:function(e){e.velocity.normalize().multiplyScalar(e.startSpeed*this.func.genValue(e.age/e.life))}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}},{key:"clone",value:function(){return new e(this.func.clone())}}]),e}(),ne=function(){function e(t){Object(s.a)(this,e),this.func=t,N(this,"type","FrameOverLife")}return Object(l.a)(e,[{key:"initialize",value:function(e){}},{key:"update",value:function(e,t){e.uvTile=Math.floor(this.func.genValue(e.age/e.life))}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}},{key:"clone",value:function(){return new e(this.func.clone())}}]),e}(),re=(new I.O,function(){function e(t){Object(s.a)(this,e),this.angularVelocityFunc=t,N(this,"type","OrbitOverLife")}return Object(l.a)(e,[{key:"initialize",value:function(e){"value"===this.angularVelocityFunc.type?e.angularVelocity=this.angularVelocityFunc.genValue():e.angularVelocity=0}},{key:"update",value:function(e,t){var n=Math.atan2(e.position.y,e.position.x),r=Math.sqrt(e.position.x*e.position.x+e.position.y*e.position.y);n+=this.angularVelocityFunc.genValue(e.age/e.life)*t,e.position.x=Math.cos(n)*r,e.position.y=Math.sin(n)*r}},{key:"toJSON",value:function(){return{type:this.type,func:this.angularVelocityFunc.toJSON()}}},{key:"clone",value:function(){return new e(this.angularVelocityFunc.clone())}}]),e}());var ae=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),N(this,"radius",void 0),N(this,"arc",void 0),N(this,"thickness",void 0),N(this,"angle",void 0),this.radius=t.radius||10,this.arc=t.arc||2*Math.PI,this.thickness=t.thickness||1,this.angle=t.angle||Math.PI/6}return Object(l.a)(e,[{key:"initialize",value:function(e){var t=Math.random(),n=I.x.lerp(1-this.thickness,1,Math.random()),r=t*this.arc,a=Math.sqrt(n),i=Math.sin(r),o=Math.cos(r);e.position.x=a*o,e.position.y=a*i,e.position.z=0;var s=this.angle*a;e.velocity.set(0,0,Math.cos(s)).addScaledVector(e.position,Math.sin(s)).multiplyScalar(e.startSpeed),e.position.multiplyScalar(this.radius)}},{key:"toJSON",value:function(){return{type:"cone",radius:this.radius,arc:this.arc,thickness:this.thickness,angle:this.angle}}},{key:"clone",value:function(){return new e({radius:this.radius,arc:this.arc,thickness:this.thickness,angle:this.angle})}}]),e}(),ie=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),N(this,"radius",void 0),N(this,"arc",void 0),N(this,"thickness",void 0),this.radius=t.radius||10,this.arc=t.arc||2*Math.PI,this.thickness=t.thickness||1}return Object(l.a)(e,[{key:"initialize",value:function(e){var t=Math.random(),n=Math.random(),r=I.x.lerp(1-this.thickness,1,Math.random()),a=t*this.arc,i=Math.acos(2*n-1),o=Math.cbrt(r),s=Math.sin(a),l=Math.cos(a),c=Math.sin(i),u=Math.cos(i);e.position.x=o*c*l,e.position.y=o*c*s,e.position.z=o*u,e.velocity.setScalar(0).addScaledVector(e.position,e.startSpeed),e.position.multiplyScalar(this.radius)}},{key:"toJSON",value:function(){return{type:"sphere",radius:this.radius,arc:this.arc,thickness:this.thickness}}},{key:"clone",value:function(){return new e({radius:this.radius,arc:this.arc,thickness:this.thickness})}}]),e}(),oe=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"initialize",value:function(e){var t=Math.random(),n=Math.random(),r=t*Math.PI*2,a=Math.acos(2*n-1),i=Math.cbrt(Math.random()),o=Math.sin(r),s=Math.cos(r),l=Math.sin(a),c=Math.cos(a);e.velocity.x=i*l*s,e.velocity.y=i*l*o,e.velocity.z=i*c,e.velocity.multiplyScalar(e.startSpeed),e.position.setScalar(0)}},{key:"toJSON",value:function(){return{type:"point"}}},{key:"clone",value:function(){return new e}}]),e}(),se=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),N(this,"radius",void 0),N(this,"arc",void 0),N(this,"thickness",void 0),N(this,"angle",void 0),this.radius=t.radius||10,this.arc=t.arc||2*Math.PI,this.thickness=t.thickness||1,this.angle=t.angle||Math.PI/6}return Object(l.a)(e,[{key:"initialize",value:function(e){var t=Math.random(),n=I.x.lerp(this.thickness,1,Math.random()),r=t*this.arc,a=Math.sqrt(n),i=Math.sin(r),o=Math.cos(r);e.position.x=a*o,e.position.y=a*i,e.position.z=0;var s=this.angle*a;e.velocity.set(0,0,Math.cos(s)).addScaledVector(e.position,Math.sin(s)).multiplyScalar(e.startSpeed),e.position.multiplyScalar(this.radius)}},{key:"toJSON",value:function(){return{type:"donut",radius:this.radius,arc:this.arc,thickness:this.thickness,angle:this.angle}}},{key:"clone",value:function(){return new e({radius:this.radius,arc:this.arc,thickness:this.thickness,angle:this.angle})}}]),e}(),le=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),N(this,"autoDestroy",void 0),N(this,"looping",void 0),N(this,"duration",void 0),N(this,"maxParticle",void 0),N(this,"startLife",void 0),N(this,"startSpeed",void 0),N(this,"startRotation",void 0),N(this,"startSize",void 0),N(this,"startColor",void 0),N(this,"startTileIndex",void 0),N(this,"emissionOverTime",void 0),N(this,"emissionOverDistance",void 0),N(this,"emissionBursts",void 0),N(this,"tileCount",void 0),N(this,"worldSpace",void 0),N(this,"particleNum",void 0),N(this,"burstIndex",void 0),N(this,"burstWaveIndex",void 0),N(this,"time",void 0),N(this,"paused",void 0),N(this,"waitEmiting",void 0),N(this,"emitEnded",void 0),N(this,"markForDestroy",void 0),N(this,"behaviors",void 0),N(this,"particles",void 0),N(this,"emitterShape",void 0),N(this,"emitter",void 0),N(this,"oldWorldMatrix",new I.z),N(this,"normalMatrix",new I.y),this.autoDestroy=void 0!==t.autoDestroy&&t.autoDestroy,this.duration=t.duration||1,this.maxParticle=t.maxParticle||100,this.looping=void 0===t.looping||t.looping,this.startLife=t.startLife||new A(5),this.startSpeed=t.startSpeed||new A(0),this.startRotation=t.startRotation||new A(0),this.startSize=t.startSize||new A(1),this.startColor=t.startColor||new $(new I.P(1,1,1,1)),this.emissionOverTime=t.emissionOverTime||new A(10),this.emissionOverDistance=t.emissionOverDistance||new A(0),this.emissionBursts=t.emissionBursts||[],this.emitterShape=t.shape||new ie,this.behaviors=t.behaviors||new Array,this.worldSpace=void 0!==t.worldSpace&&t.worldSpace,this.tileCount=new I.N(t.uTileCount,t.vTileCount),this.particles=new Array,this.startTileIndex=t.startTileIndex||0,this.emitter=new V(this,t),this.particleNum=0,this.burstIndex=0,this.burstWaveIndex=0,this.time=0,this.paused=!1,this.waitEmiting=0,this.emitEnded=!1,this.markForDestroy=!1}return Object(l.a)(e,[{key:"texture",get:function(){return this.emitter.texture},set:function(e){this.emitter.texture=e,this.emitter.material.uniforms.map.value=e}},{key:"uTileCount",get:function(){return this.tileCount.x},set:function(e){this.tileCount.x=e,this.emitter.material.uniforms.tileCount.value.x=e}},{key:"vTileCount",get:function(){return this.tileCount.y},set:function(e){this.tileCount.y=e,this.emitter.material.uniforms.tileCount.value.y=e}},{key:"renderMode",get:function(){return this.emitter.renderMode},set:function(e){this.emitter.renderMode=e,this.emitter.rebuildMaterial()}},{key:"speedFactor",get:function(){return this.emitter.speedFactor},set:function(e){this.emitter.speedFactor=e,this.emitter.material.uniforms.speedFactor.value=e}},{key:"blending",get:function(){return this.emitter.material.blending},set:function(e){this.emitter.material.blending=e}}]),Object(l.a)(e,[{key:"pause",value:function(){this.paused=!0}},{key:"play",value:function(){this.paused=!1}},{key:"spawn",value:function(e){for(var t=0;t<e&&this.particleNum<this.maxParticle;t++){for(this.particleNum++;this.particles.length<this.particleNum;)this.particles.push(new D);var n=this.particles[this.particleNum-1];this.startColor.genColor(n.startColor,this.time),n.color.copy(n.startColor),n.startSpeed=this.startSpeed.genValue(this.time),n.life=this.startLife.genValue(this.time),n.age=0,n.rotation=this.startRotation.genValue(this.time),n.startSize=n.size=this.startSize.genValue(this.time),n.uvTile=this.startTileIndex,this.emitterShape.initialize(n),this.worldSpace&&(n.position.applyMatrix4(this.emitter.matrixWorld),n.velocity.applyMatrix3(this.normalMatrix));for(var r=0;r<this.behaviors.length;r++)this.behaviors[r].initialize(n)}}},{key:"endEmit",value:function(){this.emitEnded=!0,this.autoDestroy&&(this.markForDestroy=!0)}},{key:"dispose",value:function(){this.emitter.dispose(),this.emitter.parent&&this.emitter.parent.remove(this.emitter)}},{key:"restart",value:function(){this.paused=!1,this.particleNum=0,this.burstIndex=0,this.burstWaveIndex=0,this.time=0,this.waitEmiting=0,this.emitEnded=!1,this.markForDestroy=!1}},{key:"update",value:function(e){if(e>.1&&(e=.1),!this.paused)if(this.emitEnded&&0===this.particleNum)this.markForDestroy&&this.emitter.parent&&this.dispose();else{this.time>this.duration&&(this.looping?this.time-=this.duration:this.emitEnded||this.endEmit()),this.normalMatrix.getNormalMatrix(this.emitter.matrixWorld);for(var t=0;t<this.particleNum;t++){var n=this.particles[t];n.age>=n.life&&(this.particles[t]=this.particles[this.particleNum-1],this.particles[this.particleNum-1]=n,this.particleNum--,t--)}if(!this.emitEnded){var r=Math.floor(this.waitEmiting);this.spawn(r),this.waitEmiting-=r}for(;this.burstIndex<this.emissionBursts.length&&this.emissionBursts[this.burstIndex].time<=this.time;){if(Math.random()<this.emissionBursts[this.burstIndex].probability){var a=this.emissionBursts[this.burstIndex].count;this.spawn(a)}this.burstIndex++}for(var i=0;i<this.particleNum;i++){for(var o=this.particles[i],s=0;s<this.behaviors.length;s++)this.behaviors[s].update(o,e);o.position.addScaledVector(o.velocity,e),o.age+=e}this.emitter.update(),this.oldWorldMatrix.copy(this.emitter.matrixWorld),this.emitEnded||(this.waitEmiting+=e*this.emissionOverTime.genValue(this.time/this.duration)),this.time+=e}}},{key:"toJSON",value:function(e){if(this.texture.toJSON(e),void 0!==this.texture.image){var t=this.texture.image;e.images[t.uuid]={uuid:t.uuid,url:this.texture.name}}return{autoDestroy:this.autoDestroy,looping:this.looping,duration:this.duration,maxParticle:this.maxParticle,shape:this.emitterShape.toJSON(),startLife:this.startLife.toJSON(),startSpeed:this.startSpeed.toJSON(),startRotation:this.startRotation.toJSON(),startSize:this.startSize.toJSON(),startColor:this.startColor.toJSON(),emissionOverTime:this.emissionOverTime.toJSON(),emissionOverDistance:this.emissionOverDistance.toJSON(),emissionBursts:this.emissionBursts,instancingGeometry:this.emitter.instancingGeometry.toJSON(),renderMode:this.renderMode,speedFactor:this.renderMode===F.StretchedBillBoard?this.speedFactor:0,texture:this.texture.uuid,startTileIndex:this.startTileIndex,uTileCount:this.uTileCount,vTileCount:this.vTileCount,blending:this.blending,behaviors:this.behaviors.map((function(e){return e.toJSON()})),worldSpace:this.worldSpace}}},{key:"addBehavior",value:function(e){this.behaviors.push(e)}},{key:"clone",value:function(){var t,n=[],r=Object(M.a)(this.emissionBursts);try{for(r.s();!(t=r.n()).done;){var a=t.value,i={};Object.assign(i,a),n.push(i)}}catch(u){r.e(u)}finally{r.f()}var o,s=[],l=Object(M.a)(this.behaviors);try{for(l.s();!(o=l.n()).done;){var c=o.value;s.push(c.clone())}}catch(u){l.e(u)}finally{l.f()}return new e({autoDestroy:this.autoDestroy,looping:this.looping,duration:this.duration,maxParticle:this.maxParticle,shape:this.emitterShape.clone(),startLife:this.startLife.clone(),startSpeed:this.startSpeed.clone(),startRotation:this.startRotation.clone(),startSize:this.startSize.clone(),startColor:this.startColor.clone(),emissionOverTime:this.emissionOverTime.clone(),emissionOverDistance:this.emissionOverDistance.clone(),emissionBursts:n,instancingGeometry:this.emitter.instancingGeometry.clone(),renderMode:this.renderMode,speedFactor:this.speedFactor,texture:this.texture,startTileIndex:this.startTileIndex,uTileCount:this.uTileCount,vTileCount:this.vTileCount,blending:this.blending,behaviors:s,worldSpace:this.worldSpace})}}],[{key:"fromJSON",value:function(t,n){var r;switch(t.shape.type){case"cone":r=new ae(t.shape);break;case"donut":r=new se(t.shape);break;case"point":r=new oe;break;case"sphere":r=new ie(t.shape);break;default:r=new oe}return new e({autoDestroy:t.autoDestroy,looping:t.looping,duration:t.duration,maxParticle:t.maxParticle,shape:r,startLife:G(t.startLife),startSpeed:G(t.startSpeed),startRotation:G(t.startRotation),startSize:G(t.startSize),startColor:K(t.startColor),emissionOverTime:G(t.emissionOverTime),emissionOverDistance:G(t.emissionOverDistance),emissionBursts:t.emissionBursts,renderMode:t.renderMode,speedFactor:t.speedFactor,texture:n[t.texture],startTileIndex:t.startTileIndex,uTileCount:t.uTileCount,vTileCount:t.vTileCount,blending:t.blending,behaviors:t.behaviors.map((function(e){return function(e){switch(e.type){case"ColorOverLife":return new Z(K(e.func));case"RotationOverLife":return new Q(G(e.func));case"SizeOverLife":return new ee(G(e.func));case"SpeedOverLife":return new te(G(e.func));case"FrameOverLife":return new ne(G(e.func));case"OrbitOverLife":return new re(G(e.func));default:return new Z(new Y(new I.P(1,1,1,1),new I.P(1,1,1,1)))}}(e)})),worldSpace:t.worldSpace})}}]),e}(),ce={UVMapping:I.L,CubeReflectionMapping:I.c,CubeRefractionMapping:I.d,EquirectangularReflectionMapping:I.k,EquirectangularRefractionMapping:I.l,CubeUVReflectionMapping:I.f,CubeUVRefractionMapping:I.g},ue={RepeatWrapping:I.I,ClampToEdgeWrapping:I.b,MirroredRepeatWrapping:I.B},de={NearestFilter:I.C,NearestMipmapNearestFilter:I.E,NearestMipmapLinearFilter:I.D,LinearFilter:I.s,LinearMipmapNearestFilter:I.u,LinearMipmapLinearFilter:I.t},pe=function(){function e(t){Object(s.a)(this,e),N(this,"manager",void 0),N(this,"crossOrigin","anonymous"),N(this,"path",void 0),N(this,"resourcePath",void 0),this.manager=void 0!==t?t:I.h,this.resourcePath=""}return Object(l.a)(e,[{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"load",value:function(e,t,n,r){var a=this,i=void 0===this.path?I.v.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;var o=new I.m(a.manager);this.path&&o.setPath(this.path),o.load(e,(function(n){var i=null;try{i=JSON.parse(n)}catch(s){return void 0!==r&&r(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}var o=i.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?a.parse(i,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)}},{key:"loadImage",value:function(e,t){var n=this;return n.manager.itemStart(t),e.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}},{key:"parseImages",value:function(e,t){var n={};if(void 0!==e&&e.length>0){var r=new I.w(t),a=new I.p(r);a.setCrossOrigin(this.crossOrigin);for(var i=0,o=e.length;i<o;i++){var s=e[i],l=s.url;if(Array.isArray(l)){n[s.uuid]=[];for(var c=0,u=l.length;c<u;c++){var d=l[c],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:this.resourcePath+d;n[s.uuid].push(this.loadImage(a,p))}}else{p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:this.resourcePath+s.url;n[s.uuid]=this.loadImage(a,p)}}}return n}},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var a=0,i=e.length;a<i;a++){var o,s=e[a];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(t[s.image])?new I.e(t[s.image]):new I.K(t[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=n(s.mapping,ce)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=n(s.wrap[0],ue),o.wrapT=n(s.wrap[1],ue)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=n(s.minFilter,de)),void 0!==s.magFilter&&(o.magFilter=n(s.magFilter,de)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),r[s.uuid]=o}return r}},{key:"parseObject",value:function(e,t){var n;switch(e.type){case"ParticleEmitter":n=le.fromJSON(e.ps,t).emitter;break;case"Group":n=new I.o;break;default:n=new I.G}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(n.matrixAutoUpdate=e.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.layers&&(n.layers.mask=e.layers),void 0!==e.children)for(var r=e.children,a=0;a<r.length;a++)n.add(this.parseObject(r[a],t));return n}},{key:"parse",value:function(e,t){var n=this.parseImages(e.images,(function(){void 0!==t&&t(a)})),r=this.parseTextures(e.textures,n),a=this.parseObject(e.object,r);return void 0!==e.images&&0!==e.images.length||void 0!==t&&t(a),a}}]),e}(),me=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[new Y(new I.P(0,0,0,1),new I.P(1,1,1,1)),0]];return Object(s.a)(this,n),e=t.call(this),N(Object(L.a)(e),"type",void 0),e.type="function",e.functions=r,e}return Object(l.a)(n,[{key:"genColor",value:function(e,t){var n=this.findFunction(t);return-1===n?(console.error(t),e.copy(this.functions[0][0].a)):this.getFunction(n).genColor(e,t)}},{key:"toJSON",value:function(){return{type:"Gradient",functions:this.functions.map((function(e){var t=Object(z.a)(e,2),n=t[0],r=t[1];return{function:n.toJSON(),start:r}}))}}},{key:"clone",value:function(){return new n(this.functions.map((function(e){var t=Object(z.a)(e,2),n=t[0],r=t[1];return[n.clone(),r]})))}}],[{key:"fromJSON",value:function(e){return new n(e.functions.map((function(e){return[Y.fromJSON(e.function),e.start]})))}}]),n}(U),he=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).particles=void 0,r.smoke=void 0,r.glowBeam=void 0,r.mainBeam=void 0;var a=e[0].texture;return r.mainBeam=new le({duration:1,looping:!0,startLife:new J(.1,.15),startSpeed:new A(0),startSize:new A(1.25),startColor:new $(new T.x(1,1,1,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new A(40),shape:new ie({radius:1e-4,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10}),r.mainBeam.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.mainBeam.emitter.renderOrder=2,r.mainBeam.emitter.name="mainBeam",r.add(r.mainBeam.emitter),r.glowBeam=new le({duration:1,looping:!0,startLife:new J(.1,.15),startSpeed:new A(0),startSize:new A(3.5),startColor:new $(new T.x(1,.1509503,.07352942,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new A(40),shape:new ie({radius:1e-4,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10}),r.glowBeam.addBehavior(new ee(new W([[new _(1,.95,.75,0),0]]))),r.glowBeam.emitter.renderOrder=2,r.glowBeam.emitter.name="glowBeam",r.add(r.glowBeam.emitter),r.particles=new le({duration:1,looping:!0,startLife:new J(.3,.6),startSpeed:new J(2,5),startSize:new J(.1,.4),startColor:new q(new T.x(1,1,1,.5),new T.x(1,.1509503,.07352942,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new A(60),shape:new ae({angle:4.8423/180*Math.PI,radius:.3,thickness:1,arc:2*Math.PI}),texture:a,renderMode:F.StretchedBillBoard,speedFactor:.01,blending:T.m,startTileIndex:0,uTileCount:10,vTileCount:10}),r.particles.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.particles.emitter.renderOrder=0,r.particles.emitter.rotateY(-Math.PI/2),r.particles.emitter.name="particles",r.add(r.particles.emitter),r.smoke=new le({startLife:new J(.25,.3),startSpeed:new A(0),startSize:new J(.75,1.25),startRotation:new J(0,2*Math.PI),startColor:new $(new T.x(1,1,1,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new A(20),shape:new ie({radius:.2,thickness:1}),texture:a,blending:T.m,startTileIndex:2,uTileCount:10,vTileCount:10}),r.smoke.addBehavior(new ee(new W([[new _(1,.95,.75,0),0]]))),r.smoke.addBehavior(new Z(new Y(new T.x(1,.1509503,.07352942,1),new T.x(0,0,0,0)))),r.smoke.addBehavior(new Q(new J(2*-Math.PI,2*Math.PI))),r.smoke.emitter.renderOrder=-2,r.smoke.emitter.name="smoke",r.add(r.smoke.emitter),r.userData={script:"    this.position.x += delta * 30;\n    if (this.position.x > 20)\n        this.position.x = -20;\n"},r.userData.func=new Function("delta",r.userData.script),r}return Object(l.a)(n,[{key:"update",value:function(e){this.mainBeam.update(e),this.glowBeam.update(e),this.particles.update(e),this.smoke.update(e)}}]),n}(T.i),ve=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).beam=void 0,r.muzzle1=void 0,r.muzzle2=void 0,r.flash=void 0,r.smoke=void 0,r.particles=void 0;var a=e[0].texture;r.beam=new le({duration:1,looping:!1,startLife:new J(.1,.2),startSpeed:new A(0),startSize:new A(4),startColor:new $(new T.x(1,.585716,.1691176,1)),worldSpace:!1,maxParticle:10,emissionOverTime:new A(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10}),r.beam.emitter.renderOrder=0,r.beam.emitter.name="beam",r.beam.addBehavior(new ee(new W([[new _(1,.95,.75,0),0]]))),r.add(r.beam.emitter);var i={duration:1,looping:!1,startLife:new J(.1,.2),startSpeed:new A(0),startSize:new J(1,5),startColor:new $(new T.x(1,1,1,1)),worldSpace:!1,maxParticle:5,emissionOverTime:new A(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:91,uTileCount:10,vTileCount:10,renderMode:F.LocalSpaceBillBoard};return r.muzzle1=new le(i),r.muzzle1.addBehavior(new Z(new Y(new T.x(1,.3882312,.125,1),new T.x(1,.826827,.3014706,1)))),r.muzzle1.addBehavior(new ee(new W([[new _(1,.95,.75,0),0]]))),r.muzzle1.addBehavior(new ne(new W([[new _(91,94,97,100),0]]))),r.muzzle1.emitter.renderOrder=2,r.muzzle1.emitter.name="muzzle1",r.muzzle1.emitter.position.x=1,r.add(r.muzzle1.emitter),r.muzzle2=new le(i),r.muzzle2.addBehavior(new Z(new Y(new T.x(1,.3882312,.125,1),new T.x(1,.826827,.3014706,1)))),r.muzzle2.addBehavior(new ee(new W([[new _(1,.95,.75,0),0]]))),r.muzzle2.addBehavior(new ne(new W([[new _(91,94,97,100),0]]))),r.muzzle2.emitter.renderOrder=2,r.muzzle2.emitter.name="muzzle2",r.muzzle2.emitter.position.x=1,r.muzzle2.emitter.rotation.x=Math.PI/2,r.add(r.muzzle2.emitter),r.flash=new le({duration:1,looping:!1,startLife:new J(.1,.2),startSpeed:new A(0),startSize:new J(1,2.5),startRotation:new J(-Math.PI,Math.PI),startColor:new $(new T.x(1,1,1,1)),worldSpace:!1,maxParticle:5,emissionOverTime:new A(0),emissionBursts:[{time:0,count:2,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:81,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.flash.addBehavior(new Z(new Y(new T.x(1,.95,.82,1),new T.x(1,.38,.12,1)))),r.flash.addBehavior(new ne(new W([[new _(81,84.333,87.666,91),0]]))),r.flash.emitter.renderOrder=2,r.flash.emitter.name="flash",r.add(r.flash.emitter),r.smoke=new le({duration:2.5,looping:!1,startLife:new J(.6,.8),startSpeed:new J(.1,3),startSize:new J(.75,1.5),startRotation:new J(-Math.PI,Math.PI),startColor:new q(new T.x(.6323,.6323,.6323,.31),new T.x(1,1,1,.54)),worldSpace:!0,maxParticle:10,emissionOverTime:new A(0),emissionBursts:[{time:0,count:5,cycle:1,interval:.01,probability:1}],shape:new ae({angle:20*Math.PI/180,radius:.3,thickness:1,arc:2*Math.PI}),texture:a,blending:T.m,startTileIndex:81,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.smoke.addBehavior(new Z(new Y(new T.x(1,1,1,1),new T.x(1,1,1,0)))),r.smoke.addBehavior(new Q(new J(-Math.PI/4,Math.PI/4))),r.smoke.addBehavior(new ne(new W([[new _(28,31,34,37),0]]))),r.smoke.emitter.renderOrder=-2,r.smoke.emitter.name="smoke",r.smoke.emitter.rotation.y=Math.PI/2,r.add(r.smoke.emitter),r.particles=new le({duration:1,looping:!1,startLife:new J(.2,.6),startSpeed:new J(1,15),startSize:new J(.1,.3),startColor:new q(new T.x(1,.91,.51,1),new T.x(1,.44,.16,1)),worldSpace:!0,maxParticle:10,emissionOverTime:new A(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ae({angle:20*Math.PI/180,radius:.3,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.StretchedBillBoard,speedFactor:.5}),r.particles.addBehavior(new ee(new W([[new _(1,.95,.75,0),0]]))),r.particles.emitter.renderOrder=1,r.particles.emitter.name="particles",r.particles.emitter.rotation.y=Math.PI/2,r.add(r.particles.emitter),r}return Object(l.a)(n,[{key:"update",value:function(e){this.beam.update(e),this.muzzle1.update(e),this.muzzle2.update(e),this.flash.update(e),this.smoke.update(e),this.particles.update(e)}}]),n}(T.i),fe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n),(e=t.call(this)).hProjectile=void 0,e.vProjectile=void 0;var r=(new T.u).load("textures/projectile.png");r.name="textures/projectile.png";var a={duration:1,looping:!0,startLife:new A(.5),startSpeed:new A(0),startSize:new J(1,2),startColor:new $(new T.x(1,1,1,1)),worldSpace:!1,maxParticle:10,emissionOverTime:new A(4),shape:new oe,texture:r,blending:T.a,startTileIndex:0,uTileCount:1,vTileCount:1,renderMode:F.LocalSpaceBillBoard};return e.hProjectile=new le(a),e.hProjectile.addBehavior(new Z(new me([[new Y(new T.x(1,1,1,0),new T.x(0,1,.25,1)),0],[new Y(new T.x(0,1,.25,1),new T.x(1,1,1,0)),.5]]))),e.hProjectile.emitter.renderOrder=2,e.hProjectile.emitter.name="hProjectile",e.add(e.hProjectile.emitter),e.vProjectile=new le(a),e.vProjectile.addBehavior(new Z(new me([[new Y(new T.x(1,1,1,0),new T.x(0,1,.25,1)),0],[new Y(new T.x(0,1,.25,1),new T.x(1,1,1,0)),.5]]))),e.vProjectile.emitter.renderOrder=2,e.vProjectile.emitter.name="vProjectile",e.vProjectile.emitter.rotation.x=Math.PI/2,e.add(e.vProjectile.emitter),e}return Object(l.a)(n,[{key:"update",value:function(e){this.hProjectile.update(e),this.vProjectile.update(e)}}]),n}(T.i),we=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).mainBeam=void 0,r.glowBeam=void 0,r.particles=void 0,r.beam=void 0,r.smoke=void 0,r.circle=void 0;var a=e[0].texture;return r.mainBeam=new le({duration:2,looping:!1,startLife:new J(.1,.3),startSpeed:new J(5,15),startSize:new J(1.5,1.25),startColor:new $(new T.x(1,1,1,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ae({angle:25*Math.PI/180,radius:.2,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10}),r.mainBeam.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.mainBeam.emitter.renderOrder=2,r.mainBeam.emitter.name="mainBeam",r.add(r.mainBeam.emitter),r.glowBeam=new le({duration:1,looping:!1,startLife:new J(1,1.6),startSpeed:new J(.7,1.5),startSize:new J(.4,.8),startColor:new $(new T.x(1,.1509503,.07352942,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ae({angle:80*Math.PI/180,radius:.25,thickness:.5,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10}),r.glowBeam.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.glowBeam.emitter.renderOrder=2,r.glowBeam.emitter.name="glowBeam",r.add(r.glowBeam.emitter),r.smoke=new le({duration:1,looping:!1,startLife:new J(.5,.8),startSpeed:new J(1,2.5),startSize:new J(1,1.5),startRotation:new J(0,2*Math.PI),startColor:new $(new T.x(1,1,1,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:12,cycle:1,interval:.01,probability:1}],shape:new ie({radius:.75,thickness:1}),texture:a,blending:T.m,startTileIndex:2,uTileCount:10,vTileCount:10}),r.smoke.addBehavior(new ee(new W([[new _(1,.95,.75,0),0]]))),r.smoke.addBehavior(new Z(new Y(new T.x(1,.1509503,.07352942,1),new T.x(0,0,0,0)))),r.smoke.addBehavior(new Q(new J(2*-Math.PI,2*Math.PI))),r.smoke.emitter.renderOrder=-2,r.smoke.emitter.name="smoke",r.add(r.smoke.emitter),r.particles=new le({duration:1,looping:!1,startLife:new J(.6,1.2),startSpeed:new J(2,10),startSize:new J(.1,.4),startColor:new q(new T.x(1,1,1,1),new T.x(1,.1509503,.07352942,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:12,cycle:1,interval:.01,probability:1}],shape:new ae({angle:50/180*Math.PI,radius:.5,thickness:1,arc:2*Math.PI}),texture:a,blending:T.m,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.StretchedBillBoard,speedFactor:.5}),r.particles.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.particles.emitter.renderOrder=0,r.particles.emitter.name="particles",r.add(r.particles.emitter),r.beam=new le({duration:1,looping:!1,startLife:new A(.2),startSpeed:new A(0),startSize:new A(7),startColor:new $(new T.x(1,.3059356,.2426471,1)),worldSpace:!0,maxParticle:10,emissionOverTime:new A(0),emissionBursts:[{time:0,count:2,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10}),r.beam.emitter.renderOrder=0,r.beam.emitter.name="beam",r.beam.addBehavior(new ee(new W([[new _(1,.66666,.33333,0),0]]))),r.add(r.beam.emitter),r.circle=new le({duration:1,looping:!1,startLife:new A(.4),startSpeed:new A(0),startSize:new A(4),startColor:new $(new T.x(1,.3059356,.2426471,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:10,uTileCount:10,vTileCount:10}),r.circle.addBehavior(new ee(new W([[new _(.3,.6,.9,1),0]]))),r.circle.addBehavior(new ne(new W([[new _(10,13,16,19),0]]))),r.circle.emitter.renderOrder=2,r.circle.emitter.name="circle",r.add(r.circle.emitter),r}return Object(l.a)(n,[{key:"update",value:function(e){this.mainBeam.update(e),this.glowBeam.update(e),this.particles.update(e),this.smoke.update(e),this.beam.update(e),this.circle.update(e)}}]),n}(T.i),ge=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).gatherParticles=void 0,r.mainBeam=void 0,r.glowBeam=void 0,r.smoke=void 0,r.particles=void 0,r.beam=void 0,r.circle=void 0;var a=e[0].texture,i=n.yellowColor,o=n.yellowColor2;return r.gatherParticles=new le({duration:1,looping:!1,startLife:new J(.3,.4),startSpeed:new J(-100,-150),startSize:new J(1,3),startColor:new $(new T.x(1,1,1,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:30,cycle:1,interval:.01,probability:1}],shape:new ie({radius:40,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.gatherParticles.addBehavior(new Z(new Y(new T.x(i.x,i.y,i.z,.2),new T.x(i.x,i.y,i.z,1)))),r.gatherParticles.emitter.renderOrder=2,r.gatherParticles.emitter.name="gatherParticles",r.add(r.gatherParticles.emitter),r.mainBeam=new le({duration:2,looping:!1,startLife:new J(.1,.3),startSpeed:new J(100,300),startSize:new J(1.5,12.5),startColor:new $(new T.x(1,1,1,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:.4,count:8,cycle:1,interval:.01,probability:1}],shape:new ie({radius:2,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.mainBeam.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.mainBeam.emitter.renderOrder=2,r.mainBeam.emitter.name="mainBeam",r.add(r.mainBeam.emitter),r.glowBeam=new le({duration:1,looping:!1,startLife:new J(1,1.6),startSpeed:new J(20,45),startSize:new J(4,8),startColor:new $(i),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:.4,count:8,cycle:1,interval:.01,probability:1}],shape:new ie({radius:2,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.glowBeam.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.glowBeam.emitter.renderOrder=2,r.glowBeam.emitter.name="glowBeam",r.add(r.glowBeam.emitter),r.smoke=new le({duration:1,looping:!1,startLife:new J(.5,.8),startSpeed:new J(20,50),startSize:new J(10,15),startRotation:new J(0,2*Math.PI),startColor:new $(new T.x(1,1,1,.5)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:.4,count:12,cycle:1,interval:.01,probability:1}],shape:new ie({radius:7.5,thickness:1}),texture:a,blending:T.m,startTileIndex:2,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.smoke.addBehavior(new ee(new W([[new _(1,.95,.75,0),0]]))),r.smoke.addBehavior(new Z(new Y(i,new T.x(0,0,0,0)))),r.smoke.addBehavior(new Q(new J(2*-Math.PI,2*Math.PI))),r.smoke.emitter.renderOrder=-2,r.smoke.emitter.name="smoke",r.add(r.smoke.emitter),r.particles=new le({duration:1,looping:!1,startLife:new J(.6,1.2),startSpeed:new J(40,200),startSize:new J(1,4),startColor:new q(new T.x(1,1,1,1),i),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:.4,count:12,cycle:1,interval:.01,probability:1}],shape:new ie({radius:2,thickness:1,arc:2*Math.PI}),texture:a,blending:T.m,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.StretchedBillBoard,speedFactor:.1}),r.particles.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.particles.emitter.renderOrder=0,r.particles.emitter.name="particles",r.add(r.particles.emitter),r.beam=new le({duration:1,looping:!1,startLife:new A(.2),startSpeed:new A(0),startSize:new A(100),startColor:new $(o),worldSpace:!1,maxParticle:10,emissionOverTime:new A(0),emissionBursts:[{time:.35,count:2,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.beam.emitter.renderOrder=-2,r.beam.emitter.name="beam",r.beam.addBehavior(new ee(new W([[new _(1,.66666,.33333,0),0]]))),r.add(r.beam.emitter),r.circle=new le({duration:1,looping:!1,startLife:new A(.4),startSpeed:new A(0),startSize:new A(40),startColor:new $(o),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:.4,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:10,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.circle.addBehavior(new ee(new W([[new _(.3,.6,.9,1),0]]))),r.circle.addBehavior(new ne(new W([[new _(10,13,16,19),0]]))),r.circle.emitter.renderOrder=2,r.circle.emitter.name="circle",r.add(r.circle.emitter),r}return Object(l.a)(n,[{key:"update",value:function(e){this.gatherParticles.update(e),this.beam.update(e),this.mainBeam.update(e),this.glowBeam.update(e),this.circle.update(e),this.smoke.update(e),this.particles.update(e)}}]),n}(T.i);ge.yellowColor=new T.x(.9,.6,.25,1),ge.yellowColor2=new T.x(1,.95,.4,1);var be=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).gatherParticles=void 0,r.glow=void 0,r.glow2=void 0,r.particle=void 0,r.name="levelUp";var a=e[0].texture,i=new T.x(.8,.8,.2,1);r.gatherParticles=new le({duration:.5,looping:!1,startLife:new J(.3,.4),startSpeed:new J(-100,-150),startSize:new J(1,2),startColor:new $(i),worldSpace:!1,maxParticle:100,emissionOverTime:new A(100),shape:new ie({radius:60,thickness:.8,arc:Math.PI}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.StretchedBillBoard,speedFactor:.05}),r.gatherParticles.addBehavior(new Z(new Y(new T.x(.2,.2,.2,1),new T.x(1,1,1,1)))),r.gatherParticles.emitter.name="gatherParticles",r.gatherParticles.emitter.renderOrder=2,r.add(r.gatherParticles.emitter);var o={duration:2,looping:!1,startLife:new A(2),startSpeed:new A(0),startSize:new J(120,160),startColor:new $(i),worldSpace:!1,maxParticle:10,emissionOverTime:new A(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:F.LocalSpaceBillBoard};r.glow=new le(o),r.glow.addBehavior(new ee(new W([[new _(0,.75,.9,1),0],[new _(1,.9,.75,0),.5]]))),r.glow.emitter.renderOrder=0,r.glow.emitter.name="glow",r.glow.emitter.rotation.x=-Math.PI/2,r.add(r.glow.emitter);var l={duration:2,looping:!1,startLife:new A(2),startSpeed:new A(0),startSize:new J(60,80),startColor:new $(i),worldSpace:!1,maxParticle:10,emissionOverTime:new A(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:F.BillBoard};r.glow2=new le(l),r.glow2.addBehavior(new ee(new W([[new _(0,.75,.9,1),0],[new _(1,.9,.75,0),.2]]))),r.glow2.emitter.renderOrder=0,r.glow2.emitter.name="glow2",r.add(r.glow2.emitter);var c={duration:1,looping:!1,startLife:new J(.6,.8),startSpeed:new J(120,180),startSize:new J(2,4),startColor:new $(i),worldSpace:!1,maxParticle:100,emissionOverTime:new W([[new _(0,0,0,0),0],[new _(50,80,80,50),.4]]),shape:new ae({radius:25,thickness:.2,angle:Math.PI/100}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.BillBoard};return r.particle=new le(c),r.particle.addBehavior(new ee(new W([[new _(0,.75,.9,1),0],[new _(1,.9,.75,0),.5]]))),r.particle.addBehavior(new re(new W([[new _(0,4*Math.PI*.75,4*Math.PI*.9,4*Math.PI),0]]))),r.particle.emitter.renderOrder=2,r.particle.emitter.name="particle",r.particle.emitter.rotation.x=-Math.PI/2,r.add(r.particle.emitter),r}return Object(l.a)(n,[{key:"update",value:function(e){this.gatherParticles.update(e),this.glow.update(e),this.glow2.update(e),this.particle.update(e)}}]),n}(T.i),ye=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).smoke=void 0,r.name="shipSmoke";var a=e[0].texture,i=new T.x(.5,.5,.5,1);return r.smoke=new le({duration:5,looping:!0,startLife:new J(1.5,3),startSpeed:new J(20,30),startSize:new J(10,15),startColor:new $(i),worldSpace:!0,maxParticle:100,emissionOverTime:new A(20),shape:new ae({radius:10,thickness:1,angle:.2}),texture:a,blending:T.m,startTileIndex:2,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.smoke.addBehavior(new Z(new Y(new T.x(1,1,1,1),new T.x(.8,.8,.8,0)))),r.smoke.addBehavior(new ee(new W([[new _(.2,1,1,1),0]]))),r.smoke.emitter.name="smoke",r.smoke.emitter.renderOrder=2,r.smoke.emitter.rotation.x=-Math.PI/2,r.add(r.smoke.emitter),r}return Object(l.a)(n,[{key:"update",value:function(e){this.smoke.update(e)}}]),n}(T.i),xe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).beam=void 0,r.beamWorld=void 0,r.electricity=void 0,r.electricBall=void 0,r.name="ElectricBall";var a=e[1].texture;return r.beam=new le({duration:1,looping:!0,startLife:new A(1),startSpeed:new A(0),startSize:new A(15),startColor:new $(new T.x(.5220588*.772549,.6440161*.772549,.772549,.772549)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(1),emissionBursts:[],shape:new oe,texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10}),r.beam.emitter.renderOrder=0,r.beam.emitter.name="beam",r.add(r.beam.emitter),r.beamWorld=new le({duration:1,looping:!0,startLife:new J(.1,.4),startSpeed:new A(0),startSize:new J(7.5,15),startColor:new q(new T.x(.11176472,.28738328,.8,1),new T.x(.8,.9275356*.8,.08235296,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(5,10),emissionBursts:[],shape:new ie({radius:.01,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10}),r.beamWorld.emitter.renderOrder=0,r.beamWorld.emitter.name="beamWorld",r.beamWorld.addBehavior(new Z(new Y(new T.x(1,1,1,1),new T.x(0,0,0,1)))),r.add(r.beamWorld.emitter),r.electricity=new le({duration:.5,looping:!0,startLife:new J(.2,.3),startSpeed:new A(0),startSize:new J(3,6),startRotation:new J(-Math.PI,Math.PI),startColor:new q(new T.x(.1397059,.3592291,1,1),new T.x(1,.9275356,.1029412,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new J(5,10),emissionBursts:[],shape:new oe,texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10}),r.electricity.addBehavior(new ne(new W([[new _(53,56,59,62),0]]))),r.electricity.addBehavior(new ee(new W([[new _(1,1,.75,0),0]]))),r.electricity.emitter.renderOrder=2,r.electricity.emitter.name="electricity",r.add(r.electricity.emitter),r.electricBall=new le({duration:.4,looping:!0,startLife:new J(.2,.4),startSpeed:new A(0),startSize:new J(5,10),startRotation:new J(-Math.PI,Math.PI),startColor:new q(new T.x(.1397059,.3592291,1,1),new T.x(1,.9275356,.1029412,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(3),emissionBursts:[],shape:new oe,texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10}),r.electricBall.addBehavior(new ne(new W([[new _(62,65,68,71),0]]))),r.electricBall.emitter.renderOrder=1,r.electricBall.emitter.name="electricBall",r.add(r.electricBall.emitter),r.userData={script:"    this.position.x += delta * 30;\n    if (this.position.x > 20)\n        this.position.x = -20;\n"},r.userData.func=new Function("delta",r.userData.script),r}return Object(l.a)(n,[{key:"update",value:function(e){this.beam.update(e),this.beamWorld.update(e),this.electricity.update(e),this.electricBall.update(e)}}]),n}(T.i),Se=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).particles=void 0,r.glowBeam=void 0,r.beam=void 0;var a=e[0].texture;return r.beam=new le({duration:1,looping:!0,startLife:new A(1),startSpeed:new A(0),startSize:new A(20),startColor:new $(new T.x(.5220588*.772549,.6440161*.772549,.772549,.772549)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(1),emissionBursts:[],shape:new oe,texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10}),r.beam.emitter.renderOrder=0,r.beam.emitter.name="beam",r.add(r.beam.emitter),r.add(r.beam.emitter),r.glowBeam=new le({duration:1,looping:!0,startLife:new A(.5),startSpeed:new A(0),startSize:new A(10),startColor:new $(new T.x(.5220588*.772549,.6440161*.772549,.772549,.772549)),worldSpace:!0,maxParticle:500,emissionOverTime:new A(120),shape:new ie({radius:1e-4,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10}),r.glowBeam.addBehavior(new ee(new W([[new _(1,1,.8,.5),0]]))),r.glowBeam.addBehavior(new Z(new Y(new T.x(1,1,1,1),new T.x(0,0,0,0)))),r.glowBeam.emitter.renderOrder=2,r.glowBeam.emitter.name="glowBeam",r.add(r.glowBeam.emitter),r.particles=new le({duration:1,looping:!0,startLife:new J(.3,.6),startSpeed:new J(20,40),startSize:new J(1,2),startColor:new q(new T.x(1,1,1,.5),new T.x(.5220588,.6440161,1,.772549)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(60),shape:new ae({angle:80/180*Math.PI,radius:1,thickness:.3,arc:2*Math.PI}),texture:a,renderMode:F.StretchedBillBoard,speedFactor:.2,blending:T.m,startTileIndex:0,uTileCount:10,vTileCount:10}),r.particles.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.particles.emitter.renderOrder=0,r.particles.emitter.rotateY(-Math.PI/2),r.particles.emitter.name="particles",r.add(r.particles.emitter),r.userData={script:"    this.position.x += delta * 200;\n    if (this.position.x > 200)\n        this.position.x = -200;\n"},r.userData.func=new Function("delta",r.userData.script),r}return Object(l.a)(n,[{key:"update",value:function(e){this.beam.update(e),this.glowBeam.update(e),this.particles.update(e)}}]),n}(T.i),Ce=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).mainBeam=void 0,r.glowBeam=void 0,r.smoke=void 0,r.particles=void 0,r.beam=void 0,r.circle=void 0,r.circle2=void 0;var a=e[0].texture,i=n.yellowColor,o=n.yellowColor2;return r.mainBeam=new le({duration:2,looping:!1,startLife:new J(.1,.3),startSpeed:new J(100,300),startSize:new J(1.5,12.5),startColor:new $(new T.x(1,1,1,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ie({radius:2,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.mainBeam.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.mainBeam.emitter.renderOrder=2,r.mainBeam.emitter.name="mainBeam",r.add(r.mainBeam.emitter),r.glowBeam=new le({duration:1,looping:!1,startLife:new J(1,1.6),startSpeed:new J(20,45),startSize:new J(4,8),startColor:new $(i),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ie({radius:2,thickness:1,arc:2*Math.PI}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.glowBeam.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.glowBeam.emitter.renderOrder=2,r.glowBeam.emitter.name="glowBeam",r.add(r.glowBeam.emitter),r.smoke=new le({duration:1,looping:!1,startLife:new J(.8,1.2),startSpeed:new J(20,50),startSize:new J(10,15),startRotation:new J(0,2*Math.PI),startColor:new $(new T.x(1,1,1,.5)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:12,cycle:1,interval:.01,probability:1}],shape:new ie({radius:7.5,arc:Math.PI,thickness:1}),texture:a,blending:T.m,startTileIndex:2,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.smoke.addBehavior(new ee(new W([[new _(1,.95,.75,0),0]]))),r.smoke.addBehavior(new Z(new Y(i,new T.x(0,0,0,0)))),r.smoke.addBehavior(new Q(new J(2*-Math.PI,2*Math.PI))),r.smoke.addBehavior(new te(new W([[new _(1,.95,.75,0),0]]))),r.smoke.emitter.renderOrder=-2,r.smoke.emitter.name="smoke",r.add(r.smoke.emitter),r.particles=new le({duration:1,looping:!1,startLife:new J(.6,1.2),startSpeed:new J(40,200),startSize:new J(1,4),startColor:new q(new T.x(1,1,1,1),i),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:12,cycle:1,interval:.01,probability:1}],shape:new ie({radius:2,thickness:1,arc:2*Math.PI}),texture:a,blending:T.m,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.StretchedBillBoard,speedFactor:.1}),r.particles.addBehavior(new ee(new W([[new _(1,.25,.05,0),0]]))),r.particles.emitter.renderOrder=0,r.particles.emitter.name="particles",r.add(r.particles.emitter),r.beam=new le({duration:1,looping:!1,startLife:new A(.2),startSpeed:new A(0),startSize:new A(100),startColor:new $(o),worldSpace:!1,maxParticle:10,emissionOverTime:new A(0),emissionBursts:[{time:0,count:2,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.beam.emitter.renderOrder=-2,r.beam.emitter.name="beam",r.beam.addBehavior(new ee(new W([[new _(1,.66666,.33333,0),0]]))),r.add(r.beam.emitter),r.circle=new le({duration:1,looping:!1,startLife:new A(.4),startSpeed:new A(0),startSize:new A(40),startColor:new $(o),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:10,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.circle.addBehavior(new ee(new W([[new _(.3,.6,.9,1),0]]))),r.circle.addBehavior(new ne(new W([[new _(10,13,16,19),0]]))),r.circle.emitter.renderOrder=2,r.circle.emitter.name="circle",r.add(r.circle.emitter),r.circle2=new le({duration:1,looping:!1,startLife:new A(.4),startSpeed:new A(0),startSize:new A(40),startColor:new $(o),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:10,uTileCount:10,vTileCount:10,renderMode:F.LocalSpaceBillBoard}),r.circle2.addBehavior(new ee(new W([[new _(.3,.6,.9,1),0]]))),r.circle2.addBehavior(new ne(new W([[new _(10,13,16,19),0]]))),r.circle2.emitter.renderOrder=2,r.circle2.emitter.name="circle",r.circle2.emitter.rotation.x=Math.PI/2,r.add(r.circle2.emitter),r}return Object(l.a)(n,[{key:"update",value:function(e){this.beam.update(e),this.mainBeam.update(e),this.glowBeam.update(e),this.circle.update(e),this.smoke.update(e),this.particles.update(e),this.circle2.update(e)}}]),n}(T.i);Ce.yellowColor=new T.x(.9,.6,.25,1),Ce.yellowColor2=new T.x(1,.95,.4,1);var Oe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).particles=void 0,r.glow=void 0,r.glowTop=void 0,r.ringBase=void 0;var a=e[1].texture;r.particles=new le({duration:1,looping:!1,startLife:new J(.2,.6),startSpeed:new J(20,50),startSize:new A(2),startColor:new $(new T.x(.5,.5,.5,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:24,cycle:1,interval:.01,probability:1}],shape:new ae({angle:.2,radius:5}),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:F.StretchedBillBoard,speedFactor:.1}),r.particles.emitter.renderOrder=0,r.particles.emitter.name="particles",r.particles.addBehavior(new ee(new W([[new _(1,.95,.75,0),0]]))),r.particles.addBehavior(new Z(new Y(new T.x(1,1,1,1),new T.x(0,.8,1,1)))),r.add(r.particles.emitter);var i={duration:1,looping:!1,startLife:new J(.6,.8),startSpeed:new A(0),startSize:new J(60,80),startColor:new $(new T.x(0,.3,.3,1)),worldSpace:!1,maxParticle:5,emissionOverTime:new A(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:F.BillBoard};r.glow=new le(i),r.glow.addBehavior(new Z(new Y(new T.x(1,1,1,1),new T.x(0,0,0,1)))),r.glow.emitter.renderOrder=-2,r.glow.emitter.name="glow",r.glow.emitter.position.x=1,r.add(r.glow.emitter),r.glowTop=new le({duration:1,looping:!1,startLife:new J(.6,.8),startSpeed:new J(0,50),startSize:new J(40,60),startRotation:new A(0),startColor:new $(new T.x(0,.2,.2,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new A(0),emissionBursts:[{time:0,count:5,cycle:1,interval:.01,probability:1}],shape:new ae({angle:.01,radius:1}),texture:a,blending:T.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:F.BillBoard}),r.glowTop.emitter.renderOrder=-2,r.glowTop.emitter.name="glowTop",r.glowTop.addBehavior(new Z(new me([[new Y(new T.x(1,1,1,1),new T.x(1,1,1,1)),0],[new Y(new T.x(1,1,1,1),new T.x(0,0,0,1)),.5]]))),r.add(r.glowTop.emitter);var o=new T.g(10,6,4,16,1,!0);return o.rotateX(Math.PI/2),r.ringBase=new le({duration:1,looping:!1,startLife:new A(.8),startSpeed:new A(0),startSize:new A(1),startColor:new $(new T.x(0,1,1,1)),worldSpace:!1,maxParticle:10,emissionOverTime:new A(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new oe,texture:a,blending:T.a,startTileIndex:91,uTileCount:10,vTileCount:10,instancingGeometry:o,renderMode:F.LocalSpaceBillBoard}),r.ringBase.addBehavior(new Z(new me([[new Y(new T.x(1,1,1,1),new T.x(1,1,1,1)),0],[new Y(new T.x(1,1,1,1),new T.x(0,0,0,1)),.5]]))),r.ringBase.addBehavior(new ee(new W([[new _(.5,.75,.95,1),0]]))),r.ringBase.emitter.renderOrder=1,r.ringBase.emitter.name="ringBase",r.add(r.ringBase.emitter),r}return Object(l.a)(n,[{key:"update",value:function(e){this.ringBase.update(e),this.glowTop.update(e),this.glow.update(e),this.particles.update(e)}}]),n}(T.i),ke=r.createContext(null),Ee=ke.Consumer,Be=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).removeObject3d=function(e){e.parent&&e.parent.remove(e)},r.duplicateObject3d=function(e){e.parent&&e.parent.add(e.clone())},r.addObject3d=function(e,t){var n;switch(e){case"particle":var a=r.state.textures[0].texture;n=new le({maxParticle:1e4,shape:new ae,emissionOverTime:new A(100),startLife:new A(30),startSpeed:new A(10),startSize:new A(1),startColor:new $(new T.x(1,1,1,1)),texture:a,blending:T.a,startTileIndex:0,uTileCount:10,vTileCount:10,worldSpace:!0}).emitter,r.state.scene.add(n);break;case"box":n=new T.k(new T.d(10,10,10),new T.l({color:13421772})),r.state.scene.add(n)}n&&(t.add(n),r.state.actions.select(n),r.setState({}))},r.update=0,r.animate=function(e){r.update+=e,r.update>.1&&(r.state.actions.updateProperties(),r.update=0)};var a=(new T.u).load("textures/texture1.png");a.name="textures/texture1.png";var i=(new T.u).load("textures/texture2.png");i.name="textures/texture2.png";var o={scene:r.createScene(-1),script:r.animate,selection:[],textures:[{img:"./textures/texture1.png",texture:a},{img:"./textures/texture2.png",texture:i}],actions:{onOpenDemo:function(e){var t=r.createScene(e);r.setState({scene:t})},onSaveAs:function(){var e=document.createElement("a"),t=new Blob([JSON.stringify(r.state.scene.toJSON())],{type:"application/json"});e.href=URL.createObjectURL(t),e.download="scene.json",e.click()},onImport:function(e){for(var t=e.length,n=0;n<t;n++){var a=URL.createObjectURL(e[n]),i=new pe;i.setCrossOrigin(""),i.load(a,(function(e){r.state.scene.add(e)}),(function(){}),(function(){}))}},select:function(e){r.setState({selection:[e]})},selectAddition:function(e){-1===r.state.selection.indexOf(e)&&(r.state.selection.push(e),r.setState({selection:r.state.selection}))},addObject3d:r.addObject3d,removeObject3d:r.removeObject3d,duplicateObject3d:r.duplicateObject3d,updateParticleSystem:function(){},updateProperties:function(){r.setState({scene:r.state.scene})},addTexture:function(e){r.state.textures.push(e),r.setState({textures:r.state.textures})}}};return r.state=o,r}return Object(l.a)(n,[{key:"createScene",value:function(e){var t,n=new T.q;n.background=new T.f(6710886),0===e?(t=new he(this.state.textures)).name="Toon Projectile":1===e?(t=new ve(this.state.textures)).name="BulletMuzzle":2===e?(t=new fe).name="BulletProjectile":3===e?(t=new ye(this.state.textures)).name="shipSmoke":4===e?(t=new we(this.state.textures)).name="ToonExplosion":5===e?(t=new ge(this.state.textures)).name="Explosion":6===e?(t=new be(this.state.textures)).name="LevelUp":7===e?(t=new Oe(this.state.textures)).name="EnergyRifleMuzzle":8==e?(t=new xe(this.state.textures)).name="ElectricBall":9==e?(t=new Se(this.state.textures)).name="ShipTrail":10==e&&((t=new Ce(this.state.textures)).name="Explosion2"),t&&n.add(t);var r=new T.c(100);r.name="axisHelper",n.add(r);var a=new T.o(new T.f(1,1,1),.8,200);a.position.set(50,50,50),n.add(a);var i=new T.b(new T.f(1,1,1),.2);return n.add(i),n}}]),Object(l.a)(n,[{key:"render",value:function(){return r.createElement(ke.Provider,{value:this.state},this.props.children)}}]),n}(r.Component),je=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).container=void 0,a.stats=void 0,a.camera=void 0,a.renderer=void 0,a.clock=void 0,a.controls=void 0,a.appContext=void 0,a.onResize=function(e){if(a.renderer.domElement.parentElement.clientWidth-10!==a.renderer.domElement.width||a.renderer.domElement.parentElement.clientHeight-10!==a.renderer.domElement.height){var t=a.renderer.domElement.parentElement.clientWidth-10,n=a.renderer.domElement.parentElement.clientHeight-10;a.camera.aspect=t/n,a.camera.updateProjectionMatrix(),a.renderer.domElement.style.width="100%",a.renderer.domElement.style.height="100%",a.renderer.setSize(t,n)}},a.animate=function(){requestAnimationFrame(a.animate),a.onResize(null),a.renderScene(),a.stats.update()},a.container=r.createRef(),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.init()&&this.animate()}},{key:"componentDidUpdate",value:function(e,t,n){this.camera.aspect=this.props.width/this.props.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.props.width,this.props.height)}},{key:"init",value:function(){if(!this.container.current)return!1;if(!j.isWebGLAvailable())return document.body.appendChild(j.getWebGLErrorMessage()),!1;this.renderer=new T.y;var e=this.props.width,t=this.props.height;return this.clock=new T.e,this.camera=new T.n(50,e/t,1,1e3),this.camera.position.set(50,50,50),this.controls=new P.a(this.camera,this.renderer.domElement),this.controls.enableKeys=!1,this.controls.enableDamping=!0,this.controls.dampingFactor=.1,this.controls.rotateSpeed=.2,this.controls.update(),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(e,t),this.container.current.appendChild(this.renderer.domElement),this.stats=new B.a,this.stats.dom.style.position="absolute",this.stats.dom.style.left="",this.stats.dom.style.right="0",this.container.current.appendChild(this.stats.dom),this.onResize(null),!0}},{key:"renderScene",value:function(){if(this.appContext){this.controls.update();var e=this.clock.getDelta();this.appContext.script(e),this.appContext.scene.traverse((function(t){t.userData&&t.userData.func&&t.userData.func.call(t,e),t instanceof V&&t.system.update(e)})),this.renderer.render(this.appContext.scene,this.camera)}}},{key:"render",value:function(){var e=this;return console.log("rendering ThreejsViewPort"),r.createElement(Ee,null,(function(t){if(t)return e.appContext=t,r.createElement("div",{ref:e.container,style:{width:"100%",height:"100%"}})}))}}]),n}(r.PureComponent),Te=(n(250),function(e){var t=r.useState(e.value+""),n=Object(z.a)(t,2),a=n[0],i=n[1],o=r.useState(!1),s=Object(z.a)(o,2),l=s[0],c=s[1];return r.createElement("input",{className:"number-input",value:l?a:e.value,size:5,onChange:function(e){l&&i(e.target.value)},onBlur:function(t){var n=parseFloat(a);n!==e.value&&e.onChange(n),c(!1)},onFocus:function(t){a!==e.value+""&&i(e.value+""),c(!0)},onKeyDown:function(t){if("Enter"===t.key){var n=parseFloat(a);n!==e.value&&e.onChange(n)}}})}),Pe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){console.log("rendered Vector3");var e=this.props,t=e.x,n=e.y,a=e.z,i=e.unitConversion,o=void 0===i?1:i,s=e.onChange,l=e.name;return r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},l),r.createElement("label",null,"X:"),r.createElement(Te,{value:t*o,onChange:function(e){s(e/o,n,a)}}),r.createElement("label",null,"Y:"),r.createElement(Te,{value:n*o,onChange:function(e){s(t,e/o,a)}}),r.createElement("label",null,"Z:"),r.createElement(Te,{value:a*o,onChange:function(e){s(t,n,e/o)}}))}}]),n}(r.PureComponent),Me=function(e){var t=r.useState(e.value),n=Object(z.a)(t,2),a=n[0],i=n[1],o=r.useState(!1),s=Object(z.a)(o,2),l=s[0],c=s[1];return r.createElement("input",{className:"string-input",value:l?a:e.value,size:20,onChange:function(e){l&&i(e.target.value)},onBlur:function(t){a!==e.value&&e.onChange(a),c(!1)},onFocus:function(t){a!==e.value&&i(e.value),c(!0)},onKeyDown:function(t){"Enter"===t.key&&a!==e.value&&e.onChange(a)}})},ze=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeName=function(e){r.props.object3d.name=e,r.props.updateProperties()},r.onChangePosition=function(e,t,n){r.props.object3d.position.set(e,t,n),r.props.updateProperties()},r.onChangeScale=function(e,t,n){r.props.object3d.scale.set(e,t,n),r.props.updateProperties()},r.onChangeRotation=function(e,t,n){r.props.object3d.rotation.set(e,t,n),r.props.updateProperties()},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return console.log("rendered objectProperties"),r.createElement("div",{className:"property-container"},r.createElement(Ee,null,(function(t){return t&&r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"Name:"),r.createElement(Me,{value:e.props.object3d.name,onChange:e.onChangeName}))})),r.createElement(Ee,null,(function(t){return t&&r.createElement(Pe,{name:"Position",x:e.props.object3d.position.x,y:e.props.object3d.position.y,z:e.props.object3d.position.z,onChange:e.onChangePosition})})),r.createElement(Ee,null,(function(t){return t&&r.createElement(Pe,{name:"Rotation",x:e.props.object3d.rotation.x,y:e.props.object3d.rotation.y,z:e.props.object3d.rotation.z,onChange:e.onChangeRotation,unitConversion:180/Math.PI})})),r.createElement(Ee,null,(function(t){return t&&r.createElement(Pe,{name:"Scale",x:e.props.object3d.scale.x,y:e.props.object3d.scale.y,z:e.props.object3d.scale.z,onChange:e.onChangeScale})})))}}]),n}(r.PureComponent),Le=n(203);n(414);function Ie(e){return"rgba(".concat(255*e.x|0,",").concat(255*e.y|0,",").concat(255*e.z|0,",").concat(e.w,")")}var Ne=function(e){var t=r.useState(!1),n=Object(z.a)(t,2),a=n[0],i=n[1],o=e.color,s=e.onChange;return r.createElement("div",{className:"color-editor"},r.createElement("button",{style:{backgroundColor:Ie(o),height:"20px"},onClick:function(){i(!a)}}),Ie(o),a?r.createElement("div",{className:"popover"},r.createElement("div",{className:"cover",onClick:function(){i(!1)}}),r.createElement(Le.SketchPicker,{color:{r:255*o.x|0,g:255*o.y|0,b:255*o.z|0,a:o.w},onChange:function(e){var t=new T.x;t.x=Math.min(255,e.rgb.r)/255,t.y=Math.min(255,e.rgb.g)/255,t.z=Math.min(255,e.rgb.b)/255,t.w=e.rgb.a,s(t)}})):null)},Fe=(n(415),n(22)),Re=n(18);function Ve(e,t,n){return e*(1-n)+t*n}var De=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).x=function(t){return Ve(e.props.xFrom,e.props.xTo,t)},e.y=function(t){return Ve(e.props.yFrom,e.props.yTo,t)},e}return Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=t.xFrom,r=t.yFrom,a=t.xTo,i=t.yTo;return e.xFrom!==n||e.yFrom!==r||e.xTo!==a||e.yTo!==i}}]),n}(a.a.Component),Ae=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(e){if(Object(Fe.a)(Object(Re.a)(n.prototype),"shouldComponentUpdate",this).call(this,e))return!0;var t=this.props,r=t.curveColor,a=t.curveWidth,i=t.value,o=Object(z.a)(i.p,4);o[0],o[1],o[2],o[3];return e.curveColor!==r||e.curveWidth!==a||e.value!==i}},{key:"render",value:function(){var e=this.props,t=e.curveColor,n=e.curveWidth,r=e.value,i=this.x,o=this.y,s=Math.floor((i(1)-i(0))/5),l="M".concat(i(0),",").concat(o(r.genValue(0))," ");if(s>0)for(var c=1/s;c<=1;c+=1/s)l+="L".concat(i(c),",").concat(o(r.genValue(c))," ");return l+="L".concat(i(1),",").concat(o(r.genValue(1))," "),a.a.createElement("path",{fill:"none",stroke:t,strokeWidth:n,d:l})}}]),n}(De),Je=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(e){if(Object(Fe.a)(Object(Re.a)(n.prototype),"shouldComponentUpdate",this).call(this,e))return!0;var t=this.props,r=t.xstart,a=t.ystart,i=t.handleRadius,o=t.handleColor,s=t.hover,l=t.down,c=t.background,u=t.handleStroke,d=t.xval,p=t.yval,m=t.onMouseEnter,h=t.onMouseLeave,v=t.onMouseDown;return e.xstart!==r||e.ystart!==a||e.handleRadius!==i||e.handleColor!==o||e.hover!==s||e.down!==l||e.background!==c||e.handleStroke!==u||e.xval!==d||e.yval!==p||e.onMouseDown!==v||e.onMouseLeave!==h||e.onMouseEnter!==m}},{key:"render",value:function(){var e=this.x,t=this.y,n=this.props,r=n.xstart,i=n.ystart,o=n.handleRadius,s=n.handleColor,l=n.hover,c=n.down,u=n.background,d=n.handleStroke,p=n.xval,m=n.yval,h=n.onMouseEnter,v=n.onMouseLeave,f=n.onMouseDown,w=e(r),g=t(i),b=e(p),y=t(m),x=Math.atan2(y-g,b-w),S=b-o*Math.cos(x),C=y-o*Math.sin(x);return a.a.createElement("g",null,a.a.createElement("line",{stroke:s,strokeWidth:l||c?1+d:d,x1:S,y1:C,x2:w,y2:g}),a.a.createElement("circle",{cx:b,cy:y,r:o,stroke:s,strokeWidth:c?2*d:d,fill:c?u:s,onMouseEnter:h,onMouseLeave:v,onMouseDown:f}))}}]),n}(De),Ue=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).rootRef=Object(r.createRef)(),a.positionForEvent=function(e){if(a.rootRef.current){var t=a.rootRef.current.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]}return[0,0]},a.x=function(e){},a.y=function(e){},a.inversex=function(e){},a.inversey=function(e){},a.onDownLeave=function(e){a.state.down&&(a.onDownMove(e),a.setState({down:-1,hover:-1}))},a.onDownMove=function(e){if(a.state.down>=0){e.preventDefault();var t=a.positionForEvent(e),n=Object(z.a)(t,2),r=n[0],i=n[1],o=new W(a.props.value.functions),s=(a.props.width,a.state.curve),l=o.getFunction(s);if(0===a.state.down){var c=l.p[0];if(l.p[0]=(a.props.height-i)/a.props.height,l.p[1]+=l.p[0]-c,o.setStartX(s,r/a.props.width),s-1>=0){var u=o.getFunction(s-1);u.p[3]=(a.props.height-i)/a.props.height,u.p[2]+=l.p[0]-c,o.setFunction(s-1,o.getFunction(s-1).clone())}o.setFunction(s,l.clone())}if(3===a.state.down){var d=l.p[3];if(l.p[3]=(a.props.height-i)/a.props.height,l.p[2]+=l.p[3]-d,o.setEndX(s,r/a.props.width),s+1<o.numOfFunctions){var p=o.getFunction(s+1);p.p[0]=(a.props.height-i)/a.props.height,p.p[1]+=l.p[3]-d,o.setFunction(s+1,o.getFunction(s+1).clone())}o.setFunction(s,l.clone())}1===a.state.down&&(l.p[1]=(a.props.height-i)/a.props.height,o.setFunction(s,l.clone())),2===a.state.down&&(l.p[2]=(a.props.height-i)/a.props.height,o.setFunction(s,l.clone())),a.props.onChange&&a.props.onChange(o)}},a.onDownUp=function(){a.setState({down:-1})},a.state={curve:-1,down:-1,hover:-1},a}return Object(l.a)(n,[{key:"onEnterHandle",value:function(e,t){this.state.down||this.setState({hover:t,curve:e})}},{key:"onDownHandle",value:function(e,t,n){n.preventDefault(),this.setState({hover:-1,down:t,curve:e})}},{key:"onLeaveHandle",value:function(){this.state.down||this.setState({hover:-1})}},{key:"render",value:function(){for(var e=this,t=this.props,a=t.width,i=t.height,o=t.value,s=t.curveWidth,l=void 0===s?1:s,c=t.curveColor,u=void 0===c?"#000":c,d=t.handleRadius,p=void 0===d?n.defaultP.handleRadius:d,m=t.handleColor,h=void 0===m?"#f00":m,v=t.handleStroke,f=void 0===v?1:v,w=t.background,g=void 0===w?"#fff":w,b=this.state,y=b.curve,x=b.down,S=b.hover,C=[],O=function(t){var n=o.getStartX(t),s=o.getEndX(t),c=o.getFunction(t),d=c.getSlope(0),m=c.getSlope(1);C.push(r.createElement("g",{key:t},r.createElement(Ae,{xFrom:n*a,xTo:s*a,yFrom:i,yTo:0,curveColor:u,curveWidth:l,value:c}),r.createElement(Je,{xFrom:n*a,xTo:s*a,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,0,n)},onMouseEnter:function(n){return e.onEnterHandle(t,0)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:0,ystart:c.p[0],xval:0,yval:c.p[0],handleRadius:p,handleColor:h,down:y===t&&0===x,hover:y===t&&0===S,handleStroke:f,background:g}),r.createElement(Je,{xFrom:n*a,xTo:s*a,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,1,n)},onMouseEnter:function(n){return e.onEnterHandle(t,1)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:0,ystart:c.p[0],xval:1/3,yval:1/3*d+c.p[0],handleRadius:p,handleColor:h,down:y===t&&1===x,hover:y===t&&1===S,handleStroke:f,background:g}),r.createElement(Je,{xFrom:n*a,xTo:s*a,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,2,n)},onMouseEnter:function(n){return e.onEnterHandle(t,2)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:1,ystart:c.p[3],xval:1-1/3,yval:c.p[3]-1/3*m,handleRadius:p,handleColor:h,down:y===t&&2===x,hover:y===t&&2===S,handleStroke:f,background:g}),r.createElement(Je,{xFrom:n*a,xTo:s*a,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,3,n)},onMouseEnter:function(n){return e.onEnterHandle(t,3)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:1,ystart:c.p[3],xval:1,yval:c.p[3],handleRadius:p,handleColor:h,down:y===t&&3===x,hover:y===t&&3===S,handleStroke:f,background:g})))},k=0;k<o.numOfFunctions;k++)O(k);return r.createElement("div",{ref:this.rootRef,onMouseMove:this.onDownMove,onMouseUp:this.onDownUp,onMouseLeave:this.onDownLeave},r.createElement("svg",{width:a,height:i},C))}}]),n}(r.PureComponent);Ue.defaultP={padding:[0,0,0,0],handleRadius:4};var _e={value:["constant","intervalValue"],functionValue:["piecewiseBezier"],color:["color","randomColor"],functionColor:["colorRange","gradient"]},We=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).changeEditor=function(e){var t=null;switch(e.target.value){case"constant":t=new A(0);break;case"color":t=new $(new T.x(1,1,1,1));break;case"intervalValue":t=new J(0,1);break;case"colorRange":t=new Y(new T.x(0,0,0,1),new T.x(1,1,1,1));break;case"randomColor":t=new q(new T.x(0,0,0,1),new T.x(1,1,1,1));break;case"piecewiseBezier":t=new W}t&&r.props.updateGenerator(t)},r.changeValue=function(e){r.props.updateGenerator(new A(e))},r.changeColor=function(e){r.props.updateGenerator(new $(e))},r.changeValueA=function(e){var t=r.props.generator;r.props.updateGenerator(new J(e,t.b))},r.changeValueB=function(e){var t=r.props.generator;r.props.updateGenerator(new J(t.a,e))},r.changeColorRangeA=function(e){var t=r.props.generator;r.props.updateGenerator(new Y(e,t.b))},r.changeColorRangeB=function(e){var t=r.props.generator;r.props.updateGenerator(new Y(t.a,e))},r.changeRandomColorA=function(e){var t=r.props.generator;r.props.updateGenerator(new q(e,t.b))},r.changeRandomColorB=function(e){var t=r.props.generator;r.props.updateGenerator(new q(t.a,e))},r.changeCurve=function(e){r.props.updateGenerator(new W(e.functions))};_e[e.allowedType[0]][0];return r.state={open:!1},r}return Object(l.a)(n,[{key:"getEditorType",value:function(e){return e instanceof A?"constant":e instanceof J?"intervalValue":e instanceof W?"piecewiseBezier":e instanceof $?"color":e instanceof q?"randomColor":e instanceof Y?"colorRange":e instanceof me?"gradient":"constant"}},{key:"render",value:function(){var e,t=this.props,n=t.name,a=t.generator,i=t.allowedType,o=[],s=Object(M.a)(i);try{for(s.s();!(e=s.n()).done;){var l,c=e.value,u=Object(M.a)(_e[c]);try{for(u.s();!(l=u.n()).done;){var d=l.value;o.push(d)}}catch(h){u.e(h)}finally{u.f()}}}catch(h){s.e(h)}finally{s.f()}var p,m=this.getEditorType(a);switch(m){case"constant":p=r.createElement(r.Fragment,null,r.createElement(Te,{value:a.value,onChange:this.changeValue}));break;case"color":p=r.createElement(r.Fragment,null,r.createElement(Ne,{color:a.color,onChange:this.changeColor}));break;case"intervalValue":p=r.createElement(r.Fragment,null,r.createElement(Te,{value:a.a,onChange:this.changeValueA}),"-",r.createElement(Te,{value:a.b,onChange:this.changeValueB}));break;case"piecewiseBezier":p=r.createElement(r.Fragment,null,r.createElement(Ue,{height:40,width:240,value:a,onChange:this.changeCurve}));break;case"colorRange":p=r.createElement(r.Fragment,null,r.createElement(Ne,{color:a.a,onChange:this.changeColorRangeA}),"-",r.createElement(Ne,{color:a.b,onChange:this.changeColorRangeB}));break;case"randomColor":p=r.createElement(r.Fragment,null,r.createElement(Ne,{color:a.a,onChange:this.changeRandomColorA}),"-",r.createElement(Ne,{color:a.b,onChange:this.changeRandomColorB}))}return r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},n),p,r.createElement("select",{className:"editor-select",onChange:this.changeEditor,value:m},o.map((function(e){return r.createElement("option",{key:e,value:e},e)}))))}}]),n}(r.PureComponent),Ge=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeStartSpeed=function(e){console.log("change start speed"),r.props.particleSystem.startSpeed=e,r.props.updateProperties()},r.onChangeStartLife=function(e){console.log("change start life"),r.props.particleSystem.startLife=e,r.props.updateProperties()},r.onChangeStartSize=function(e){console.log("change start size"),r.props.particleSystem.startSize=e,r.props.updateProperties()},r.onChangeStartColor=function(e){console.log("change start color"),r.props.particleSystem.startColor=e,r.props.updateProperties()},r.OnChangeStartRotation=function(e){console.log("change start rotation"),r.props.particleSystem.startRotation=e,r.props.updateProperties()},r.OnChangeEmissionOverTime=function(e){console.log("change start rotation"),r.props.particleSystem.emissionOverTime=e,r.props.updateProperties()},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;console.log("rendered objectProperties");var t=["value","functionValue"],n=["color","functionColor"];return r.createElement("div",{className:"property-container"},r.createElement(Ee,null,(function(n){return n&&r.createElement(We,{name:"Start Life",allowedType:t,generator:e.props.particleSystem.startLife,updateGenerator:e.onChangeStartLife})})),r.createElement(Ee,null,(function(n){return n&&r.createElement(We,{name:"Start Size",allowedType:t,generator:e.props.particleSystem.startSize,updateGenerator:e.onChangeStartSize})})),r.createElement(Ee,null,(function(n){return n&&r.createElement(We,{name:"Start Speed",allowedType:t,generator:e.props.particleSystem.startSpeed,updateGenerator:e.onChangeStartSpeed})})),r.createElement(Ee,null,(function(t){return t&&r.createElement(We,{name:"Start Color",allowedType:n,generator:e.props.particleSystem.startColor,updateGenerator:e.onChangeStartColor})})),r.createElement(Ee,null,(function(n){return n&&r.createElement(We,{name:"Start Rotation",allowedType:t,generator:e.props.particleSystem.startRotation,updateGenerator:e.OnChangeStartRotation})})),r.createElement(Ee,null,(function(n){return n&&r.createElement(We,{name:"Emission Over Time",allowedType:t,generator:e.props.particleSystem.emissionOverTime,updateGenerator:e.OnChangeEmissionOverTime})})))}}]),n}(r.PureComponent),He=n(209),Xe=n(472),qe=n(11),Ye=n(473),$e=n(474),Ke=n(475),Ze=n(204),Qe=n.n(Ze),et=n(489),tt=n(476),nt=n(477),rt=n(478),at=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).handleChange=function(e){e.target.files&&r.props.onChange(e.target.files)},r}return Object(l.a)(n,[{key:"render",value:function(){return r.createElement("div",null,r.createElement("input",{accept:"image/*",type:"file",id:"contained-button-file",style:{display:"none"},onChange:this.handleChange}),r.createElement("label",{htmlFor:"contained-button-file"},r.createElement(d.a,{variant:"contained",color:"primary",component:"span"},"Upload")))}}]),n}(r.Component),it=(n(416),Object(Xe.a)((function(e){return Object(h.a)({root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},gridList:{width:500,height:450}})}))),ot=Object(qe.a)((function(e){return Object(h.a)({root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})}))((function(e){var t=e.children,n=e.classes,r=e.onClose,i=Object(He.a)(e,["children","classes","onClose"]);return a.a.createElement(Ye.a,Object.assign({disableTypography:!0,className:n.root},i),a.a.createElement(f.a,{variant:"h6"},t),r?a.a.createElement(w.a,{"aria-label":"close",className:n.closeButton,onClick:r},a.a.createElement(Qe.a,null)):null)})),st=Object(qe.a)((function(e){return{root:{padding:e.spacing(2)}}}))($e.a),lt=Object(qe.a)((function(e){return{root:{margin:0,padding:e.spacing(1)}}}))(Ke.a),ct=function(e){var t=it(),n=Object(r.useState)(0),i=Object(z.a)(n,2),o=i[0],s=i[1];return a.a.createElement(et.a,{onClose:e.handleClose,"aria-labelledby":"customized-dialog-title",open:e.open},a.a.createElement(ot,{id:"customized-dialog-title",onClose:e.handleClose},"Picker Texture"),a.a.createElement(st,{dividers:!0},a.a.createElement("div",{className:t.root},a.a.createElement(tt.a,{cellHeight:160,className:t.gridList,cols:3},e.textures.map((function(e,t){return a.a.createElement(nt.a,{key:e.img,cols:1,onClick:function(){s(t)},className:t===o?"selected-tile":""},a.a.createElement("img",{src:e.img,alt:e.texture.name}),a.a.createElement(rt.a,{title:e.texture.name,subtitle:a.a.createElement("span",null,"by: ",e.texture.name)}))}))))),a.a.createElement(lt,null,a.a.createElement(at,{onChange:e.handleUpload}),a.a.createElement(d.a,{variant:"contained",onClick:function(){e.handleSelect(e.textures[o]),e.handleClose()}},"Confirm")))},ut=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeStartTile=function(e){r.props.particleSystem.startTileIndex=e,r.props.updateProperties()},r.onChangeUTileCount=function(e){r.props.particleSystem.uTileCount=e,r.props.updateProperties()},r.onChangeVTileCount=function(e){r.props.particleSystem.vTileCount=e,r.props.updateProperties()},r.onChangeBlending=function(e){switch(e.target.value){case"Normal":r.props.particleSystem.blending=T.m,r.props.particleSystem.emitter.material.blending=T.m;break;case"Additive":r.props.particleSystem.blending=T.a,r.props.particleSystem.emitter.material.blending=T.a}r.props.updateProperties()},r.getValueOfBlending=function(e){switch(e){case T.m:return"Normal";case T.a:return"Additive"}},r.onChangeRenderMode=function(e){switch(e.target.value){case"BillBoard":r.props.particleSystem.renderMode=F.BillBoard;break;case"LocalSpaceBillBoard":r.props.particleSystem.renderMode=F.LocalSpaceBillBoard;break;case"StretchedBillBoard":r.props.particleSystem.renderMode=F.StretchedBillBoard}r.props.updateProperties()},r.getValueOfRenderMode=function(e){switch(e){case F.BillBoard:return"BillBoard";case F.LocalSpaceBillBoard:return"LocalSpaceBillBoard";case F.StretchedBillBoard:return"StretchedBillBoard"}},r.onChangeWorldSpace=function(e){switch(e.target.value){case"True":r.props.particleSystem.worldSpace=!0;break;case"False":r.props.particleSystem.worldSpace=!1}r.props.updateProperties()},r.getValueOfBoolean=function(e){return e?"True":"False"},r.onUploadTexture=function(e){return function(t){console.log("upload texture");var n=document.createElement("img"),r=new T.t(n);if(n.onload=function(){r.needsUpdate=!0},t&&t[0]){var a=new FileReader;a.onload=function(e){n.src=a.result},a.readAsDataURL(t[0]),r.name=t[0].name;var i={img:URL.createObjectURL(t[0]),texture:r};e.actions.addTexture(i)}}},r.onChangeTexture=function(e){console.log("change texture"),r.props.particleSystem.texture=e.texture,r.props.updateProperties()},r.closeTexturePicker=function(){r.setState({texturePickerOpen:!1})},r.openTexturePicker=function(){r.setState({texturePickerOpen:!0})},r.state={texturePickerOpen:!1},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return console.log("rendered particleRendererProperties"),r.createElement("div",{className:"property-container"},r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"RenderMode"),r.createElement("select",{className:"editor-select",onChange:this.onChangeRenderMode,value:this.getValueOfRenderMode(this.props.particleSystem.renderMode)},r.createElement("option",{key:0,value:"BillBoard"},"BillBoard"),r.createElement("option",{key:1,value:"LocalSpaceBillBoard"},"Local Space BillBoard"),r.createElement("option",{key:2,value:"StretchedBillBoard"},"Stretched BillBoard"))),r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"World Space"),r.createElement("select",{className:"editor-select",onChange:this.onChangeWorldSpace,value:this.getValueOfBoolean(this.props.particleSystem.worldSpace)},r.createElement("option",{key:0,value:"True"},"True"),r.createElement("option",{key:1,value:"False"},"False"))),r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"Blend Mode"),r.createElement("select",{className:"editor-select",onChange:this.onChangeBlending,value:this.getValueOfBlending(this.props.particleSystem.blending)},r.createElement("option",{key:0,value:"Normal"},"Normal"),r.createElement("option",{key:1,value:"Additive"},"Additive"))),r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"UVTile"),r.createElement("label",null,"Column:"),r.createElement(Te,{value:this.props.particleSystem.uTileCount,onChange:this.onChangeUTileCount}),r.createElement("label",null,"Row:"),r.createElement(Te,{value:this.props.particleSystem.vTileCount,onChange:this.onChangeVTileCount})),r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"Start Tile Index"),r.createElement(Te,{value:this.props.particleSystem.startTileIndex,onChange:this.onChangeStartTile})),r.createElement(Ee,null,(function(t){for(var n,a=0;a<t.textures.length;a++)t.textures[a].texture===e.props.particleSystem.texture&&(n=t.textures[a]);var i=1,o=1;return n&&(i=n.texture.image.width/e.props.particleSystem.uTileCount,o=n.texture.image.height/e.props.particleSystem.vTileCount),r.createElement("div",{className:"property"},r.createElement("label",{className:"name"},"Texture"),n&&r.createElement("img",{className:"texture-preview",src:n.img,alt:n.texture.name,style:{objectPosition:"-".concat(e.props.particleSystem.startTileIndex%e.props.particleSystem.uTileCount*i,"px -").concat(Math.floor(e.props.particleSystem.startTileIndex/e.props.particleSystem.uTileCount)*o,"px"),width:i,height:o}}),r.createElement(d.a,{onClick:e.openTexturePicker,variant:"contained"},"Pick"))})),r.createElement(Ee,null,(function(t){return t&&r.createElement(ct,{handleClose:e.closeTexturePicker,handleSelect:e.onChangeTexture,handleUpload:e.onUploadTexture(t),open:e.state.texturePickerOpen,textures:t.textures})})))}}]),n}(r.PureComponent),dt=n(205),pt=n.n(dt),mt=n(154),ht=(n(417),function(e){var t=r.useState(e.value),n=Object(z.a)(t,2),a=n[0],i=n[1],o=r.useState(!1),s=Object(z.a)(o,2),l=s[0],c=s[1];return r.createElement(pt.a,{value:l?a:e.value,onValueChange:function(e){l&&i(e)},highlight:function(e){return Object(mt.highlight)(e,mt.languages.javascript,"javascript")},padding:10,onBlur:function(t){a!==e.value&&e.onChange(a),c(!1)},onFocus:function(t){a!==e.value&&i(e.value),c(!0)},style:{fontFamily:'"Consolas", monospace',fontSize:12}})}),vt=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeScript=function(e){null===r.props.object3d.userData&&(r.props.object3d.userData={}),r.props.object3d.userData.script=e,r.props.object3d.userData.func=new Function("delta",e),r.props.updateProperties()},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.createElement("div",null,r.createElement(Ee,null,(function(t){return t&&r.createElement("div",{className:"property"},r.createElement("label",{className:"script"},"Script:"),r.createElement(ht,{value:e.props.object3d.userData.script||"",onChange:e.onChangeScript}))})))}}]),n}(r.PureComponent),ft=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).getValueOfShape=function(e){return r.props.particleSystem.emitterShape instanceof oe?"PointEmitter":r.props.particleSystem.emitterShape instanceof ae?"ConeEmitter":r.props.particleSystem.emitterShape instanceof ie?"SphereEmitter":r.props.particleSystem.emitterShape instanceof se?"DonutEmitter":""},r.onChangeShape=function(e){switch(e.target.value){case"PointEmitter":r.props.particleSystem.emitterShape instanceof oe||(r.props.particleSystem.emitterShape=new oe,r.props.updateProperties());break;case"ConeEmitter":r.props.particleSystem.emitterShape instanceof ae||(r.props.particleSystem.emitterShape=new ae,r.props.updateProperties());break;case"SphereEmitter":r.props.particleSystem.emitterShape instanceof ie||(r.props.particleSystem.emitterShape=new ie,r.props.updateProperties());break;case"DonutEmitter":r.props.particleSystem.emitterShape instanceof se||(r.props.particleSystem.emitterShape=new se,r.props.updateProperties())}},r.onChangeKeyValue=function(e,t){r.props.particleSystem.emitterShape[e]=t,r.props.updateProperties()},r}return Object(l.a)(n,[{key:"renderShapeProperties",value:function(){var e=this,t=[],n=function(n){t.push(a.a.createElement("div",{key:n,className:"property"},a.a.createElement("label",{className:"name"},n,":"),a.a.createElement(Te,{value:e.props.particleSystem.emitterShape[n],onChange:function(t){return e.onChangeKeyValue(n,t)}})))};for(var r in this.props.particleSystem.emitterShape)n(r);return t}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"property-container"},a.a.createElement(Ee,null,(function(t){return t&&a.a.createElement("div",{className:"property"},a.a.createElement("label",{className:"name"},"Shape"),a.a.createElement("select",{className:"editor-select",onChange:e.onChangeShape,value:e.getValueOfShape(e.props.particleSystem.emitterShape)},a.a.createElement("option",{key:0,value:"PointEmitter"},"PointEmitter"),a.a.createElement("option",{key:1,value:"ConeEmitter"},"ConeEmitter"),a.a.createElement("option",{key:2,value:"SphereEmitter"},"SphereEmitter"),a.a.createElement("option",{key:3,value:"DonutEmitter"},"DonutEmitter")))})),a.a.createElement(Ee,null,(function(t){return t&&e.renderShapeProperties()})))}}]),n}(a.a.PureComponent),wt=n(479),gt=n(491),bt=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).getSystems=function(){var e=[];return r.props.object3d instanceof V&&e.push(r.props.object3d.system),r.props.object3d.traverse((function(t){t instanceof V&&e.push(t.system)})),e},r.checkPause=function(e){var t=!0;return e.forEach((function(e){e.paused||(t=!1)})),t},r.togglePause=function(){var e=r.getSystems();r.checkPause(e)?e.forEach((function(e){e.play()})):e.forEach((function(e){e.pause()})),r.props.updateProperties()},r.onRestart=function(){r.getSystems().forEach((function(e){e.restart()})),r.props.updateProperties()},r.onStop=function(){r.getSystems().forEach((function(e){e.restart(),e.pause()})),r.props.updateProperties()},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.createElement("div",null,r.createElement(gt.a,{color:"primary","aria-label":"primary button group"}),r.createElement(Ee,null,(function(t){return t&&r.createElement(wt.a,{color:"primary","aria-label":"primary button group"},r.createElement(d.a,{disabled:!e.checkPause(e.getSystems()),onClick:e.togglePause},"Play"),r.createElement(d.a,{disabled:e.checkPause(e.getSystems()),onClick:e.togglePause},"Pause"),r.createElement(d.a,{onClick:e.onRestart},"Restart"),r.createElement(d.a,{onClick:e.onStop},"Stop"))})))}}]),n}(r.PureComponent),yt=n(482),xt=n(490),St=n(44),Ct=n.n(St),Ot=n(483),kt=(n(420),n(208)),Et=n(469),Bt=n(440),jt=n(480),Tt=n(481),Pt=n(486),Mt=n(206),zt=n.n(Mt)()((function(e){return Object(h.a)({root:{width:"100%"},listRoot:{width:"100%",backgroundColor:e.palette.background.paper}})}));var Lt=r.memo((function(e){var t=zt(),n=r.useState([0,1,2,3]),a=Object(z.a)(n,2),i=a[0],o=a[1],s=r.useState(1),l=Object(z.a)(s,2),c=l[0],u=l[1],h=r.useState(null),v=Object(z.a)(h,2),f=v[0],w=v[1],g=function(t){return function(){var n;switch(t){case"ColorOverLife":n=new Z(new Y(new T.x(1,1,1,1),new T.x(0,0,0,1)));break;case"RotationOverLife":n=new Q(new W([[new _(0,.3333,.6667,1),0]]));break;case"SizeOverLife":n=new ee(new W([[new _(0,.3333,.6667,1),0]]));break;case"FrameOverLife":n=new ne(new W([[new _(0,.3333,.6667,1),0]]));break;case"OrbitOverLife":n=new re(new W([[new _(0,.3333,.6667,1),0]]));break;case"SpeedOverLife":n=new te(new W([[new _(1,.6667,.3333,0),0]]))}n&&(e.behaviors.push(n),e.updateProperties()),w(null)}},b=function(t){return function(n){var r=e.behaviors[t];switch(r.type){case"ColorOverLife":r.func=n;break;case"RotationOverLife":r.angularVelocityFunc=n;break;case"SizeOverLife":case"FrameOverLife":r.func=n;break;case"OrbitOverLife":r.angularVelocityFunc=n}console.log("changing"),e.updateProperties()}};return r.createElement("div",{className:t.root},r.createElement(wt.a,{color:"primary","aria-label":"primary button group"},r.createElement(d.a,{color:"inherit","aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){w(e.currentTarget)},id:"new-button"},"New"),r.createElement(p.a,{id:"simple-menu",anchorEl:f,keepMounted:!0,open:Boolean(f),onClose:function(){w(null)}},r.createElement(m.a,{onClick:g("SizeOverLife")},"SizeOverLife"),r.createElement(m.a,{onClick:g("ColorOverLife")},"ColorOverLife"),r.createElement(m.a,{onClick:g("RotationOverLife")},"RotationOverLife"),r.createElement(m.a,{onClick:g("FrameOverLife")},"FrameOverLife"),r.createElement(m.a,{onClick:g("OrbitOverLife")},"OrbitOverLife"),r.createElement(m.a,{onClick:g("SpeedOverLife")},"SpeedOverLife")),r.createElement(d.a,{onClick:function(){e.behaviors.splice(c,1),e.updateProperties()}},"Remove")),r.createElement(Et.a,{dense:!0,className:t.listRoot},r.createElement(Ee,null,(function(t){return t&&e.behaviors.map((function(e,t){var n,a,s,l="behavior-list-label-".concat(t),d=null;switch(e.type){case"ColorOverLife":n=["functionColor"],d=e.func;break;case"RotationOverLife":n=["functionValue","value"],d=e.angularVelocityFunc;break;case"SizeOverLife":case"FrameOverLife":n=["functionValue"],d=e.func;break;case"OrbitOverLife":n=["functionValue"],d=e.angularVelocityFunc;break;case"SpeedOverLife":n=["functionValue"],d=e.func;break;default:n=["functionValue"]}return d&&(a=r.createElement(We,{name:"Func",allowedType:n,generator:d,updateGenerator:b(t)})),r.createElement(Bt.a,{key:t,selected:c===t,onClick:function(e){return function(e,t){u(t)}(0,t)}},r.createElement(jt.a,null,r.createElement(Pt.a,{edge:"end",onChange:(s=t,function(){var e=i.indexOf(s),t=Object(kt.a)(i);-1===e?t.push(s):t.splice(e,1),o(t)}),checked:-1!==i.indexOf(t),inputProps:{"aria-labelledby":l}})),r.createElement(Tt.a,{id:l,primary:e.type,secondary:a}))}))}))))})),It=y()({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(xt.a),Nt=y()({root:{backgroundColor:"rgba(0, 0, 0, .03)",borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:32,"&$expanded":{minHeight:32}},content:{margin:0,"&$expanded":{margin:0}},expandIcon:{padding:0},expanded:{}})(yt.a),Ft=Object(Xe.a)((function(e){return Object(h.a)({root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}})}));function Rt(e){var t=Ft(),n=r.useState(["Object","EmitterShape","ParticleRenderer","ParticleEmitter","Behaviors","Script"]),a=Object(z.a)(n,2),i=a[0],o=a[1],s=function(e){return function(t,n){n?i.push(e):i.splice(i.indexOf(e),1),o(i)}};return r.createElement("div",{className:t.root},r.createElement(Ee,null,(function(t){return t&&r.createElement(bt,{object3d:e.object3d,updateProperties:t.actions.updateProperties})})),r.createElement(It,{expanded:-1!==i.indexOf("Object"),onChange:s("Object")},r.createElement(Nt,{expandIcon:r.createElement(Ct.a,null),"aria-controls":"object-content",id:"object-header"},r.createElement(f.a,{className:t.heading},"Object")),r.createElement(Ot.a,null,r.createElement(Ee,null,(function(t){return t&&r.createElement(ze,{object3d:e.object3d,updateProperties:t.actions.updateProperties})})))),e.object3d instanceof V&&r.createElement(It,{expanded:-1!==i.indexOf("EmitterShape"),onChange:s("EmitterShape")},r.createElement(Nt,{expandIcon:r.createElement(Ct.a,null),"aria-controls":"emitter-shape-content",id:"emitter-shape-header"},r.createElement(f.a,{className:t.heading},"Emitter Shape")),r.createElement(Ot.a,null,r.createElement(Ee,null,(function(t){return t&&r.createElement(ft,{particleSystem:e.object3d.system,updateProperties:t.actions.updateProperties})})))),e.object3d instanceof V&&r.createElement(It,{expanded:-1!==i.indexOf("ParticleRenderer"),onChange:s("ParticleRenderer")},r.createElement(Nt,{expandIcon:r.createElement(Ct.a,null),"aria-controls":"particle-renderer-content",id:"particle-renderer-header"},r.createElement(f.a,{className:t.heading},"Particle Renderer")),r.createElement(Ot.a,null,r.createElement(Ee,null,(function(t){return t&&r.createElement(ut,{particleSystem:e.object3d.system,updateProperties:t.actions.updateProperties})})))),e.object3d instanceof V&&r.createElement(It,{expanded:-1!==i.indexOf("ParticleEmitter"),onChange:s("ParticleEmitter")},r.createElement(Nt,{expandIcon:r.createElement(Ct.a,null),"aria-controls":"particle-emitter-content",id:"particle-emitter-header"},r.createElement(f.a,{className:t.heading},"Particle Emitter")),r.createElement(Ot.a,null,r.createElement(Ee,null,(function(t){return t&&r.createElement(Ge,{particleSystem:e.object3d.system,updateProperties:t.actions.updateProperties})})))),e.object3d instanceof V&&r.createElement(It,{expanded:-1!==i.indexOf("Behaviors"),onChange:s("Behaviors")},r.createElement(Nt,{expandIcon:r.createElement(Ct.a,null),"aria-controls":"behaviors-content",id:"behaviors-header"},r.createElement(f.a,{className:t.heading},"Behaviors")),r.createElement(Ot.a,null,r.createElement(Ee,null,(function(t){return t&&r.createElement(Lt,{behaviors:e.object3d.system.behaviors,updateProperties:t.actions.updateProperties})})))),r.createElement(It,{expanded:-1!==i.indexOf("Script"),onChange:s("Script")},r.createElement(Nt,{expandIcon:r.createElement(Ct.a,null),"aria-controls":"script-content",id:"script-header"},r.createElement(f.a,{className:t.heading},"Script")),r.createElement(Ot.a,null,r.createElement(Ee,null,(function(t){return t&&r.createElement(vt,{object3d:e.object3d,updateProperties:t.actions.updateProperties})})))))}n(421),n(422);var Vt=n(34),Dt=(n(431),n(485)),At=n(207),Jt=n.n(At),Ut=n(484),_t=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"camelize",value:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")}},{key:"camelizeClass",value:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return e.toUpperCase()})).replace(/\s+/g,"")}},{key:"exportBezier",value:function(e){return"new Bezier(".concat(e.p[0],", ").concat(e.p[1],", ").concat(e.p[2],", ").concat(e.p[3],")")}},{key:"exportColor",value:function(e){return"new Vector4(".concat(e.x,", ").concat(e.y,", ").concat(e.z,", ").concat(e.w,")")}},{key:"exportFunction",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t instanceof A)return"new ConstantValue(".concat(t.value,")");if(t instanceof $)return"new ConstantColor(".concat(e.exportColor(t.color),")");if(t instanceof J)return"new IntervalValue(".concat(t.a,", ").concat(t.b,")");if(t instanceof Y)return"new ColorRange(".concat(e.exportColor(t.a),", ").concat(e.exportColor(t.b),")");if(t instanceof q)return"new RandomColor(".concat(e.exportColor(t.a),", ").concat(e.exportColor(t.b),")");if(t instanceof W){for(var r="new PiecewiseBezier(\n",a=0;a<t.functions.length-1;a++)r+=" ".repeat(n+4)+"[".concat(e.exportBezier(t.functions[a][0]),", ").concat(t.functions[a][1],"], ");return r+=" ".repeat(n+4)+"[".concat(e.exportBezier(t.functions[t.functions.length-1][0]),", ").concat(t.functions[t.functions.length-1][1],"]"),r+=" ".repeat(n)+")"}if(t instanceof A)return"new ConstantValue(".concat(t.value,")");throw new Error}},{key:"exportParticleEmitter",value:function(t){var n=e.camelize(t.name),r=t.system,a="        this.".concat(n," = new ParticleSystem({\n");a+="            duration: ".concat(r.duration,",\n"),a+="            looping: ".concat(r.looping,",\n"),a+="            startLife: ".concat(e.exportFunction(r.startLife),",\n"),a+="            startSpeed: ".concat(e.exportFunction(r.startSpeed),",\n"),a+="            startSize: ".concat(e.exportFunction(r.startSize),",\n"),a+="            startColor: ".concat(e.exportFunction(r.startColor),",\n"),a+="            worldSpace: ".concat(r.worldSpace,",\n"),a+="            maxParticle: ".concat(r.maxParticle,",\n"),a+="            emissionOverTime: ".concat(e.exportFunction(r.emissionOverTime),",\n"),a+="            emissionBursts: ".concat(r.emissionBursts,",\n"),a+="            shape: ".concat(r.emitterShape,",\n"),a+="            texture: texture,\n",a+="            blending: ".concat(r.blending,",\n"),a+="            startTileIndex: ".concat(r.startTileIndex,",\n"),a+="            uTileCount: ".concat(r.uTileCount,",\n"),a+="            vTileCount: ".concat(r.vTileCount,",\n"),a+="            renderMode: ".concat(r.renderMode,",\n"),r.renderMode==F.StretchedBillBoard&&(a+="            speedFactor: ".concat(r.speedFactor,",\n")),a+="        }\n";for(var i=0;i<r.behaviors.length;i++)a+="        this.".concat(n,".addBehavior(").concat(r.behaviors[i],");\n");return a+="        this.".concat(n,".emitter.renderOrder = ").concat(r.emitter.renderOrder,";\n"),a+="        this.".concat(n,".emitter.name = '").concat(n,"';\n"),a+="        this.".concat(n,".emitter.rotation.set(").concat(r.emitter.rotation.x,", ").concat(r.emitter.rotation.y,", ").concat(r.emitter.rotation.z,");\n"),a+="        this.add(this.".concat(n,".emitter);\n"),a+="\n"}},{key:"exportCode",value:function(t){for(var n="export class ".concat(e.camelizeClass(t.name)," extends Group {\n"),r=0;r<t.children.length;r++)t.children[r]instanceof V&&(n+="    private ".concat(e.camelize(t.children[r].name),": ParticleSystem;\n"));n+="\n",n+="    constructor() {\n",n+="        super();\n",n+="        this.name = '".concat(t.name,"';\n"),n+='        let texture = new TextureLoader().load( "textures/texture1.png");\n',n+='        texture.name = "textures/texture1.png";\n';for(var a=0;a<t.children.length;a++)t.children[a]instanceof V&&(n+=e.exportParticleEmitter(t.children[a]));n+="    }\n",n+="\n",n+="    update(delta: number) {\n";for(var i=0;i<t.children.length;i++)t.children[i]instanceof V&&(n+="        ".concat(e.camelize(t.children[i].name),".update(delta);\n"));return n+="    }\n",n+="}"}}]),e}();function Wt(e){a.a.useRef(null);return a.a.createElement("div",null,a.a.createElement(et.a,{open:e.open,onClose:e.handleClose,scroll:"paper","aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description"},a.a.createElement(Ye.a,{id:"scroll-dialog-title"},"Particle System Code"),a.a.createElement($e.a,{dividers:!0},a.a.createElement(ht,{value:e.content,onChange:function(){}})),a.a.createElement(Ke.a,null,a.a.createElement(d.a,{onClick:e.handleClose,color:"primary"},"Confirm"))))}var Gt=Object(Xe.a)((function(e){return Object(h.a)({root:{height:240,flexGrow:1},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}})}));function Ht(e){var t,n,r=Gt(),i=a.a.useState([]),o=Object(z.a)(i,2),s=o[0],l=o[1],c=a.a.useState(["1"]),u=Object(z.a)(c,2),d=u[0],p=u[1],m=a.a.useState(""),h=Object(z.a)(m,2),v=h[0],w=h[1],g=function(t,n){if(n.length>0){var r=function e(t,n){if(0==t)return[n,0];t--;var r,a=Object(M.a)(n.children);try{for(a.s();!(r=a.n()).done;){var i=e(t,r.value),o=Object(z.a)(i,2),s=o[0],l=o[1];if(s)return[s,l];t=l}}catch(c){a.e(c)}finally{a.f()}return[null,t]}(parseInt(n[0]),e.scene),a=Object(z.a)(r,1)[0];a&&e.context.actions.select(a)}l(n)},b=function(e,t){"svg"===e.target.tagName&&p(t)},y=function(e){var t="object";t=e instanceof V?"ParticleSystem":e.type;var n="unnamed";return e.name&&(n=e.name),"[".concat(t,"] ").concat(n)};return a.a.createElement("div",null,a.a.createElement(f.a,{className:r.heading}," Scene Graph "),(t=e.context,n=e.scene,a.a.createElement(Dt.a,{className:r.root,selected:s,expanded:d,onNodeToggle:b,onNodeSelect:g,defaultCollapseIcon:a.a.createElement(Ct.a,null),defaultExpandIcon:a.a.createElement(Jt.a,null)},function e(t,n,r){var i=[],o=r;r++;var s,l=Object(M.a)(n.children);try{for(l.s();!(s=l.n()).done;){var c=e(t,s.value,r);i.push(c[0]),r=c[1]}}catch(u){l.e(u)}finally{l.f()}return 0!==o?[a.a.createElement(Ut.a,{key:n.uuid,nodeId:""+o,label:a.a.createElement(Vt.MenuProvider,{id:"scene-graph-menu",data:{object3d:n}},y(n)+" "+o)},i),r]:[a.a.createElement(a.a.Fragment,null,i),r]}(t,n,0)[0])),a.a.createElement(Vt.Menu,{id:"scene-graph-menu"},a.a.createElement(Vt.Submenu,{label:"Add"},a.a.createElement(Vt.Item,{onClick:function(t){t.event;var n=t.props;n.object3d&&e.context.actions.addObject3d("particle",n.object3d)}},"Particle System"),a.a.createElement(Vt.Item,{onClick:function(e){var t=e.event,n=e.props;return console.log(t,n)}},"Ball")),a.a.createElement(Vt.Separator,null),a.a.createElement(Vt.Item,{onClick:function(t){t.event;var n=t.props;n.object3d&&e.context.actions.duplicateObject3d(n.object3d)}},"Duplicate"),a.a.createElement(Vt.Item,{onClick:function(t){t.event;var n=t.props;n.object3d&&e.context.actions.removeObject3d(n.object3d)}},"Remove"),a.a.createElement(Vt.Separator,null),a.a.createElement(Vt.Item,{onClick:function(e){e.event;var t=e.props;if(console.log(t),t.object3d){var n=document.createElement("a"),r=t.object3d.toJSON(),a=new Blob([JSON.stringify(r)],{type:"application/json"});n.href=URL.createObjectURL(a),n.download="scene.json",n.click()}}},"Export"),a.a.createElement(Vt.Item,{onClick:function(e){e.event;var t=e.props;t.object3d&&w(_t.exportCode(t.object3d))}},"Copy JS Code")),a.a.createElement(Wt,{content:v,open:""!==v,handleClose:function(){w("")}}))}var Xt=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"render",value:function(){return console.log("render application"),r.createElement(Be,null,r.createElement("div",{className:"application"},r.createElement("div",{className:"main-menu"},r.createElement(Ee,null,(function(e){return e&&r.createElement(k,{onSaveAs:e.actions.onSaveAs,onImport:e.actions.onImport,onOpenDemo:e.actions.onOpenDemo})}))),r.createElement("div",{className:"main"},r.createElement("div",{className:"viewport"},r.createElement(je,{width:600,height:600})),r.createElement("div",{className:"sidebar"},r.createElement(Ee,null,(function(e){return e&&r.createElement(Ht,{context:e,scene:e.scene})})),r.createElement(Ee,null,(function(e){return e&&e.selection.length>0&&r.createElement(Rt,{object3d:e.selection[0]})}))))))}}]),n}(r.Component),qt=n(152),Yt=n.n(qt),$t=n(151),Kt=n.n($t),Zt=n(150),Qt=n.n(Zt),en=n(471),tn=Qt()({palette:{primary:{main:Yt.a[500]},secondary:{main:Kt.a[500]}},typography:{fontSize:12}}),nn=function(){return a.a.createElement(en.a,{theme:tn},a.a.createElement(Xt,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(nn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[221,1,2]]]);
//# sourceMappingURL=main.78cf4236.chunk.js.map