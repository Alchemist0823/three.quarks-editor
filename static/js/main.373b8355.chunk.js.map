{"version":3,"sources":["components/MainMenu.tsx","WebGL.ts","../../three.quarks/dist/three.quarks.esm.js","example/ToonProjectile.ts","example/BulletMuzzle.ts","example/BulletProjectile.ts","example/BulletHit.ts","example/ToonExplosion.ts","example/Explosion.ts","example/LevelUp.ts","components/ApplicationContext.tsx","components/ThreejsViewport.tsx","components/editors/NumberInput.tsx","components/editors/Vector3Editor.tsx","components/editors/StringInput.tsx","components/ObjectProperties.tsx","components/editors/ColorEditor.tsx","components/editors/bezier/TransformComponent.tsx","components/editors/bezier/CurveComponent.tsx","components/editors/bezier/HandleComponent.tsx","components/editors/bezier/BezierCurvesEditor.tsx","components/editors/GeneratorEditor.tsx","components/ParticleSystemProperties.tsx","components/editors/FileInput.tsx","components/ParticleRendererProperties.tsx","components/editors/ScriptEditor.tsx","components/ScriptProperties.tsx","components/EmitterShapeProperties.tsx","components/ParticleSystemController.tsx","components/BehaviorsProperties.tsx","components/PropertiesEditor.tsx","components/SceneGraphViewMaterial.tsx","components/Application.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["styles","createStyles","theme","root","flexGrow","menuIcon","marginRight","spacing","menuButton","title","MainMenu","props","fileRef","openFileDialog","e","current","click","importFile","target","files","onImport","openDemo","demoIndex","onOpenDemo","handleMenuClick","event","console","log","currentTarget","setState","anchorEl","handleMenuClose","undefined","state","React","classes","this","className","AppBar","position","Toolbar","variant","IconButton","edge","color","aria-label","Typography","Button","aria-controls","aria-haspopup","onClick","id","Menu","keepMounted","open","Boolean","onClose","MenuItem","onSaveAs","ref","type","multiple","accept","style","display","onChange","withStyles","withTheme","WEBGL","isWebGLAvailable","canvas","document","createElement","window","WebGLRenderingContext","getContext","isWebGL2Available","WebGL2RenderingContext","getWebGLErrorMessage","getErrorMessage","getWebGL2ErrorMessage","version","contexts","1","2","message","element","fontFamily","fontSize","fontWeight","textAlign","background","padding","width","margin","replace","innerHTML","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","RenderMode","particle_frag","particle_vert","local_particle_vert","stretched_bb_particle_vert","_Mesh","ParticleEmitter","_super","system","parameters","_this","call","geometry","renderMode","BillBoard","speedFactor","worldSpace","instancingGeometry","Float32Array","uniforms","defines","interleavedBuffer","setIndex","setAttribute","offsetBuffer","maxParticle","setUsage","colorBuffer","rotationBuffer","sizeBuffer","tiling","texture","copy","matrix","uTileCount","vTileCount","tileCount","uvTileBuffer","LocalSpaceBillBoard","vertexShader","side","material","fragmentShader","transparent","depthWrite","blending","StretchedBillBoard","Error","velocityBuffer","frustumCulled","clone","emitter","particles","particleNum","instanceCount","i","particle","setXYZ","x","y","z","setXYZW","w","setX","rotation","size","velocity","uvTile","updateRange","count","needsUpdate","dispose","cache","values","data","metadata","push","meta","isRootObject","output","geometries","materials","textures","images","shapes","generator","object","uuid","name","castShadow","receiveShadow","visible","renderOrder","JSON","stringify","userData","layers","mask","toArray","matrixAutoUpdate","ps","toJSON","children","length","extractFromCache","Particle","ConstantValue","json","IntervalValue","a","b","lerp","Math","random","PiecewiseFunction","functions","Array","t","mid","left","right","getStartX","getEndX","index","func","get","Bezier","p1","p2","p3","p4","p","t2","t3","mt","mt2","mt3","points","dpoints","c","list","j","dpt","derivativeCoefficients","d0","d1","pt","_p","q","idx","l","hull","span","p0","_PiecewiseFunction","PiecewiseBezier","_super2","_this2","curves","arguments","findFunction","error","genValue","segments","result","join","map","_ref","_ref2","bezier","start","function","_ref3","_ref4","piecewiseFunction","fromJSON","ValueGeneratorFromJSON","ColorToJSON","r","g","RandomColor","rand","ColorRange","ConstantColor","ColorGeneratorFromJSON","ColorOverLife","delta","genColor","age","life","dot","startColor","RotationOverLife","angularVelocityFunc","angularVelocity","SizeOverLife","startSize","FrameOverLife","floor","OrbitOverLife","atan2","len","sqrt","cos","sin","ConeEmitter","radius","arc","PI","thickness","angle","u","theta","sinTheta","cosTheta","set","addScaledVector","multiplyScalar","startSpeed","SphereEmitter","v","phi","acos","cbrt","sinPhi","cosPhi","setScalar","PointEmitter","DonutEmitter","ParticleSystem","autoDestroy","duration","looping","startLife","startRotation","emissionOverTime","emissionOverDistance","emissionBursts","emitterShape","shape","behaviors","startTileIndex","burstIndex","burstWaveIndex","time","paused","waitEmiting","emitEnded","markForDestroy","initialize","applyMatrix4","matrixWorld","applyMatrix3","normalMatrix","parent","remove","endEmit","getNormalMatrix","spawn","probability","_i","_particle","update","image","url","from","array","behavior","_step","newEmissionBursts","_iterator","s","n","done","emissionBurst","newEmissionBurst","assign","err","f","_step2","newBehaviors","_iterator2","BehaviorFromJSON","TEXTURE_MAPPING","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","CubeUVReflectionMapping","CubeUVRefractionMapping","TEXTURE_WRAPPING","RepeatWrapping","ClampToEdgeWrapping","MirroredRepeatWrapping","TEXTURE_FILTER","NearestFilter","NearestMipmapNearestFilter","NearestMipmapLinearFilter","LinearFilter","LinearMipmapNearestFilter","LinearMipmapLinearFilter","QuarksLoader","manager","resourcePath","path","crossOrigin","onLoad","onProgress","onError","scope","extractUrlBase","loader","setPath","load","text","parse","toLowerCase","itemStart","itemEnd","itemError","setCrossOrigin","il","isArray","jl","currentUrl","test","loadImage","parseConstant","warn","mapping","offset","fromArray","repeat","center","wrap","wrapS","wrapT","format","encoding","minFilter","magFilter","anisotropy","flipY","premultiplyAlpha","unpackAlignment","decompose","quaternion","scale","add","parseObject","parseImages","parseTextures","_PiecewiseFunction2","Gradient","_super3","_this3","getFunction","_ref5","_ref6","range","_ref7","_ref8","ToonProjectile","smoke","glowBeam","mainBeam","TextureLoader","Vector4","AdditiveBlending","addBehavior","NormalBlending","rotateY","Group","BulletMuzzle","beam","muzzle1","muzzle2","flash","cycle","interval","muzzle","BulletProjectile","hProjectile","vProjectile","projectileParam","BulletHit","ToonExplosion","circle","Explosion","gatherParticles","mainColor","yellowColor","secColor","yellowColor2","LevelUp","glow","glowParam","particleParam","ApplicationContext","ApplicationContextConsumer","Consumer","ApplicationContextProvider","removeObject3d","object3D","duplicateObject3d","addObject3d","scene","Mesh","BoxBufferGeometry","MeshStandardMaterial","actions","select","animate","updateProperties","createScene","script","selection","file","Blob","href","URL","createObjectURL","download","nFiles","nFileId","jsonURL","selectAddition","indexOf","updateParticleSystem","demoObject","THREE","Color","Function","axisHelper","AxesHelper","light","PointLight","ambientLight","AmbientLight","Provider","ThreejsViewport","container","stats","camera","renderer","clock","controls","appContext","onResize","domElement","parentElement","clientWidth","clientHeight","height","newWidth","newHeight","aspect","updateProjectionMatrix","setSize","requestAnimationFrame","renderScene","init","prevProps","prevState","snapshot","body","appendChild","WebGLRenderer","Clock","PerspectiveCamera","OrbitControls","enableKeys","enableDamping","dampingFactor","rotateSpeed","setPixelRatio","devicePixelRatio","Stats","dom","getDelta","traverse","render","context","NumberInput","inputValue","setInputValue","focus","setFocus","onBlur","parseFloat","onFocus","onKeyDown","Vector3Editor","unitConversion","StringInput","ObjectProperties","onChangeName","object3d","onChangePosition","onChangeScale","onChangeRotation","ConvertToColor","ColorEditor","setOpen","backgroundColor","colorResult","min","rgb","interp","TransformComponent","xFrom","xTo","yFrom","yTo","nextProps","Component","CurveComponent","curveColor","curveWidth","curve","fill","stroke","strokeWidth","d","HandleComponent","xstart","ystart","handleRadius","handleColor","hover","down","handleStroke","xval","yval","onMouseEnter","onMouseLeave","onMouseDown","sx","sy","cx","cy","cxs","cys","x1","y1","x2","y2","BezierCurvesEditor","rootRef","createRef","positionForEvent","rect","getBoundingClientRect","clientX","clientY","top","inversex","inversey","onDownLeave","onDownMove","preventDefault","curveIndex","old","setStartX","pCurve","setFunction","setEndX","numOfFunctions","nCurve","onDownUp","h","defaultP","slope0","getSlope","slope1","onDownHandle","onEnterHandle","onLeaveHandle","onMouseMove","onMouseUp","ValueToEditor","GeneratorEditor","changeEditor","updateGenerator","changeValue","changeColor","changeValueA","changeValueB","changeColorRangeA","colorRange","changeColorRangeB","changeRandomColorA","randomColor","changeRandomColorB","changeCurve","allowedType","editorTypes","valueType","editorType","editor","currentEditor","getEditorType","ParticleSystemProperties","onChangeStartSpeed","particleSystem","onChangeStartLife","onChangeStartSize","onChangeStartColor","OnChangeStartRotation","OnChangeEmissionOverTime","valueFunctionTypes","colorValueFunctionTypes","FileInput","handleChange","fileName","ParticleRendererProperties","onChangeTexture","Texture","onload","reader","FileReader","src","readAsDataURL","onChangeStartTile","onChangeUTileCount","onChangeVTileCount","onChangeBlending","getValueOfBlending","ScriptEditor","onValueChange","highlight","code","languages","javascript","ScriptProperties","onChangeScript","EmitterShapeProperties","getValueOfShape","onChangeShape","onChangeKeyValue","k","properties","renderShapeProperties","PureComponent","ParticleSystemController","getSystems","systems","checkPause","forEach","togglePause","play","pause","onRestart","restart","onStop","ToggleButtonGroup","ButtonGroup","disabled","useStyles","makeStyles","listRoot","palette","paper","BehaviorsProperties","checked","setChecked","selectedIndex","setSelectedIndex","setAnchorEl","handleClose","onChangeBehaviorFunc","List","dense","valueTypes","labelId","ListItem","selected","handleListItemClick","ListItemIcon","Checkbox","currentIndex","newChecked","splice","inputProps","ListItemText","primary","secondary","Accordion","border","boxShadow","borderBottom","expanded","MuiAccordion","AccordionSummary","marginBottom","minHeight","content","expandIcon","MuiAccordionSummary","heading","typography","pxToRem","fontWeightRegular","PropertiesEditor","setExpanded","panel","isExpanded","AccordionDetails","SceneGraphViewMaterial","useState","setSelected","handleSelect","nodeIds","countIndex","res","parseInt","handleToggle","tagName","getObjectName","TreeView","onNodeToggle","onNodeSelect","defaultCollapseIcon","defaultExpandIcon","renderObject","items","originIndex","TreeItem","nodeId","label","Fragment","contextProps","Application","createMuiTheme","main","blue","red","App","ThemeProvider","location","hostname","match","ReactDOM","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.373b8355.chunk.js","sourcesContent":["import * as React from \"react\";\r\nimport Button from '@material-ui/core/Button';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport {createStyles, Theme, Typography, Toolbar} from \"@material-ui/core\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\n\r\ninterface MainMenuProps {\r\n    onSaveAs: () => void;\r\n    onImport: (files: FileList) => void;\r\n    onOpenDemo: (demoIndex: number) => void;\r\n    classes: any\r\n}\r\n\r\ninterface MainMenuState {\r\n    anchorEl?: Element\r\n}\r\n\r\nconst styles = createStyles((theme: Theme) => ({\r\n    root: {\r\n        flexGrow: 1,\r\n    },\r\n    menuIcon: {\r\n        marginRight: theme.spacing(2),\r\n    },\r\n    menuButton: {\r\n        marginRight: theme.spacing(1),\r\n    },\r\n    title: {\r\n        marginRight: theme.spacing(1),\r\n        //flexGrow: 1,\r\n    },\r\n}));\r\n\r\nclass MainMenu extends React.PureComponent<MainMenuProps, MainMenuState> {\r\n    private fileRef: React.RefObject<HTMLInputElement>;\r\n\r\n    constructor(props: Readonly<MainMenuProps>) {\r\n        super(props);\r\n        this.state = {\r\n            anchorEl: undefined\r\n        }\r\n\r\n        this.fileRef = React.createRef();\r\n    }\r\n\r\n    openFileDialog = (e: React.MouseEvent<Element, MouseEvent>) => {\r\n        if (this.fileRef.current)\r\n            this.fileRef.current.click();\r\n    };\r\n\r\n    importFile = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (e.target.files)\r\n            this.props.onImport(e.target.files);\r\n    };\r\n\r\n    openDemo = (demoIndex: number) => {\r\n        this.props.onOpenDemo(demoIndex);\r\n    };\r\n\r\n    handleMenuClick = (event: React.MouseEvent<Element, MouseEvent>) => {\r\n        console.log(event.currentTarget);\r\n        this.setState({anchorEl: event.currentTarget});\r\n    };\r\n\r\n    handleMenuClose = () => {\r\n        this.setState({anchorEl: undefined});\r\n    };\r\n\r\n    render() {\r\n        //<Image size='mini' src='/logo.png' style={{ marginRight: '1.5em' }} />\r\n        //<MenuIcon />\r\n        //<IconButton edge=\"start\" className={classes.menuButton} color=\"inherit\" aria-label=\"menu\">\r\n        //</IconButton>\r\n        const {classes} = this.props;\r\n        return (\r\n            <div className={classes.root}>\r\n                <AppBar position=\"static\">\r\n                    <Toolbar variant=\"dense\">\r\n                        <IconButton edge=\"start\" className={classes.menuIcon} color=\"inherit\" aria-label=\"menu\">\r\n                            <MenuIcon/>\r\n                        </IconButton>\r\n                        <Typography variant=\"h6\" className={classes.title}>\r\n                            Three.Quarks\r\n                        </Typography>\r\n                        <Button color=\"inherit\" className={classes.menuButton} aria-controls=\"simple-menu\"\r\n                                aria-haspopup=\"true\" onClick={this.handleMenuClick} id=\"file-button\">\r\n                            File\r\n                        </Button>\r\n                        <Menu\r\n                            id=\"file-menu\"\r\n                            anchorEl={this.state.anchorEl}\r\n                            keepMounted\r\n                            open={Boolean(this.state.anchorEl && this.state.anchorEl.id === \"file-button\")}\r\n                            onClose={this.handleMenuClose}\r\n                        >\r\n                            <MenuItem>New</MenuItem>\r\n                            <MenuItem onClick={this.openFileDialog}>Open</MenuItem>\r\n                            <MenuItem onClick={this.props.onSaveAs}>Download</MenuItem>\r\n                            <input ref={this.fileRef} type=\"file\" id=\"fileElem\" multiple accept=\"application/json\"\r\n                                   style={{display: \"none\"}}\r\n                                   onChange={this.importFile}/>\r\n                        </Menu>\r\n                        <Button color=\"inherit\" className={classes.menuButton} aria-controls=\"simple-menu\"\r\n                                aria-haspopup=\"true\" onClick={this.handleMenuClick} id=\"demo-button\">\r\n                            Demo\r\n                        </Button>\r\n                        <Menu\r\n                            id=\"demo-menu\"\r\n                            anchorEl={this.state.anchorEl}\r\n                            keepMounted\r\n                            open={Boolean(this.state.anchorEl && this.state.anchorEl.id === \"demo-button\")}\r\n                            onClose={this.handleMenuClose}\r\n                        >\r\n                            <MenuItem onClick={() => this.openDemo(0)}>Demo PlasmaProjectile</MenuItem>\r\n                            <MenuItem onClick={() => this.openDemo(1)}>Demo BulletMuzzle</MenuItem>\r\n                            <MenuItem onClick={() => this.openDemo(2)}>Demo BulletProjectile</MenuItem>\r\n                            <MenuItem onClick={() => this.openDemo(3)}>Demo BulletProjectile</MenuItem>\r\n                            <MenuItem onClick={() => this.openDemo(4)}>Demo HitImpact</MenuItem>\r\n                            <MenuItem onClick={() => this.openDemo(5)}>Demo Explosion</MenuItem>\r\n                            <MenuItem onClick={() => this.openDemo(6)}>Demo Levelup</MenuItem>\r\n                        </Menu>\r\n                    </Toolbar>\r\n                </AppBar>\r\n            </div>);\r\n    }\r\n}\r\n\r\nexport default withStyles(styles, {withTheme: true})(MainMenu);","/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mr.doob / http://mrdoob.com/\r\n */\r\n\r\nexport const WEBGL = {\r\n    isWebGLAvailable: function () {\r\n\r\n        try {\r\n            const canvas = document.createElement( 'canvas' );\r\n            // @ts-ignore\r\n            return !! ( window.WebGLRenderingContext && ( canvas.getContext( 'webgl' ) || canvas.getContext( 'experimental-webgl' ) ) );\r\n        } catch ( e ) {\r\n            return false;\r\n        }\r\n\r\n    },\r\n\r\n    isWebGL2Available: function () {\r\n        try {\r\n            const canvas = document.createElement( 'canvas' );\r\n            // @ts-ignore\r\n            return !! ( window.WebGL2RenderingContext && canvas.getContext( 'webgl2' ) );\r\n        } catch ( e ) {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    getWebGLErrorMessage: function () {\r\n        return this.getErrorMessage( 1 );\r\n    },\r\n\r\n    getWebGL2ErrorMessage: function () {\r\n        return this.getErrorMessage( 2 );\r\n    },\r\n\r\n    getErrorMessage: function ( version: number ) {\r\n        const names :{[version:number]: string} = {\r\n            1: 'WebGL',\r\n            2: 'WebGL 2'\r\n        };\r\n\r\n        const contexts :{[version:number]: string} = {\r\n            // @ts-ignore\r\n            1: window.WebGLRenderingContext,\r\n            // @ts-ignore\r\n            2: window.WebGL2RenderingContext\r\n        };\r\n\r\n        let message = 'Your $0 does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000\">$1</a>';\r\n\r\n        const element = document.createElement( 'div' );\r\n        element.id = 'webglmessage';\r\n        element.style.fontFamily = 'monospace';\r\n        element.style.fontSize = '13px';\r\n        element.style.fontWeight = 'normal';\r\n        element.style.textAlign = 'center';\r\n        element.style.background = '#fff';\r\n        element.style.color = '#000';\r\n        element.style.padding = '1.5em';\r\n        element.style.width = '400px';\r\n        element.style.margin = '5em auto 0';\r\n\r\n        if ( contexts[ version ] ) {\r\n            message = message.replace( '$0', 'graphics card' );\r\n        } else {\r\n            message = message.replace( '$0', 'browser' );\r\n        }\r\n        message = message.replace( '$1', names[ version ] );\r\n        element.innerHTML = message;\r\n\r\n        return element;\r\n    }\r\n\r\n};\r\n","import _createForOfIteratorHelper from \"C:\\\\personal\\\\three.quarks-editor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";\nimport _slicedToArray from \"C:\\\\personal\\\\three.quarks-editor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"C:\\\\personal\\\\three.quarks-editor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\personal\\\\three.quarks-editor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"C:\\\\personal\\\\three.quarks-editor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"C:\\\\personal\\\\three.quarks-editor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\personal\\\\three.quarks-editor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\n\n/**\n * three.quarks v0.2.5 build Wed Oct 07 2020\n * https://github.com/Alchemist0823/three.quarks#readme\n * Copyright 2020 undefined, MIT\n */\nimport { Mesh, InstancedBufferGeometry, InterleavedBuffer, InterleavedBufferAttribute, InstancedBufferAttribute, DynamicDrawUsage, Uniform, Matrix3, Vector2, ShaderMaterial, AdditiveBlending, DoubleSide, FrontSide, Vector4, Vector3, MathUtils, DefaultLoadingManager, LoaderUtils, FileLoader, LoadingManager, ImageLoader, CubeTexture, Texture, Object3D, Group, UVMapping, CubeReflectionMapping, CubeRefractionMapping, EquirectangularReflectionMapping, EquirectangularRefractionMapping, CubeUVReflectionMapping, CubeUVRefractionMapping, RepeatWrapping, ClampToEdgeWrapping, MirroredRepeatWrapping, NearestFilter, NearestMipMapNearestFilter, NearestMipMapLinearFilter, LinearFilter, LinearMipMapNearestFilter, LinearMipMapLinearFilter } from 'three';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar particle_frag =\n/* glsl */\n\"\\n\\n#include <common>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\n\\nvarying vec4 vColor;\\n\\nvoid main() {\\n\\n    #include <clipping_planes_fragment>\\n    \\n    vec3 outgoingLight = vec3( 0.0 );\\n    vec4 diffuseColor = vColor;\\n    \\n    #include <logdepthbuf_fragment>\\n    \\n    #ifdef USE_MAP\\n    vec4 texelColor = texture2D( map, vUv);\\n    diffuseColor *= texelColor;\\n    #endif\\n\\n    outgoingLight = diffuseColor.rgb;\\n\\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n    \\n    #include <tonemapping_fragment>\\n\\n}\\n\";\n/*\r\n    gl_FragColor = vec4(vUv.x, vUv.y, 1.0, 1.0);\r\n\r\n    #ifdef USE_MAP\r\n    vec4 texelColor = texture2D( map, vUv);\r\n    diffuseColor *= texelColor;\r\n    #endif\r\n\r\n    outgoingLight = diffuseColor.rgb;\r\n\r\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\r\n*/\n\nvar particle_vert =\n/* glsl */\n\"\\n\\n#include <uv_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\n\\nattribute vec3 offset;\\nattribute float rotation;\\nattribute float size;\\nattribute vec4 color;\\nattribute float uvTile;\\n\\nvarying vec4 vColor;\\n\\n#ifdef UV_TILE\\nuniform vec2 tileCount;\\n#endif\\n\\nvoid main() {\\n\\n    #ifdef UV_TILE\\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\\n    #else\\n        #include <uv_vertex>\\n    #endif\\n\\t\\n\\t#ifdef WORLD_SPACE\\n\\t    vec4 mvPosition = viewMatrix * vec4( offset, 1.0 );\\n\\t#else\\n\\t    vec4 mvPosition = modelViewMatrix * vec4( offset, 1.0 );\\n\\t#endif\\n\\t\\n    vec2 alignedPosition = ( position.xy ) * size;\\n    \\n    vec2 rotatedPosition;\\n    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\\n    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\\n    \\n    mvPosition.xy += rotatedPosition;\\n\\n\\tvColor = color;\\n\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\n}\\n\";\n/*\r\n\t#ifndef USE_SIZEATTENUATION\r\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\r\n\t\tif ( isPerspective ) computedSize *= - mvPosition.z;\r\n\t#endif\r\n */\n\nvar local_particle_vert =\n/* glsl */\n\"\\n\\n#include <uv_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\n\\nattribute vec3 offset;\\nattribute float rotation;\\nattribute float size;\\nattribute vec4 color;\\nattribute float uvTile;\\n\\nvarying vec4 vColor;\\n\\n#ifdef UV_TILE\\nuniform vec2 tileCount;\\n#endif\\n\\nvoid main() {\\n\\n    #ifdef UV_TILE\\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\\n    #else\\n        #include <uv_vertex>\\n    #endif\\n\\t\\n    vec2 alignedPosition = ( position.xy ) * size;\\n    \\n    vec2 rotatedPosition;\\n    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\\n    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\\n    \\n\\t#ifdef WORLD_SPACE\\n\\t    vec4 mvPosition = viewMatrix * vec4( offset + vec3(rotatedPosition, 0.0), 1.0 );\\n\\t#else\\n\\t    vec4 mvPosition = modelViewMatrix * vec4( offset + vec3(rotatedPosition, 0.0), 1.0 );\\n\\t#endif\\n\\n\\tvColor = color;\\n\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\n}\\n\";\nvar stretched_bb_particle_vert =\n/* glsl */\n\"\\n\\n#include <uv_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\n\\nattribute vec3 offset;\\nattribute float rotation;\\nattribute float size;\\nattribute vec4 color;\\nattribute vec3 velocity;\\nattribute float uvTile;\\n\\nvarying vec4 vColor;\\n\\n#ifdef UV_TILE\\nuniform vec2 tileCount;\\n#endif\\n\\nuniform float speedFactor;\\n\\nvoid main() {\\n\\n    #ifdef UV_TILE\\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\\n    #else\\n        #include <uv_vertex>\\n    #endif\\n\\t\\n\\t#ifdef WORLD_SPACE\\n\\t    vec4 mvPosition = viewMatrix * vec4( offset, 1.0 );\\n        vec3 viewVelocity = vec3(viewMatrix * vec4(velocity, 1.0));\\n\\t#else\\n\\t    vec4 mvPosition = modelViewMatrix * vec4( offset, 1.0 );\\n        vec3 viewVelocity = vec3(modelViewMatrix * vec4(velocity, 1.0));\\n\\t#endif\\n\\n    vec3 scaledPos = vec3(position.xy * size, position.z);\\n    mvPosition.xyz += scaledPos + dot(scaledPos, viewVelocity) * viewVelocity / length(viewVelocity) * speedFactor;\\n\\n\\tvColor = color;\\n\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\n}\\n\";\n/*\r\n\r\n    vec3 instancePos = vec3(position.xy * size, position.z);\r\n    instancePos += dot(instancePos, viewVelocity) * viewVelocity * speedFactor;\r\n    mvPosition.xyz += instancePos;\r\n\r\n\tvColor = color; //vec4(1, 1, 1, 1); //color; //length(viewVelocity) * 0.1\r\n\r\n\t#ifndef USE_SIZEATTENUATION\r\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\r\n\t\tif ( isPerspective ) computedSize *= - mvPosition.z;\r\n\t#endif\r\n */\n\nvar RenderMode;\n\n(function (RenderMode) {\n  RenderMode[RenderMode[\"BillBoard\"] = 0] = \"BillBoard\";\n  RenderMode[RenderMode[\"StretchedBillBoard\"] = 1] = \"StretchedBillBoard\";\n  RenderMode[RenderMode[\"LocalSpaceBillBoard\"] = 2] = \"LocalSpaceBillBoard\";\n})(RenderMode || (RenderMode = {}));\n\nvar ParticleEmitter = /*#__PURE__*/function (_Mesh) {\n  _inherits(ParticleEmitter, _Mesh);\n\n  var _super = _createSuper(ParticleEmitter);\n\n  function ParticleEmitter(system, parameters) {\n    var _this;\n\n    _classCallCheck(this, ParticleEmitter);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"type\", \"ParticleEmitter\");\n\n    _defineProperty(_assertThisInitialized(_this), \"system\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"geometry\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"material\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"interleavedBuffer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"rotationBuffer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"sizeBuffer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"colorBuffer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"offsetBuffer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"velocityBuffer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"tiling\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"uvTileBuffer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"renderMode\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"speedFactor\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"worldSpace\", void 0);\n\n    _this.system = system;\n    _this.geometry = new InstancedBufferGeometry();\n    _this.renderMode = parameters.renderMode || RenderMode.BillBoard;\n    _this.speedFactor = parameters.speedFactor || 1;\n    _this.worldSpace = parameters.worldSpace !== undefined ? parameters.worldSpace : false;\n    var instancingGeometry = new Float32Array(parameters.instancingGeometry || [-0.5, -0.5, 0, 0, 0, 0.5, -0.5, 0, 1, 0, 0.5, 0.5, 0, 1, 1, -0.5, 0.5, 0, 0, 1]);\n    var uniforms = {};\n    var defines = {};\n    _this.interleavedBuffer = new InterleavedBuffer(instancingGeometry, 5);\n\n    _this.geometry.setIndex([0, 1, 2, 0, 2, 3]);\n\n    _this.geometry.setAttribute('position', new InterleavedBufferAttribute(_this.interleavedBuffer, 3, 0, false));\n\n    _this.geometry.setAttribute('uv', new InterleavedBufferAttribute(_this.interleavedBuffer, 2, 3, false));\n\n    _this.offsetBuffer = new InstancedBufferAttribute(new Float32Array(system.maxParticle * 3), 3);\n\n    _this.offsetBuffer.setUsage(DynamicDrawUsage);\n\n    _this.geometry.setAttribute('offset', _this.offsetBuffer);\n\n    _this.colorBuffer = new InstancedBufferAttribute(new Float32Array(system.maxParticle * 4), 4);\n\n    _this.offsetBuffer.setUsage(DynamicDrawUsage);\n\n    _this.geometry.setAttribute('color', _this.colorBuffer);\n\n    _this.rotationBuffer = new InstancedBufferAttribute(new Float32Array(system.maxParticle), 1);\n\n    _this.offsetBuffer.setUsage(DynamicDrawUsage);\n\n    _this.geometry.setAttribute('rotation', _this.rotationBuffer);\n\n    _this.sizeBuffer = new InstancedBufferAttribute(new Float32Array(system.maxParticle), 1);\n\n    _this.offsetBuffer.setUsage(DynamicDrawUsage);\n\n    _this.geometry.setAttribute('size', _this.sizeBuffer);\n\n    _this.tiling = true;\n\n    if (parameters.texture) {\n      defines['USE_MAP'] = '';\n      defines['USE_UV'] = '';\n      uniforms['map'] = new Uniform(parameters.texture); //@ts-ignore\n\n      uniforms['uvTransform'] = new Uniform(new Matrix3().copy(parameters.texture.matrix));\n      var uTileCount = parameters.uTileCount || 1;\n      var vTileCount = parameters.vTileCount || 1; //this.tiling = uTileCount > 1 || vTileCount > 1;\n\n      _this.system.tileCount = uTileCount * vTileCount;\n\n      if (_this.tiling) {\n        _this.uvTileBuffer = new InstancedBufferAttribute(new Float32Array(system.maxParticle), 1);\n\n        _this.uvTileBuffer.setUsage(DynamicDrawUsage);\n\n        _this.geometry.setAttribute('uvTile', _this.uvTileBuffer);\n\n        defines['UV_TILE'] = '';\n        uniforms['tileCount'] = new Uniform(new Vector2(uTileCount, vTileCount));\n      }\n    }\n\n    if (parameters.worldSpace !== undefined ? parameters.worldSpace : true) {\n      defines['WORLD_SPACE'] = '';\n    }\n\n    if (_this.renderMode === RenderMode.BillBoard || _this.renderMode === RenderMode.LocalSpaceBillBoard) {\n      var vertexShader;\n      var side;\n\n      if (_this.renderMode === RenderMode.LocalSpaceBillBoard) {\n        vertexShader = local_particle_vert;\n        side = DoubleSide;\n      } else {\n        vertexShader = particle_vert;\n        side = FrontSide;\n      }\n\n      _this.material = new ShaderMaterial({\n        uniforms: uniforms,\n        defines: defines,\n        vertexShader: vertexShader,\n        fragmentShader: particle_frag,\n        transparent: true,\n        depthWrite: false,\n        blending: parameters.blending || AdditiveBlending,\n        side: side\n      });\n    } else if (_this.renderMode === RenderMode.StretchedBillBoard) {\n      _this.velocityBuffer = new InstancedBufferAttribute(new Float32Array(system.maxParticle * 3), 3);\n\n      _this.velocityBuffer.setUsage(DynamicDrawUsage);\n\n      _this.geometry.setAttribute('velocity', _this.velocityBuffer);\n\n      uniforms['speedFactor'] = new Uniform(parameters.speedFactor);\n      _this.material = new ShaderMaterial({\n        uniforms: uniforms,\n        defines: defines,\n        vertexShader: stretched_bb_particle_vert,\n        fragmentShader: particle_frag,\n        transparent: true,\n        depthWrite: false,\n        blending: parameters.blending || AdditiveBlending\n      });\n    } else {\n      throw new Error(\"render mode unavailable\");\n    } // TODO: implement boundingVolume\n\n\n    _this.frustumCulled = false;\n    return _this;\n  }\n\n  _createClass(ParticleEmitter, [{\n    key: \"clone\",\n    value: function clone() {\n      var system = this.system.clone();\n      return system.emitter;\n    }\n  }, {\n    key: \"update\",\n    value: function update() {\n      var particles = this.system.particles;\n      var particleNum = this.system.particleNum;\n      this.geometry.instanceCount = particleNum;\n\n      for (var i = 0; i < particleNum; i++) {\n        var particle = particles[i];\n        this.offsetBuffer.setXYZ(i, particle.position.x, particle.position.y, particle.position.z);\n        this.colorBuffer.setXYZW(i, particle.color.x, particle.color.y, particle.color.z, particle.color.w);\n        this.rotationBuffer.setX(i, particle.rotation);\n        this.sizeBuffer.setX(i, particle.size);\n\n        if (this.renderMode === RenderMode.StretchedBillBoard) {\n          this.velocityBuffer.setXYZ(i, particle.velocity.x, particle.velocity.y, particle.velocity.z);\n        }\n\n        if (this.tiling) {\n          this.uvTileBuffer.setX(i, particle.uvTile);\n        }\n      }\n\n      if (particleNum > 0) {\n        this.offsetBuffer.updateRange.count = particleNum * 3;\n        this.offsetBuffer.needsUpdate = true;\n        this.colorBuffer.updateRange.count = particleNum * 4;\n        this.colorBuffer.needsUpdate = true;\n        this.rotationBuffer.updateRange.count = particleNum;\n        this.rotationBuffer.needsUpdate = true;\n        this.sizeBuffer.updateRange.count = particleNum;\n        this.sizeBuffer.needsUpdate = true;\n\n        if (this.renderMode === RenderMode.StretchedBillBoard) {\n          this.velocityBuffer.updateRange.count = particleNum * 3;\n          this.velocityBuffer.needsUpdate = true;\n        }\n\n        if (this.tiling) {\n          this.uvTileBuffer.updateRange.count = particleNum;\n          this.uvTileBuffer.needsUpdate = true;\n        }\n      }\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this.geometry.dispose();\n    } // extract data from the cache hash\n    // remove metadata on each item\n    // and return as array\n\n  }, {\n    key: \"extractFromCache\",\n    value: function extractFromCache(cache) {\n      var values = [];\n\n      for (var key in cache) {\n        var data = cache[key];\n        delete data.metadata;\n        values.push(data);\n      }\n\n      return values;\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON(meta) {\n      // meta is a string when called from JSON.stringify\n      var isRootObject = meta === undefined || typeof meta === 'string';\n      var output = {}; // meta is a hash used to collect geometries, materials.\n      // not providing it implies that this is the root object\n      // being serialized.\n\n      if (isRootObject) {\n        // initialize meta obj\n        meta = {\n          geometries: {},\n          materials: {},\n          textures: {},\n          images: {},\n          shapes: {}\n        };\n        output.metadata = {\n          version: 4.5,\n          type: 'Object',\n          generator: 'Object3D.toJSON'\n        };\n      } // standard Object3D serialization\n\n\n      var object = {};\n      object.uuid = this.uuid;\n      object.type = this.type;\n      if (this.name !== '') object.name = this.name;\n      if (this.castShadow === true) object.castShadow = true;\n      if (this.receiveShadow === true) object.receiveShadow = true;\n      if (this.visible === false) object.visible = false;\n      if (this.frustumCulled === false) object.frustumCulled = false;\n      if (this.renderOrder !== 0) object.renderOrder = this.renderOrder;\n      if (JSON.stringify(this.userData) !== '{}') object.userData = this.userData;\n      object.layers = this.layers.mask;\n      object.matrix = this.matrix.toArray();\n      if (this.matrixAutoUpdate === false) object.matrixAutoUpdate = false; // object specific properties\n\n      if (this.system !== null) object.ps = this.system.toJSON(meta);\n\n      if (this.children.length > 0) {\n        object.children = [];\n\n        for (var i = 0; i < this.children.length; i++) {\n          object.children.push(this.children[i].toJSON(meta).object);\n        }\n      }\n\n      if (isRootObject) {\n        var geometries = this.extractFromCache(meta.geometries);\n        var materials = this.extractFromCache(meta.materials);\n        var textures = this.extractFromCache(meta.textures);\n        var images = this.extractFromCache(meta.images);\n        if (geometries.length > 0) output.geometries = geometries;\n        if (materials.length > 0) output.materials = materials;\n        if (textures.length > 0) output.textures = textures;\n        if (images.length > 0) output.images = images;\n      }\n\n      output.object = object;\n      return output;\n    }\n  }]);\n\n  return ParticleEmitter;\n}(Mesh);\n\nvar Particle = function Particle() {\n  _classCallCheck(this, Particle);\n\n  _defineProperty(this, \"startSpeed\", 0);\n\n  _defineProperty(this, \"startColor\", new Vector4());\n\n  _defineProperty(this, \"startSize\", 1);\n\n  _defineProperty(this, \"velocity\", new Vector3());\n\n  _defineProperty(this, \"age\", 0);\n\n  _defineProperty(this, \"life\", 1);\n\n  _defineProperty(this, \"angularVelocity\", void 0);\n\n  _defineProperty(this, \"position\", new Vector3());\n\n  _defineProperty(this, \"rotation\", 0);\n\n  _defineProperty(this, \"size\", 1);\n\n  _defineProperty(this, \"color\", new Vector4());\n\n  _defineProperty(this, \"uvTile\", 0);\n};\n\nvar ConstantValue = /*#__PURE__*/function () {\n  function ConstantValue(value) {\n    _classCallCheck(this, ConstantValue);\n\n    this.value = value;\n\n    _defineProperty(this, \"type\", void 0);\n\n    this.type = 'value';\n  }\n\n  _createClass(ConstantValue, [{\n    key: \"genValue\",\n    value: function genValue() {\n      return this.value;\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: \"ConstantValue\",\n        value: this.value\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new ConstantValue(this.value);\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      return new ConstantValue(json.value);\n    }\n  }]);\n\n  return ConstantValue;\n}();\n\nvar IntervalValue = /*#__PURE__*/function () {\n  function IntervalValue(a, b) {\n    _classCallCheck(this, IntervalValue);\n\n    this.a = a;\n    this.b = b;\n\n    _defineProperty(this, \"type\", void 0);\n\n    this.type = \"value\";\n  }\n\n  _createClass(IntervalValue, [{\n    key: \"genValue\",\n    value: function genValue() {\n      return MathUtils.lerp(this.a, this.b, Math.random());\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: \"IntervalValue\",\n        a: this.a,\n        b: this.b\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new IntervalValue(this.a, this.b);\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      return new IntervalValue(json.a, json.b);\n    }\n  }]);\n\n  return IntervalValue;\n}();\n\nvar PiecewiseFunction = /*#__PURE__*/function () {\n  function PiecewiseFunction() {\n    _classCallCheck(this, PiecewiseFunction);\n\n    _defineProperty(this, \"functions\", void 0);\n\n    this.functions = new Array();\n  }\n\n  _createClass(PiecewiseFunction, [{\n    key: \"findFunction\",\n    value: function findFunction(t) {\n      var mid = 0;\n      var left = 0,\n          right = this.functions.length - 1;\n\n      while (left + 1 < right) {\n        mid = (left + right) / 2;\n        if (t < this.getStartX(mid)) right = mid - 1;else if (t > this.getEndX(mid)) left = mid + 1;else return mid;\n      }\n\n      for (var i = left; i <= right; i++) {\n        if (t >= this.functions[i][1] && t <= this.getEndX(i)) return i;\n      }\n\n      return -1;\n    }\n  }, {\n    key: \"getStartX\",\n    value: function getStartX(index) {\n      return this.functions[index][1];\n    }\n  }, {\n    key: \"setStartX\",\n    value: function setStartX(index, x) {\n      if (index > 0) this.functions[index][1] = x;\n    }\n  }, {\n    key: \"getEndX\",\n    value: function getEndX(index) {\n      if (index + 1 < this.functions.length) return this.functions[index + 1][1];\n      return 1;\n    }\n  }, {\n    key: \"setEndX\",\n    value: function setEndX(index, x) {\n      if (index + 1 < this.functions.length) this.functions[index + 1][1] = x;\n    }\n  }, {\n    key: \"getFunction\",\n    value: function getFunction(index) {\n      return this.functions[index][0];\n    }\n  }, {\n    key: \"setFunction\",\n    value: function setFunction(index, func) {\n      this.functions[index][0] = func;\n    }\n  }, {\n    key: \"numOfFunctions\",\n    get: function get() {\n      return this.functions.length;\n    }\n  }]);\n\n  return PiecewiseFunction;\n}();\n\nvar Bezier = /*#__PURE__*/function () {\n  function Bezier(p1, p2, p3, p4) {\n    _classCallCheck(this, Bezier);\n\n    _defineProperty(this, \"p\", void 0);\n\n    this.p = [p1, p2, p3, p4];\n  }\n\n  _createClass(Bezier, [{\n    key: \"genValue\",\n    value: function genValue(t) {\n      var t2 = t * t;\n      var t3 = t * t * t;\n      var mt = 1 - t;\n      var mt2 = mt * mt;\n      var mt3 = mt2 * mt;\n      return this.p[0] * mt3 + this.p[1] * mt2 * t * 3 + this.p[2] * mt * t2 * 3 + this.p[3] * t3;\n    } // get the coefficients of the polynomial's derivatives\n\n  }, {\n    key: \"derivativeCoefficients\",\n    value: function derivativeCoefficients(points) {\n      var dpoints = [];\n\n      for (var p = points, c = p.length - 1; c > 0; c--) {\n        var list = [];\n\n        for (var j = 0; j < c; j++) {\n          var dpt = c * (p[j + 1] - p[j]);\n          list.push(dpt);\n        }\n\n        dpoints.push(list);\n        p = list;\n      }\n\n      return dpoints;\n    } // calculate the slope\n\n  }, {\n    key: \"getSlope\",\n    value: function getSlope(t) {\n      var p = this.derivativeCoefficients(this.p)[0];\n      var mt = 1 - t;\n      var a = mt * mt;\n      var b = mt * t * 2;\n      var c = t * t;\n      return a * p[0] + b * p[1] + c * p[2]; //return  a * (p[1] - p[0]) * 3 + b * (p[2] - p[1]) * 3 + c * (p[3] - p[2]) * 3;\n    } // derivative(0) = (p[1] - p[0]) * 3\n    // derivative(1) = (p[3] - p[2]) * 3\n\n  }, {\n    key: \"controlCurve\",\n    value: function controlCurve(d0, d1) {\n      this.p[1] = d0 / 3 + this.p[0];\n      this.p[2] = this.p[3] - d1 / 3;\n    }\n  }, {\n    key: \"hull\",\n    value: function hull(t) {\n      var p = this.p;\n      var _p = [],\n          pt,\n          q = [],\n          idx = 0,\n          i = 0,\n          l = 0;\n      q[idx++] = p[0];\n      q[idx++] = p[1];\n      q[idx++] = p[2];\n      q[idx++] = p[3]; // we lerp between all points at each iteration, until we have 1 point left.\n\n      while (p.length > 1) {\n        _p = [];\n\n        for (i = 0, l = p.length - 1; i < l; i++) {\n          pt = t * p[i] + (1 - t) * p[i + 1];\n          q[idx++] = pt;\n\n          _p.push(pt);\n        }\n\n        p = _p;\n      }\n\n      return q;\n    }\n  }, {\n    key: \"split\",\n    value: function split(t) {\n      // no shortcut: use \"de Casteljau\" iteration.\n      var q = this.hull(t);\n      var result = {\n        left: new Bezier(q[0], q[4], q[7], q[9]),\n        right: new Bezier(q[9], q[8], q[6], q[3]),\n        span: q\n      };\n      return result;\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new Bezier(this.p[0], this.p[1], this.p[2], this.p[3]);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        p0: this.p[0],\n        p1: this.p[1],\n        p2: this.p[2],\n        p3: this.p[3]\n      };\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      return new Bezier(json.p0, json.p1, json.p2, json.p3);\n    }\n  }]);\n\n  return Bezier;\n}();\n\nvar PiecewiseBezier = /*#__PURE__*/function (_PiecewiseFunction) {\n  _inherits(PiecewiseBezier, _PiecewiseFunction);\n\n  var _super2 = _createSuper(PiecewiseBezier);\n\n  // default linear bezier\n  function PiecewiseBezier() {\n    var _this2;\n\n    var curves = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [[new Bezier(0, 1.0 / 3, 1.0 / 3 * 2, 1), 0]];\n\n    _classCallCheck(this, PiecewiseBezier);\n\n    _this2 = _super2.call(this);\n\n    _defineProperty(_assertThisInitialized(_this2), \"type\", void 0);\n\n    _this2.type = \"function\";\n    _this2.functions = curves;\n    return _this2;\n  }\n\n  _createClass(PiecewiseBezier, [{\n    key: \"genValue\",\n    value: function genValue() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var index = this.findFunction(t);\n\n      if (index === -1) {\n        console.error(t);\n        return 0;\n      }\n\n      return this.functions[index][0].genValue((t - this.getStartX(index)) / (this.getEndX(index) - this.getStartX(index)));\n    }\n  }, {\n    key: \"toSVG\",\n    value: function toSVG(length, segments) {\n      if (segments < 1) return \"\";\n      var result = [\"M\", 0, this.functions[0][0].p[0]].join(\" \");\n\n      for (var i = 1.0 / segments; i <= 1; i += 1.0 / segments) {\n        result = [result, \"L\", i * length, this.genValue(i)].join(\" \");\n      }\n\n      return result;\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: \"PiecewiseBezier\",\n        functions: this.functions.map(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 2),\n              bezier = _ref2[0],\n              start = _ref2[1];\n\n          return {\n            function: bezier.toJSON(),\n            start: start\n          };\n        })\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new PiecewiseBezier(this.functions.map(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            bezier = _ref4[0],\n            start = _ref4[1];\n\n        return [bezier.clone(), start];\n      }));\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      return new PiecewiseBezier(json.functions.map(function (piecewiseFunction) {\n        return [Bezier.fromJSON(piecewiseFunction.function), piecewiseFunction.start];\n      }));\n    }\n  }]);\n\n  return PiecewiseBezier;\n}(PiecewiseFunction);\n\nfunction ValueGeneratorFromJSON(json) {\n  switch (json.type) {\n    case 'ConstantValue':\n      return ConstantValue.fromJSON(json);\n\n    case 'IntervalValue':\n      return IntervalValue.fromJSON(json);\n\n    case 'PiecewiseBezier':\n      return PiecewiseBezier.fromJSON(json);\n\n    default:\n      return new ConstantValue(0);\n  }\n}\n\nvar ColorToJSON = function ColorToJSON(color) {\n  return {\n    r: color.x,\n    g: color.y,\n    b: color.z,\n    a: color.w\n  };\n};\n\nvar JSONToColor = function JSONToColor(json) {\n  return new Vector4(json.r, json.g, json.b, json.a);\n};\n\nvar RandomColor = /*#__PURE__*/function () {\n  function RandomColor(a, b) {\n    _classCallCheck(this, RandomColor);\n\n    this.a = a;\n    this.b = b;\n\n    _defineProperty(this, \"type\", void 0);\n\n    this.type = \"value\";\n  }\n\n  _createClass(RandomColor, [{\n    key: \"genColor\",\n    value: function genColor(color) {\n      var rand = Math.random();\n      return color.copy(this.a).lerp(this.b, rand);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: \"RandomColor\",\n        a: ColorToJSON(this.a),\n        b: ColorToJSON(this.b)\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new RandomColor(this.a.clone(), this.b.clone());\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      return new RandomColor(JSONToColor(json.a), JSONToColor(json.b));\n    }\n  }]);\n\n  return RandomColor;\n}();\n\nvar ColorRange = /*#__PURE__*/function () {\n  function ColorRange(a, b) {\n    _classCallCheck(this, ColorRange);\n\n    this.a = a;\n    this.b = b;\n\n    _defineProperty(this, \"type\", void 0);\n\n    this.type = \"function\";\n  }\n\n  _createClass(ColorRange, [{\n    key: \"genColor\",\n    value: function genColor(color, t) {\n      return color.copy(this.a).lerp(this.b, t);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: \"ColorRange\",\n        a: ColorToJSON(this.a),\n        b: ColorToJSON(this.b)\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new ColorRange(this.a.clone(), this.b.clone());\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      return new ColorRange(JSONToColor(json.a), JSONToColor(json.b));\n    }\n  }]);\n\n  return ColorRange;\n}();\n\nvar ConstantColor = /*#__PURE__*/function () {\n  function ConstantColor(color) {\n    _classCallCheck(this, ConstantColor);\n\n    this.color = color;\n\n    _defineProperty(this, \"type\", void 0);\n\n    this.type = 'value';\n  }\n\n  _createClass(ConstantColor, [{\n    key: \"genColor\",\n    value: function genColor(color) {\n      return color.copy(this.color);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: \"ConstantColor\",\n        color: ColorToJSON(this.color)\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new ConstantColor(this.color.clone());\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      return new ConstantColor(JSONToColor(json.color));\n    }\n  }]);\n\n  return ConstantColor;\n}();\n\nfunction ColorGeneratorFromJSON(json) {\n  switch (json.type) {\n    case 'ConstantColor':\n      return ConstantColor.fromJSON(json);\n\n    case 'ColorRange':\n      return ColorRange.fromJSON(json);\n\n    case 'RandomColor':\n      return RandomColor.fromJSON(json);\n\n    default:\n      return new ConstantColor(new Vector4(1, 1, 1, 1));\n  }\n}\n\nvar ColorOverLife = /*#__PURE__*/function () {\n  function ColorOverLife(func) {\n    _classCallCheck(this, ColorOverLife);\n\n    this.func = func;\n\n    _defineProperty(this, \"type\", 'ColorOverLife');\n  }\n\n  _createClass(ColorOverLife, [{\n    key: \"initialize\",\n    value: function initialize(particle) {}\n  }, {\n    key: \"update\",\n    value: function update(particle, delta) {\n      this.func.genColor(particle.color, particle.age / particle.life).dot(particle.startColor);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: this.type,\n        func: this.func.toJSON()\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new ColorOverLife(this.func.clone());\n    }\n  }]);\n\n  return ColorOverLife;\n}();\n\nvar RotationOverLife = /*#__PURE__*/function () {\n  function RotationOverLife(angularVelocityFunc) {\n    _classCallCheck(this, RotationOverLife);\n\n    this.angularVelocityFunc = angularVelocityFunc;\n\n    _defineProperty(this, \"type\", 'RotationOverLife');\n  }\n\n  _createClass(RotationOverLife, [{\n    key: \"initialize\",\n    value: function initialize(particle) {\n      if (this.angularVelocityFunc.type === 'value') {\n        particle.angularVelocity = this.angularVelocityFunc.genValue();\n      } else {\n        particle.angularVelocity = 0;\n      }\n    }\n  }, {\n    key: \"update\",\n    value: function update(particle, delta) {\n      if (this.angularVelocityFunc.type === 'value') {\n        particle.rotation += delta * particle.angularVelocity;\n      } else {\n        particle.rotation += delta * this.angularVelocityFunc.genValue(particle.age / particle.life);\n      }\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: this.type,\n        func: this.angularVelocityFunc.toJSON()\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new RotationOverLife(this.angularVelocityFunc);\n    }\n  }]);\n\n  return RotationOverLife;\n}();\n\nvar SizeOverLife = /*#__PURE__*/function () {\n  _createClass(SizeOverLife, [{\n    key: \"initialize\",\n    value: function initialize(particle) {}\n  }]);\n\n  function SizeOverLife(func) {\n    _classCallCheck(this, SizeOverLife);\n\n    this.func = func;\n\n    _defineProperty(this, \"type\", 'SizeOverLife');\n  }\n\n  _createClass(SizeOverLife, [{\n    key: \"update\",\n    value: function update(particle) {\n      particle.size = particle.startSize * this.func.genValue(particle.age / particle.life);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: this.type,\n        func: this.func.toJSON()\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new SizeOverLife(this.func.clone());\n    }\n  }]);\n\n  return SizeOverLife;\n}();\n\nvar FrameOverLife = /*#__PURE__*/function () {\n  function FrameOverLife(func) {\n    _classCallCheck(this, FrameOverLife);\n\n    this.func = func;\n\n    _defineProperty(this, \"type\", 'FrameOverLife');\n  }\n\n  _createClass(FrameOverLife, [{\n    key: \"initialize\",\n    value: function initialize(particle) {}\n  }, {\n    key: \"update\",\n    value: function update(particle, delta) {\n      particle.uvTile = Math.floor(this.func.genValue(particle.age / particle.life));\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: this.type,\n        func: this.func.toJSON()\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new FrameOverLife(this.func.clone());\n    }\n  }]);\n\n  return FrameOverLife;\n}();\n\nvar V3_ZERO = new Vector3();\n\nvar OrbitOverLife = /*#__PURE__*/function () {\n  function OrbitOverLife(angularVelocityFunc) {\n    _classCallCheck(this, OrbitOverLife);\n\n    this.angularVelocityFunc = angularVelocityFunc;\n\n    _defineProperty(this, \"type\", 'OrbitOverLife');\n  }\n\n  _createClass(OrbitOverLife, [{\n    key: \"initialize\",\n    value: function initialize(particle) {\n      if (this.angularVelocityFunc.type === 'value') {\n        particle.angularVelocity = this.angularVelocityFunc.genValue();\n      } else {\n        particle.angularVelocity = 0;\n      }\n    }\n  }, {\n    key: \"update\",\n    value: function update(particle, delta) {\n      var rotation = Math.atan2(particle.position.y, particle.position.x);\n      var len = Math.sqrt(particle.position.x * particle.position.x + particle.position.y * particle.position.y);\n      rotation += this.angularVelocityFunc.genValue(particle.age / particle.life) * delta;\n      particle.position.x = Math.cos(rotation) * len;\n      particle.position.y = Math.sin(rotation) * len; //let v1x = particle.position.x\n      //let v1y = particle.position.y;\n\n      /*let v2x = particle.position.y;\r\n      let v2y = -particle.position.x;\r\n      v2x /= len;\r\n      v2y /= len;\r\n      particle.position.distanceTo(V3_ZERO) * this.angularVelocityFunc.genValue(particle.age / particle.life);*/\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: this.type,\n        func: this.angularVelocityFunc.toJSON()\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new OrbitOverLife(this.angularVelocityFunc.clone());\n    }\n  }]);\n\n  return OrbitOverLife;\n}();\n\nfunction BehaviorFromJSON(json) {\n  switch (json.type) {\n    case 'ColorOverLife':\n      return new ColorOverLife(ColorGeneratorFromJSON(json.func));\n\n    case 'RotationOverLife':\n      return new RotationOverLife(ValueGeneratorFromJSON(json.func));\n\n    case 'SizeOverLife':\n      return new SizeOverLife(ValueGeneratorFromJSON(json.func));\n\n    case 'FrameOverLife':\n      return new FrameOverLife(ValueGeneratorFromJSON(json.func));\n\n    case 'OrbitOverLife':\n      return new OrbitOverLife(ValueGeneratorFromJSON(json.func));\n\n    default:\n      return new ColorOverLife(new ColorRange(new Vector4(1, 1, 1, 1), new Vector4(1, 1, 1, 1)));\n  }\n}\n\nvar ConeEmitter = /*#__PURE__*/function () {\n  // [0, Math.PI * 2]\n  // [0, Math.PI / 2]\n  function ConeEmitter() {\n    var parameters = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, ConeEmitter);\n\n    _defineProperty(this, \"radius\", void 0);\n\n    _defineProperty(this, \"arc\", void 0);\n\n    _defineProperty(this, \"thickness\", void 0);\n\n    _defineProperty(this, \"angle\", void 0);\n\n    this.radius = parameters.radius || 10;\n    this.arc = parameters.arc || 2.0 * Math.PI;\n    this.thickness = parameters.thickness || 1;\n    this.angle = parameters.angle || Math.PI / 6;\n  }\n\n  _createClass(ConeEmitter, [{\n    key: \"initialize\",\n    value: function initialize(p) {\n      var u = Math.random();\n      var rand = MathUtils.lerp(1 - this.thickness, 1, Math.random());\n      var theta = u * this.arc;\n      var r = Math.sqrt(rand);\n      var sinTheta = Math.sin(theta);\n      var cosTheta = Math.cos(theta);\n      p.position.x = r * cosTheta;\n      p.position.y = r * sinTheta;\n      p.position.z = 0;\n      var angle = this.angle * r;\n      p.velocity.set(0, 0, Math.cos(angle)).addScaledVector(p.position, Math.sin(angle)).multiplyScalar(p.startSpeed); //const v = Math.random();\n\n      p.position.multiplyScalar(this.radius);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: \"cone\",\n        radius: this.radius,\n        arc: this.arc,\n        thickness: this.thickness,\n        angle: this.angle\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new ConeEmitter({\n        radius: this.radius,\n        arc: this.arc,\n        thickness: this.thickness,\n        angle: this.angle\n      });\n    }\n  }]);\n\n  return ConeEmitter;\n}();\n\nvar SphereEmitter = /*#__PURE__*/function () {\n  //[0, 1]\n  function SphereEmitter() {\n    var parameters = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, SphereEmitter);\n\n    _defineProperty(this, \"radius\", void 0);\n\n    _defineProperty(this, \"arc\", void 0);\n\n    _defineProperty(this, \"thickness\", void 0);\n\n    this.radius = parameters.radius || 10;\n    this.arc = parameters.arc || 2.0 * Math.PI;\n    this.thickness = parameters.thickness || 1;\n  }\n\n  _createClass(SphereEmitter, [{\n    key: \"initialize\",\n    value: function initialize(p) {\n      var u = Math.random();\n      var v = Math.random();\n      var rand = MathUtils.lerp(1 - this.thickness, 1, Math.random());\n      var theta = u * this.arc;\n      var phi = Math.acos(2.0 * v - 1.0);\n      var r = Math.cbrt(rand);\n      var sinTheta = Math.sin(theta);\n      var cosTheta = Math.cos(theta);\n      var sinPhi = Math.sin(phi);\n      var cosPhi = Math.cos(phi);\n      p.position.x = r * sinPhi * cosTheta;\n      p.position.y = r * sinPhi * sinTheta;\n      p.position.z = r * cosPhi;\n      p.velocity.setScalar(0).addScaledVector(p.position, p.startSpeed);\n      p.position.multiplyScalar(this.radius);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: \"sphere\",\n        radius: this.radius,\n        arc: this.arc,\n        thickness: this.thickness\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new SphereEmitter({\n        radius: this.radius,\n        arc: this.arc,\n        thickness: this.thickness\n      });\n    }\n  }]);\n\n  return SphereEmitter;\n}();\n\nvar PointEmitter = /*#__PURE__*/function () {\n  function PointEmitter() {\n    _classCallCheck(this, PointEmitter);\n  }\n\n  _createClass(PointEmitter, [{\n    key: \"initialize\",\n    value: function initialize(p) {\n      var u = Math.random();\n      var v = Math.random();\n      var theta = u * Math.PI * 2;\n      var phi = Math.acos(2.0 * v - 1.0);\n      var r = Math.cbrt(Math.random());\n      var sinTheta = Math.sin(theta);\n      var cosTheta = Math.cos(theta);\n      var sinPhi = Math.sin(phi);\n      var cosPhi = Math.cos(phi);\n      p.velocity.x = r * sinPhi * cosTheta;\n      p.velocity.y = r * sinPhi * sinTheta;\n      p.velocity.z = r * cosPhi;\n      p.velocity.multiplyScalar(p.startSpeed);\n      p.position.setScalar(0);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: 'point'\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new PointEmitter();\n    }\n  }]);\n\n  return PointEmitter;\n}();\n\nvar DonutEmitter = /*#__PURE__*/function () {\n  // [0, Math.PI * 2]\n  // [0, Math.PI / 2]\n  function DonutEmitter() {\n    var parameters = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, DonutEmitter);\n\n    _defineProperty(this, \"radius\", void 0);\n\n    _defineProperty(this, \"arc\", void 0);\n\n    _defineProperty(this, \"thickness\", void 0);\n\n    _defineProperty(this, \"angle\", void 0);\n\n    this.radius = parameters.radius || 10;\n    this.arc = parameters.arc || 2.0 * Math.PI;\n    this.thickness = parameters.thickness || 1;\n    this.angle = parameters.angle || Math.PI / 6;\n  }\n\n  _createClass(DonutEmitter, [{\n    key: \"initialize\",\n    value: function initialize(p) {\n      var u = Math.random();\n      var rand = MathUtils.lerp(this.thickness, 1, Math.random());\n      var theta = u * this.arc;\n      var r = Math.sqrt(rand);\n      var sinTheta = Math.sin(theta);\n      var cosTheta = Math.cos(theta);\n      p.position.x = r * cosTheta;\n      p.position.y = r * sinTheta;\n      p.position.z = 0;\n      var angle = this.angle * r;\n      p.velocity.set(0, 0, Math.cos(angle)).addScaledVector(p.position, Math.sin(angle)).multiplyScalar(p.startSpeed); //const v = Math.random();\n\n      p.position.multiplyScalar(this.radius);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: \"donut\",\n        radius: this.radius,\n        arc: this.arc,\n        thickness: this.thickness,\n        angle: this.angle\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new DonutEmitter({\n        radius: this.radius,\n        arc: this.arc,\n        thickness: this.thickness,\n        angle: this.angle\n      });\n    }\n  }]);\n\n  return DonutEmitter;\n}();\n\nvar ParticleSystem = /*#__PURE__*/function () {\n  _createClass(ParticleSystem, [{\n    key: \"texture\",\n    // parameters\n    // runtime data\n    get: function get() {\n      return this.emitter.material.uniforms.map.value;\n    },\n    set: function set(texture) {\n      this.emitter.material.uniforms.map.value = texture;\n    }\n  }, {\n    key: \"uTileCount\",\n    get: function get() {\n      return this.emitter.material.uniforms.tileCount.value.x;\n    },\n    set: function set(u) {\n      this.emitter.material.uniforms.tileCount.value.x = u;\n    }\n  }, {\n    key: \"vTileCount\",\n    get: function get() {\n      return this.emitter.material.uniforms.tileCount.value.y;\n    },\n    set: function set(v) {\n      this.emitter.material.uniforms.tileCount.value.y = v;\n    }\n  }, {\n    key: \"renderMode\",\n    get: function get() {\n      return this.emitter.renderMode;\n    }\n  }, {\n    key: \"speedFactor\",\n    get: function get() {\n      if (this.emitter.material.uniforms.speedFactor) {\n        return this.emitter.material.uniforms.speedFactor.value;\n      } else {\n        return 0;\n      }\n    },\n    set: function set(v) {\n      this.emitter.material.uniforms.speedFactor.value = v;\n    }\n  }, {\n    key: \"blending\",\n    get: function get() {\n      return this.emitter.material.blending;\n    },\n    set: function set(blending) {\n      this.emitter.material.blending = blending;\n    }\n  }]);\n\n  function ParticleSystem() {\n    var parameters = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, ParticleSystem);\n\n    _defineProperty(this, \"autoDestroy\", void 0);\n\n    _defineProperty(this, \"looping\", void 0);\n\n    _defineProperty(this, \"duration\", void 0);\n\n    _defineProperty(this, \"maxParticle\", void 0);\n\n    _defineProperty(this, \"startLife\", void 0);\n\n    _defineProperty(this, \"startSpeed\", void 0);\n\n    _defineProperty(this, \"startRotation\", void 0);\n\n    _defineProperty(this, \"startSize\", void 0);\n\n    _defineProperty(this, \"startColor\", void 0);\n\n    _defineProperty(this, \"startTileIndex\", void 0);\n\n    _defineProperty(this, \"emissionOverTime\", void 0);\n\n    _defineProperty(this, \"emissionOverDistance\", void 0);\n\n    _defineProperty(this, \"emissionBursts\", void 0);\n\n    _defineProperty(this, \"tileCount\", 1);\n\n    _defineProperty(this, \"worldSpace\", void 0);\n\n    _defineProperty(this, \"particleNum\", void 0);\n\n    _defineProperty(this, \"burstIndex\", void 0);\n\n    _defineProperty(this, \"burstWaveIndex\", void 0);\n\n    _defineProperty(this, \"time\", void 0);\n\n    _defineProperty(this, \"paused\", void 0);\n\n    _defineProperty(this, \"waitEmiting\", void 0);\n\n    _defineProperty(this, \"emitEnded\", void 0);\n\n    _defineProperty(this, \"markForDestroy\", void 0);\n\n    _defineProperty(this, \"behaviors\", void 0);\n\n    _defineProperty(this, \"particles\", void 0);\n\n    _defineProperty(this, \"emitterShape\", void 0);\n\n    _defineProperty(this, \"emitter\", void 0);\n\n    _defineProperty(this, \"normalMatrix\", new Matrix3());\n\n    this.autoDestroy = parameters.autoDestroy === undefined ? false : parameters.autoDestroy;\n    this.duration = parameters.duration || 1;\n    this.maxParticle = parameters.maxParticle || 100;\n    this.looping = parameters.looping === undefined ? true : parameters.looping;\n    this.startLife = parameters.startLife || new ConstantValue(5);\n    this.startSpeed = parameters.startSpeed || new ConstantValue(0);\n    this.startRotation = parameters.startRotation || new ConstantValue(0);\n    this.startSize = parameters.startSize || new ConstantValue(1);\n    this.startColor = parameters.startColor || new ConstantColor(new Vector4(1, 1, 1, 1));\n    this.emissionOverTime = parameters.emissionOverTime || new ConstantValue(10);\n    this.emissionOverDistance = parameters.emissionOverDistance || new ConstantValue(0);\n    this.emissionBursts = parameters.emissionBursts || [];\n    this.emitterShape = parameters.shape || new SphereEmitter();\n    this.behaviors = parameters.behaviors || new Array();\n    this.worldSpace = parameters.worldSpace === undefined ? false : parameters.worldSpace;\n    this.particles = new Array();\n    this.startTileIndex = parameters.startTileIndex || 0;\n    this.emitter = new ParticleEmitter(this, parameters);\n    this.particleNum = 0;\n    this.burstIndex = 0;\n    this.burstWaveIndex = 0;\n    this.time = 0;\n    this.paused = false;\n    this.waitEmiting = 0;\n    this.emitEnded = false;\n    this.markForDestroy = false;\n  }\n\n  _createClass(ParticleSystem, [{\n    key: \"pause\",\n    value: function pause() {\n      this.paused = true;\n    }\n  }, {\n    key: \"play\",\n    value: function play() {\n      this.paused = false;\n    }\n  }, {\n    key: \"spawn\",\n    value: function spawn() {\n      while (this.particleNum >= this.particles.length) {\n        this.particles.push(new Particle());\n      }\n\n      this.particleNum++;\n      var particle = this.particles[this.particleNum - 1];\n      this.startColor.genColor(particle.startColor, this.time);\n      particle.color.copy(particle.startColor);\n      particle.startSpeed = this.startSpeed.genValue(this.time);\n      particle.life = this.startLife.genValue(this.time);\n      particle.age = 0;\n      particle.rotation = this.startRotation.genValue(this.time);\n      particle.startSize = particle.size = this.startSize.genValue(this.time);\n      particle.uvTile = this.startTileIndex;\n      this.emitterShape.initialize(particle);\n\n      if (this.worldSpace) {\n        particle.position.applyMatrix4(this.emitter.matrixWorld);\n        particle.velocity.applyMatrix3(this.normalMatrix);\n      }\n\n      for (var j = 0; j < this.behaviors.length; j++) {\n        this.behaviors[j].initialize(particle);\n      }\n    }\n  }, {\n    key: \"endEmit\",\n    value: function endEmit() {\n      this.emitEnded = true;\n\n      if (this.autoDestroy) {\n        this.markForDestroy = true;\n      }\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this.emitter.dispose();\n      if (this.emitter.parent) this.emitter.parent.remove(this.emitter);\n    }\n  }, {\n    key: \"restart\",\n    value: function restart() {\n      this.paused = false;\n      this.particleNum = 0;\n      this.burstIndex = 0;\n      this.burstWaveIndex = 0;\n      this.time = 0;\n      this.waitEmiting = 0;\n      this.emitEnded = false;\n      this.markForDestroy = false;\n    }\n  }, {\n    key: \"update\",\n    value: function update(delta) {\n      if (delta > 0.1) delta = 0.1;\n      if (this.paused) return;\n\n      if (this.emitEnded && this.particleNum === 0) {\n        if (this.markForDestroy && this.emitter.parent) this.dispose();\n        return;\n      }\n\n      if (this.time > this.duration) {\n        if (this.looping) {\n          this.time -= this.duration;\n        } else {\n          if (!this.emitEnded) {\n            this.endEmit();\n          }\n        }\n      }\n\n      this.normalMatrix.getNormalMatrix(this.emitter.matrixWorld); // particle die\n\n      for (var i = 0; i < this.particleNum; i++) {\n        var particle = this.particles[i];\n\n        if (particle.age >= particle.life) {\n          this.particles[i] = this.particles[this.particleNum - 1];\n          this.particles[this.particleNum - 1] = particle;\n          this.particleNum--;\n          i--;\n        }\n      } // spawn\n\n\n      while (this.waitEmiting > 0 && this.particleNum < this.maxParticle && !this.emitEnded) {\n        this.spawn();\n        this.waitEmiting--;\n      } // spawn burst\n\n\n      while (this.burstIndex < this.emissionBursts.length && this.emissionBursts[this.burstIndex].time <= this.time) {\n        if (Math.random() < this.emissionBursts[this.burstIndex].probability) {\n          var count = this.emissionBursts[this.burstIndex].count;\n\n          while (count > 0 && this.particleNum < this.maxParticle) {\n            this.spawn();\n            count--;\n          }\n        }\n\n        this.burstIndex++;\n      }\n\n      for (var _i = 0; _i < this.particleNum; _i++) {\n        var _particle = this.particles[_i];\n\n        for (var j = 0; j < this.behaviors.length; j++) {\n          this.behaviors[j].update(_particle, delta);\n        }\n\n        _particle.position.addScaledVector(_particle.velocity, delta);\n\n        _particle.age += delta;\n      }\n\n      this.emitter.update();\n\n      if (!this.emitEnded) {\n        this.waitEmiting += delta * this.emissionOverTime.genValue(this.time);\n      }\n\n      this.time += delta;\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON(meta) {\n      this.texture.toJSON(meta);\n\n      if (this.texture.image !== undefined) {\n        var image = this.texture.image;\n        meta.images[image.uuid] = {\n          uuid: image.uuid,\n          url: this.texture.name\n        };\n      }\n\n      return {\n        autoDestroy: this.autoDestroy,\n        looping: this.looping,\n        duration: this.duration,\n        maxParticle: this.maxParticle,\n        shape: this.emitterShape.toJSON(),\n        startLife: this.startLife.toJSON(),\n        startSpeed: this.startSpeed.toJSON(),\n        startRotation: this.startRotation.toJSON(),\n        startSize: this.startSize.toJSON(),\n        startColor: this.startColor.toJSON(),\n        emissionOverTime: this.emissionOverTime.toJSON(),\n        emissionOverDistance: this.emissionOverDistance.toJSON(),\n        emissionBursts: this.emissionBursts,\n        instancingGeometry: Array.from(this.emitter.interleavedBuffer.array),\n        renderMode: this.renderMode,\n        speedFactor: this.renderMode === RenderMode.StretchedBillBoard ? this.speedFactor : 0,\n        texture: this.texture.uuid,\n        startTileIndex: this.startTileIndex,\n        uTileCount: this.uTileCount,\n        vTileCount: this.vTileCount,\n        blending: this.blending,\n        behaviors: this.behaviors.map(function (behavior) {\n          return behavior.toJSON();\n        }),\n        worldSpace: this.worldSpace\n      };\n    }\n  }, {\n    key: \"addBehavior\",\n    value: function addBehavior(behavior) {\n      this.behaviors.push(behavior);\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      var newEmissionBursts = [];\n\n      var _iterator = _createForOfIteratorHelper(this.emissionBursts),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var emissionBurst = _step.value;\n          var newEmissionBurst = {};\n          Object.assign(newEmissionBurst, emissionBurst);\n          newEmissionBursts.push(newEmissionBurst);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      var newBehaviors = [];\n\n      var _iterator2 = _createForOfIteratorHelper(this.behaviors),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var behavior = _step2.value;\n          newBehaviors.push(behavior.clone());\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      return new ParticleSystem({\n        autoDestroy: this.autoDestroy,\n        looping: this.looping,\n        duration: this.duration,\n        maxParticle: this.maxParticle,\n        shape: this.emitterShape.clone(),\n        startLife: this.startLife.clone(),\n        startSpeed: this.startSpeed.clone(),\n        startRotation: this.startRotation.clone(),\n        startSize: this.startSize.clone(),\n        startColor: this.startColor.clone(),\n        emissionOverTime: this.emissionOverTime.clone(),\n        emissionOverDistance: this.emissionOverDistance.clone(),\n        emissionBursts: newEmissionBursts,\n        instancingGeometry: this.emitter.interleavedBuffer.array,\n        renderMode: this.renderMode,\n        speedFactor: this.speedFactor,\n        texture: this.texture,\n        startTileIndex: this.startTileIndex,\n        uTileCount: this.uTileCount,\n        vTileCount: this.vTileCount,\n        blending: this.blending,\n        behaviors: newBehaviors,\n        worldSpace: this.worldSpace\n      });\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json, textures) {\n      var shape;\n\n      switch (json.shape.type) {\n        case 'cone':\n          shape = new ConeEmitter(json.shape);\n          break;\n\n        case 'donut':\n          shape = new DonutEmitter(json.shape);\n          break;\n\n        case 'point':\n          shape = new PointEmitter();\n          break;\n\n        case 'sphere':\n          shape = new SphereEmitter(json.shape);\n          break;\n\n        default:\n          shape = new PointEmitter();\n          break;\n      }\n\n      return new ParticleSystem({\n        autoDestroy: json.autoDestroy,\n        looping: json.looping,\n        duration: json.duration,\n        maxParticle: json.maxParticle,\n        shape: shape,\n        startLife: ValueGeneratorFromJSON(json.startLife),\n        startSpeed: ValueGeneratorFromJSON(json.startSpeed),\n        startRotation: ValueGeneratorFromJSON(json.startRotation),\n        startSize: ValueGeneratorFromJSON(json.startSize),\n        startColor: ColorGeneratorFromJSON(json.startColor),\n        emissionOverTime: ValueGeneratorFromJSON(json.emissionOverTime),\n        emissionOverDistance: ValueGeneratorFromJSON(json.emissionOverDistance),\n        emissionBursts: json.emissionBursts,\n        instancingGeometry: json.instancingGeometry,\n        renderMode: json.renderMode,\n        speedFactor: json.speedFactor,\n        texture: textures[json.texture],\n        startTileIndex: json.startTileIndex,\n        uTileCount: json.uTileCount,\n        vTileCount: json.vTileCount,\n        blending: json.blending,\n        behaviors: json.behaviors.map(function (behavior) {\n          return BehaviorFromJSON(behavior);\n        }),\n        worldSpace: json.worldSpace\n      });\n    }\n  }]);\n\n  return ParticleSystem;\n}();\n\nvar TEXTURE_MAPPING = {\n  UVMapping: UVMapping,\n  CubeReflectionMapping: CubeReflectionMapping,\n  CubeRefractionMapping: CubeRefractionMapping,\n  EquirectangularReflectionMapping: EquirectangularReflectionMapping,\n  EquirectangularRefractionMapping: EquirectangularRefractionMapping,\n  //SphericalReflectionMapping: SphericalReflectionMapping,\n  CubeUVReflectionMapping: CubeUVReflectionMapping,\n  CubeUVRefractionMapping: CubeUVRefractionMapping\n};\nvar TEXTURE_WRAPPING = {\n  RepeatWrapping: RepeatWrapping,\n  ClampToEdgeWrapping: ClampToEdgeWrapping,\n  MirroredRepeatWrapping: MirroredRepeatWrapping\n};\nvar TEXTURE_FILTER = {\n  NearestFilter: NearestFilter,\n  NearestMipmapNearestFilter: NearestMipMapNearestFilter,\n  NearestMipmapLinearFilter: NearestMipMapLinearFilter,\n  LinearFilter: LinearFilter,\n  LinearMipmapNearestFilter: LinearMipMapNearestFilter,\n  LinearMipmapLinearFilter: LinearMipMapLinearFilter\n};\n\nvar QuarksLoader = /*#__PURE__*/function () {\n  function QuarksLoader(manager) {\n    _classCallCheck(this, QuarksLoader);\n\n    _defineProperty(this, \"manager\", void 0);\n\n    _defineProperty(this, \"crossOrigin\", \"anonymous\");\n\n    _defineProperty(this, \"path\", void 0);\n\n    _defineProperty(this, \"resourcePath\", void 0);\n\n    this.manager = manager !== undefined ? manager : DefaultLoadingManager;\n    this.resourcePath = '';\n  }\n\n  _createClass(QuarksLoader, [{\n    key: \"setPath\",\n    value: function setPath(value) {\n      this.path = value;\n      return this;\n    }\n  }, {\n    key: \"setResourcePath\",\n    value: function setResourcePath(value) {\n      this.resourcePath = value;\n      return this;\n    }\n  }, {\n    key: \"setCrossOrigin\",\n    value: function setCrossOrigin(value) {\n      this.crossOrigin = value;\n      return this;\n    }\n  }, {\n    key: \"load\",\n    value: function load(url, onLoad, onProgress, onError) {\n      var scope = this;\n      var path = this.path === undefined ? LoaderUtils.extractUrlBase(url) : this.path;\n      this.resourcePath = this.resourcePath || path;\n      var loader = new FileLoader(scope.manager);\n      if (this.path) loader.setPath(this.path);\n      loader.load(url, function (text) {\n        var json = null;\n\n        try {\n          json = JSON.parse(text);\n        } catch (error) {\n          if (onError !== undefined) onError(error);\n          console.error('THREE:ObjectLoader: Can\\'t parse ' + url + '.', error.message);\n          return;\n        }\n\n        var metadata = json.metadata;\n\n        if (metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry') {\n          console.error('THREE.ObjectLoader: Can\\'t load ' + url);\n          return;\n        }\n\n        scope.parse(json, onLoad);\n      }, onProgress, onError);\n    }\n  }, {\n    key: \"loadImage\",\n    value: function loadImage(loader, url) {\n      var scope = this;\n      scope.manager.itemStart(url);\n      return loader.load(url, function () {\n        scope.manager.itemEnd(url);\n      }, undefined, function () {\n        scope.manager.itemError(url);\n        scope.manager.itemEnd(url);\n      });\n    }\n  }, {\n    key: \"parseImages\",\n    value: function parseImages(json, onLoad) {\n      var scope = this;\n      var images = {};\n\n      if (json !== undefined && json.length > 0) {\n        var manager = new LoadingManager(onLoad);\n        var loader = new ImageLoader(manager);\n        loader.setCrossOrigin(this.crossOrigin);\n\n        for (var i = 0, il = json.length; i < il; i++) {\n          var image = json[i];\n          var url = image.url;\n\n          if (Array.isArray(url)) {\n            // load array of images e.g CubeTexture\n            images[image.uuid] = [];\n\n            for (var j = 0, jl = url.length; j < jl; j++) {\n              var currentUrl = url[j];\n              var path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test(currentUrl) ? currentUrl : scope.resourcePath + currentUrl;\n              images[image.uuid].push(this.loadImage(loader, path));\n            }\n          } else {\n            // load single image\n            var path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test(image.url) ? image.url : scope.resourcePath + image.url;\n            images[image.uuid] = this.loadImage(loader, path);\n          }\n        }\n      }\n\n      return images;\n    }\n  }, {\n    key: \"parseTextures\",\n    value: function parseTextures(json, images) {\n      function parseConstant(value, type) {\n        if (typeof value === 'number') return value;\n        console.warn('THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value);\n        return type[value];\n      }\n\n      var textures = {};\n\n      if (json !== undefined) {\n        for (var i = 0, l = json.length; i < l; i++) {\n          var data = json[i];\n\n          if (data.image === undefined) {\n            console.warn('THREE.ObjectLoader: No \"image\" specified for', data.uuid);\n          }\n\n          if (images[data.image] === undefined) {\n            console.warn('THREE.ObjectLoader: Undefined image', data.image);\n          }\n\n          var texture;\n\n          if (Array.isArray(images[data.image])) {\n            texture = new CubeTexture(images[data.image]);\n          } else {\n            texture = new Texture(images[data.image]);\n          }\n\n          texture.needsUpdate = true;\n          texture.uuid = data.uuid;\n          if (data.name !== undefined) texture.name = data.name;\n          if (data.mapping !== undefined) texture.mapping = parseConstant(data.mapping, TEXTURE_MAPPING);\n          if (data.offset !== undefined) texture.offset.fromArray(data.offset);\n          if (data.repeat !== undefined) texture.repeat.fromArray(data.repeat);\n          if (data.center !== undefined) texture.center.fromArray(data.center);\n          if (data.rotation !== undefined) texture.rotation = data.rotation;\n\n          if (data.wrap !== undefined) {\n            texture.wrapS = parseConstant(data.wrap[0], TEXTURE_WRAPPING);\n            texture.wrapT = parseConstant(data.wrap[1], TEXTURE_WRAPPING);\n          }\n\n          if (data.format !== undefined) texture.format = data.format;\n          if (data.type !== undefined) texture.type = data.type;\n          if (data.encoding !== undefined) texture.encoding = data.encoding;\n          if (data.minFilter !== undefined) texture.minFilter = parseConstant(data.minFilter, TEXTURE_FILTER);\n          if (data.magFilter !== undefined) texture.magFilter = parseConstant(data.magFilter, TEXTURE_FILTER);\n          if (data.anisotropy !== undefined) texture.anisotropy = data.anisotropy;\n          if (data.flipY !== undefined) texture.flipY = data.flipY;\n          if (data.premultiplyAlpha !== undefined) texture.premultiplyAlpha = data.premultiplyAlpha;\n          if (data.unpackAlignment !== undefined) texture.unpackAlignment = data.unpackAlignment;\n          textures[data.uuid] = texture;\n        }\n      }\n\n      return textures;\n    }\n  }, {\n    key: \"parseObject\",\n    value: function parseObject(data, textures) {\n      var object;\n\n      switch (data.type) {\n        case 'ParticleEmitter':\n          object = ParticleSystem.fromJSON(data.ps, textures).emitter;\n          break;\n\n        case 'Group':\n          object = new Group();\n          break;\n\n        default:\n          object = new Object3D();\n      }\n\n      object.uuid = data.uuid;\n      if (data.name !== undefined) object.name = data.name;\n\n      if (data.matrix !== undefined) {\n        object.matrix.fromArray(data.matrix);\n        if (data.matrixAutoUpdate !== undefined) object.matrixAutoUpdate = data.matrixAutoUpdate;\n        if (object.matrixAutoUpdate) object.matrix.decompose(object.position, object.quaternion, object.scale);\n      } else {\n        if (data.position !== undefined) object.position.fromArray(data.position);\n        if (data.rotation !== undefined) object.rotation.fromArray(data.rotation);\n        if (data.quaternion !== undefined) object.quaternion.fromArray(data.quaternion);\n        if (data.scale !== undefined) object.scale.fromArray(data.scale);\n      }\n\n      if (data.castShadow !== undefined) object.castShadow = data.castShadow;\n      if (data.receiveShadow !== undefined) object.receiveShadow = data.receiveShadow;\n      if (data.visible !== undefined) object.visible = data.visible;\n      if (data.frustumCulled !== undefined) object.frustumCulled = data.frustumCulled;\n      if (data.renderOrder !== undefined) object.renderOrder = data.renderOrder;\n      if (data.userData !== undefined) object.userData = data.userData;\n      if (data.layers !== undefined) object.layers.mask = data.layers;\n\n      if (data.children !== undefined) {\n        var children = data.children;\n\n        for (var i = 0; i < children.length; i++) {\n          object.add(this.parseObject(children[i], textures));\n        }\n      }\n\n      return object;\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(json, onLoad) {\n      var images = this.parseImages(json.images, function () {\n        if (onLoad !== undefined) onLoad(object);\n      });\n      var textures = this.parseTextures(json.textures, images);\n      var object = this.parseObject(json.object, textures);\n\n      if (json.images === undefined || json.images.length === 0) {\n        if (onLoad !== undefined) onLoad(object);\n      }\n\n      return object;\n    }\n  }]);\n\n  return QuarksLoader;\n}();\n\nvar Gradient = /*#__PURE__*/function (_PiecewiseFunction2) {\n  _inherits(Gradient, _PiecewiseFunction2);\n\n  var _super3 = _createSuper(Gradient);\n\n  // default linear bezier\n  function Gradient() {\n    var _this3;\n\n    var functions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [[new ColorRange(new Vector4(0, 0, 0, 1), new Vector4(1, 1, 1, 1)), 0]];\n\n    _classCallCheck(this, Gradient);\n\n    _this3 = _super3.call(this);\n\n    _defineProperty(_assertThisInitialized(_this3), \"type\", void 0);\n\n    _this3.type = \"function\";\n    _this3.functions = functions;\n    return _this3;\n  }\n\n  _createClass(Gradient, [{\n    key: \"genColor\",\n    value: function genColor(color, t) {\n      var index = this.findFunction(t);\n\n      if (index === -1) {\n        console.error(t);\n        return color.copy(this.functions[0][0].a);\n      }\n\n      return this.getFunction(index).genColor(color, t);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        type: \"Gradient\",\n        functions: this.functions.map(function (_ref5) {\n          var _ref6 = _slicedToArray(_ref5, 2),\n              range = _ref6[0],\n              start = _ref6[1];\n\n          return {\n            function: range.toJSON(),\n            start: start\n          };\n        })\n      };\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new Gradient(this.functions.map(function (_ref7) {\n        var _ref8 = _slicedToArray(_ref7, 2),\n            range = _ref8[0],\n            start = _ref8[1];\n\n        return [range.clone(), start];\n      }));\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      return new Gradient(json.functions.map(function (piecewiseFunction) {\n        return [ColorRange.fromJSON(piecewiseFunction.function), piecewiseFunction.start];\n      }));\n    }\n  }]);\n\n  return Gradient;\n}(PiecewiseFunction);\n\nexport { BehaviorFromJSON, Bezier, ColorGeneratorFromJSON, ColorOverLife, ColorRange, ConeEmitter, ConstantColor, ConstantValue, DonutEmitter, FrameOverLife, Gradient, IntervalValue, OrbitOverLife, Particle, ParticleEmitter, ParticleSystem, PiecewiseBezier, PiecewiseFunction, PointEmitter, QuarksLoader, RandomColor, RenderMode, RotationOverLife, SizeOverLife, SphereEmitter, ValueGeneratorFromJSON };","import {AdditiveBlending, Group, NormalBlending, TextureLoader, Vector4} from \"three\";\r\nimport {ColorOverLife, ParticleSystem, RenderMode} from \"three.quarks\";\r\nimport {ConeEmitter} from \"three.quarks\";\r\nimport {IntervalValue} from \"three.quarks\";\r\nimport {SizeOverLife} from \"three.quarks\";\r\nimport {PiecewiseBezier} from \"three.quarks\";\r\nimport {ColorRange} from \"three.quarks\";\r\nimport {ConstantColor} from \"three.quarks\";\r\nimport {SphereEmitter} from \"three.quarks\";\r\nimport {RotationOverLife} from \"three.quarks\";\r\nimport {ConstantValue} from \"three.quarks\";\r\nimport {Bezier} from \"three.quarks\";\r\nimport {Gradient} from \"three.quarks\";\r\nimport {RandomColor} from \"three.quarks\";\r\n\r\nexport class ToonProjectile extends Group {\r\n    private particles: ParticleSystem;\r\n    private smoke: ParticleSystem;\r\n    private glowBeam: ParticleSystem;\r\n    private mainBeam: ParticleSystem;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        let texture = new TextureLoader().load( \"textures/texture1.png\");\r\n        texture.name = \"textures/texture1.png\";\r\n\r\n        this.mainBeam = new ParticleSystem({\r\n            duration: 1,\r\n            looping: true,\r\n            startLife: new IntervalValue(0.1, 0.15),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new ConstantValue(1.25),\r\n            startColor: new ConstantColor(new Vector4(1, 1, 1, .5)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(40),\r\n\r\n            shape: new SphereEmitter({\r\n                radius: .0001,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n        });\r\n        this.mainBeam.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.25, 0.05, 0), 0]])));\r\n        this.mainBeam.emitter.renderOrder = 2;\r\n        this.mainBeam.emitter.name = 'mainBeam';\r\n\r\n        this.add(this.mainBeam.emitter);\r\n\r\n        this.glowBeam = new ParticleSystem({\r\n            duration: 1,\r\n            looping: true,\r\n            startLife: new IntervalValue(0.1, 0.15),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new ConstantValue(3.5),\r\n            startColor: new ConstantColor(new Vector4(1, 0.1509503, 0.07352942, .5)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(40),\r\n\r\n            shape: new SphereEmitter({\r\n                radius: .0001,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 1,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n        });\r\n        this.glowBeam.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.95, 0.75, 0), 0]])));\r\n        this.glowBeam.emitter.renderOrder = 2;\r\n        this.glowBeam.emitter.name = 'glowBeam';\r\n\r\n        this.add(this.glowBeam.emitter);\r\n\r\n\r\n        this.particles = new ParticleSystem({\r\n            duration: 1,\r\n            looping: true,\r\n            startLife: new IntervalValue(0.3, 0.6),\r\n            startSpeed: new IntervalValue(2, 5),\r\n            startSize: new IntervalValue(.1, .4),\r\n            startColor: new RandomColor(new Vector4(1,1,1,.5), new Vector4(1, 0.1509503, 0.07352942, .5)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(60),\r\n\r\n            shape: new ConeEmitter({\r\n                angle: 4.8423 / 180 * Math.PI,\r\n                radius: .3,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            renderMode: RenderMode.StretchedBillBoard,\r\n            speedFactor: .01,\r\n            blending: NormalBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n        });\r\n        this.particles.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.25, 0.05, 0), 0]])));\r\n        this.particles.emitter.renderOrder = 0;\r\n        this.particles.emitter.rotateY(-Math.PI/2);\r\n        this.particles.emitter.name = 'particles';\r\n\r\n        this.add(this.particles.emitter);\r\n\r\n        this.smoke = new ParticleSystem({\r\n            startLife: new IntervalValue(0.25, 0.3),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new IntervalValue(.75, 1.25),\r\n            startRotation: new IntervalValue(0, Math.PI * 2),\r\n            startColor: new ConstantColor(new Vector4(1,1,1,.5)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(20),\r\n            shape: new SphereEmitter({\r\n                radius: .2,\r\n                thickness: 1,\r\n            }),\r\n\r\n            texture: texture,\r\n            blending: NormalBlending,\r\n            startTileIndex: 2,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n        });\r\n        this.smoke.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.95, 0.75, 0), 0]])));\r\n        this.smoke.addBehavior(new ColorOverLife(new ColorRange(new Vector4(1, 0.1509503, 0.07352942, 1), new Vector4(0, 0, 0, 0))));\r\n        this.smoke.addBehavior(new RotationOverLife(new IntervalValue(-Math.PI * 2, Math.PI * 2)));\r\n        this.smoke.emitter.renderOrder = -2;\r\n        this.smoke.emitter.name = 'smoke';\r\n\r\n        this.add(this.smoke.emitter);\r\n\r\n    }\r\n\r\n    update(delta: number) {\r\n        this.mainBeam.update(delta);\r\n        this.glowBeam.update(delta);\r\n        this.particles.update(delta);\r\n        this.smoke.update(delta);\r\n    }\r\n}\r\n","import {AdditiveBlending, Group, NormalBlending, TextureLoader, Vector4} from \"three\";\r\nimport {ColorOverLife, ParticleSystem, PointEmitter, RenderMode, RotationOverLife} from \"three.quarks\";\r\nimport {ConeEmitter} from \"three.quarks\";\r\nimport {IntervalValue} from \"three.quarks\";\r\nimport {SizeOverLife} from \"three.quarks\";\r\nimport {PiecewiseBezier} from \"three.quarks\";\r\nimport {ColorRange} from \"three.quarks\";\r\nimport {ConstantColor} from \"three.quarks\";\r\nimport {SphereEmitter} from \"three.quarks\";\r\nimport {FrameOverLife} from \"three.quarks\";\r\nimport {ConstantValue} from \"three.quarks\";\r\nimport {Bezier} from \"three.quarks\";\r\nimport {Gradient} from \"three.quarks\";\r\nimport {RandomColor} from \"three.quarks\";\r\n\r\nexport class BulletMuzzle extends Group {\r\n    private beam: ParticleSystem;\r\n    private muzzle1: ParticleSystem;\r\n    private muzzle2: ParticleSystem;\r\n    private flash: ParticleSystem;\r\n    private smoke: ParticleSystem;\r\n    private particles: ParticleSystem;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        let texture = new TextureLoader().load( \"textures/texture1.png\");\r\n        texture.name = \"textures/texture1.png\";\r\n\r\n        this.beam = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.1, 0.2),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new ConstantValue(4),\r\n            startColor: new ConstantColor(new Vector4(1, 0.585716, 0.1691176, 1)),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 10,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 1,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new PointEmitter(),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 1,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n        });\r\n        this.beam.emitter.renderOrder = 0;\r\n        this.beam.emitter.name = 'beam';\r\n        this.beam.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.95, 0.75, 0), 0]])));\r\n        this.add(this.beam.emitter);\r\n\r\n        let muzzle = {\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.1, 0.2),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new IntervalValue(1, 5),\r\n            startColor: new ConstantColor(new Vector4(1, 1, 1, 1)),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 5,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 1,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new PointEmitter(),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 91,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.LocalSpaceBillBoard\r\n        };\r\n\r\n        this.muzzle1 = new ParticleSystem(muzzle);\r\n        this.muzzle1.addBehavior(new ColorOverLife(new ColorRange(new Vector4(1, 0.3882312, 0.125, 1), new Vector4(1, 0.826827, 0.3014706, 1))));\r\n        this.muzzle1.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.95, 0.75, 0), 0]])));\r\n        this.muzzle1.addBehavior(new FrameOverLife(new PiecewiseBezier([[new Bezier(91, 94, 97, 100), 0]])));\r\n        this.muzzle1.emitter.renderOrder = 2;\r\n        this.muzzle1.emitter.name = 'muzzle1';\r\n        this.muzzle1.emitter.position.x = 1;\r\n        this.add(this.muzzle1.emitter);\r\n\r\n        this.muzzle2 = new ParticleSystem(muzzle);\r\n        this.muzzle2.addBehavior(new ColorOverLife(new ColorRange(new Vector4(1, 0.3882312, 0.125, 1), new Vector4(1, 0.826827, 0.3014706, 1))));\r\n        this.muzzle2.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.95, 0.75, 0), 0]])));\r\n        this.muzzle2.addBehavior(new FrameOverLife(new PiecewiseBezier([[new Bezier(91, 94, 97, 100), 0]])));\r\n        this.muzzle2.emitter.renderOrder = 2;\r\n        this.muzzle2.emitter.name = 'muzzle2';\r\n        this.muzzle2.emitter.position.x = 1;\r\n        this.muzzle2.emitter.rotation.x = Math.PI / 2;\r\n        this.add(this.muzzle2.emitter);\r\n\r\n        this.flash = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.1, 0.2),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new IntervalValue(1, 2.5),\r\n            startRotation: new IntervalValue(-Math.PI, Math.PI),\r\n            startColor: new ConstantColor(new Vector4(1, 1, 1, 1)),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 5,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 2,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new PointEmitter(),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 81,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.BillBoard\r\n        });\r\n        this.flash.addBehavior(new ColorOverLife(new ColorRange(new Vector4(1, 0.95, 0.82, 1), new Vector4(1, 0.38, 0.12, 1))));\r\n        this.flash.addBehavior(new FrameOverLife(new PiecewiseBezier([[new Bezier(81, 84.333, 87.666, 91), 0]])));\r\n        this.flash.emitter.renderOrder = 2;\r\n        this.flash.emitter.name = 'flash';\r\n        this.add(this.flash.emitter);\r\n\r\n        this.smoke = new ParticleSystem({\r\n            duration: 2.5,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.6, 0.8),\r\n            startSpeed: new IntervalValue(0.1, 3),\r\n            startSize: new IntervalValue(0.75, 1.5),\r\n            startRotation: new IntervalValue(-Math.PI, Math.PI),\r\n            startColor: new RandomColor(new Vector4(0.6323, 0.6323, 0.6323, .31), new Vector4(1, 1, 1, 0.54)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 10,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 5,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new ConeEmitter({\r\n                angle: 20 * Math.PI / 180,\r\n                radius: 0.3,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: NormalBlending,\r\n            startTileIndex: 81,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.BillBoard\r\n        });\r\n        this.smoke.addBehavior(new ColorOverLife(new ColorRange(new Vector4(1, 1, 1, 1), new Vector4(1, 1, 1, 0))));\r\n        this.smoke.addBehavior(new RotationOverLife(new IntervalValue(- Math.PI / 4, Math.PI / 4)));\r\n        this.smoke.addBehavior(new FrameOverLife(new PiecewiseBezier([[new Bezier(28, 31, 34, 37), 0]])));\r\n        this.smoke.emitter.renderOrder = -2;\r\n        this.smoke.emitter.name = 'smoke';\r\n        this.smoke.emitter.rotation.y = Math.PI / 2;\r\n        this.add(this.smoke.emitter);\r\n\r\n        this.particles = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.2, 0.6),\r\n            startSpeed: new IntervalValue(1, 15),\r\n            startSize: new IntervalValue(0.1, 0.3),\r\n            startColor: new RandomColor(new Vector4(1, 0.91, 0.51, 1), new Vector4(1, 0.44, 0.16, 1)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 10,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 8,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new ConeEmitter({\r\n                angle: 20 * Math.PI / 180,\r\n                radius: 0.3,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.StretchedBillBoard,\r\n            speedFactor: 0.5,\r\n        });\r\n        this.particles.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.95, 0.75, 0), 0]])));\r\n        this.particles.emitter.renderOrder = 1;\r\n        this.particles.emitter.name = 'particles';\r\n        this.particles.emitter.rotation.y = Math.PI / 2;\r\n        this.add(this.particles.emitter);\r\n    }\r\n\r\n    update(delta: number) {\r\n        this.beam.update(delta);\r\n        this.muzzle1.update(delta);\r\n        this.muzzle2.update(delta);\r\n        this.flash.update(delta);\r\n        this.smoke.update(delta);\r\n        this.particles.update(delta);\r\n    }\r\n}\r\n","import {AdditiveBlending, Group, NormalBlending, TextureLoader, Vector4} from \"three\";\r\nimport {ColorOverLife, ParticleSystem, PointEmitter, RenderMode, RotationOverLife} from \"three.quarks\";\r\nimport {ConeEmitter} from \"three.quarks\";\r\nimport {IntervalValue} from \"three.quarks\";\r\nimport {SizeOverLife} from \"three.quarks\";\r\nimport {PiecewiseBezier} from \"three.quarks\";\r\nimport {ColorRange} from \"three.quarks\";\r\nimport {ConstantColor} from \"three.quarks\";\r\nimport {SphereEmitter} from \"three.quarks\";\r\nimport {FrameOverLife} from \"three.quarks\";\r\nimport {ConstantValue} from \"three.quarks\";\r\nimport {Bezier} from \"three.quarks\";\r\nimport {Gradient} from \"three.quarks\";\r\nimport {RandomColor} from \"three.quarks\";\r\n\r\nexport class BulletProjectile extends Group {\r\n    private hProjectile: ParticleSystem;\r\n    private vProjectile: ParticleSystem;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        let texture = new TextureLoader().load( \"textures/projectile.png\");\r\n        texture.name = \"textures/projectile.png\";\r\n\r\n        let projectileParam = {\r\n            duration: 1,\r\n            looping: true,\r\n            startLife: new ConstantValue(0.5),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new IntervalValue(1, 2),\r\n            startColor: new ConstantColor(new Vector4(1, 1, 1, 1)),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 10,\r\n            emissionOverTime: new ConstantValue(4),\r\n\r\n            shape: new PointEmitter(),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 1,\r\n            vTileCount: 1,\r\n            instancingGeometry: [\r\n                -2, -0.5, 0, 0, 0,\r\n                2, -0.5, 0, 1, 0,\r\n                2, 0.5, 0, 1, 1,\r\n                -2, 0.5, 0, 0, 1\r\n            ],\r\n            renderMode: RenderMode.LocalSpaceBillBoard\r\n        };\r\n\r\n        this.hProjectile = new ParticleSystem(projectileParam);\r\n        this.hProjectile.addBehavior(new ColorOverLife(new Gradient([\r\n            [new ColorRange(new Vector4(1, 1, 1, 0), new Vector4(0, 1, 0.25, 1)), 0],\r\n            [new ColorRange(new Vector4(0, 1, 0.25, 1), new Vector4(1, 1, 1, 0)), 0.5]\r\n        ])));\r\n        this.hProjectile.emitter.renderOrder = 2;\r\n        this.hProjectile.emitter.name = 'hProjectile';\r\n        this.add(this.hProjectile.emitter);\r\n\r\n        this.vProjectile = new ParticleSystem(projectileParam);\r\n        this.vProjectile.addBehavior(new ColorOverLife(new Gradient([\r\n            [new ColorRange(new Vector4(1, 1, 1, 0), new Vector4(0, 1, 0.25, 1)), 0],\r\n            [new ColorRange(new Vector4(0, 1, 0.25, 1), new Vector4(1, 1, 1, 0)), 0.5]\r\n        ])));\r\n        this.vProjectile.emitter.renderOrder = 2;\r\n        this.vProjectile.emitter.name = 'vProjectile';\r\n        this.vProjectile.emitter.rotation.x = Math.PI / 2;\r\n        this.add(this.vProjectile.emitter);\r\n    }\r\n\r\n    update(delta: number) {\r\n        this.hProjectile.update(delta);\r\n        this.vProjectile.update(delta);\r\n    }\r\n}\r\n","import {AdditiveBlending, Group, NormalBlending, TextureLoader, Vector4} from \"three\";\r\nimport {ColorOverLife, ParticleSystem, PointEmitter, RenderMode, RotationOverLife} from \"three.quarks\";\r\nimport {ConeEmitter} from \"three.quarks\";\r\nimport {IntervalValue} from \"three.quarks\";\r\nimport {SizeOverLife} from \"three.quarks\";\r\nimport {PiecewiseBezier} from \"three.quarks\";\r\nimport {ColorRange} from \"three.quarks\";\r\nimport {ConstantColor} from \"three.quarks\";\r\nimport {SphereEmitter} from \"three.quarks\";\r\nimport {FrameOverLife} from \"three.quarks\";\r\nimport {ConstantValue} from \"three.quarks\";\r\nimport {Bezier} from \"three.quarks\";\r\nimport {Gradient} from \"three.quarks\";\r\nimport {RandomColor} from \"three.quarks\";\r\n\r\nexport class BulletHit extends Group {\r\n    private hProjectile: ParticleSystem;\r\n    private vProjectile: ParticleSystem;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        let texture = new TextureLoader().load( \"textures/projectile.png\");\r\n        texture.name = \"textures/projectile.png\";\r\n\r\n        let projectileParam = {\r\n            duration: 1,\r\n            looping: true,\r\n            startLife: new ConstantValue(0.5),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new IntervalValue(1.5, 2),\r\n            startColor: new ConstantColor(new Vector4(1, 1, 1, 1)),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 10,\r\n            emissionOverTime: new ConstantValue(4),\r\n\r\n            shape: new PointEmitter(),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 1,\r\n            vTileCount: 1,\r\n            renderMode: RenderMode.LocalSpaceBillBoard\r\n        };\r\n\r\n        this.hProjectile = new ParticleSystem(projectileParam);\r\n        this.hProjectile.addBehavior(new ColorOverLife(new Gradient([\r\n            [new ColorRange(new Vector4(1, 1, 1, 0), new Vector4(0, 1, 0.25, 1)), 0],\r\n            [new ColorRange(new Vector4(0, 1, 0.25, 1), new Vector4(1, 1, 1, 0)), 0.5]\r\n        ])));\r\n        this.hProjectile.emitter.renderOrder = 2;\r\n        this.hProjectile.emitter.name = 'hProjectile';\r\n        this.hProjectile.emitter.scale.x = 2;\r\n        this.add(this.hProjectile.emitter);\r\n\r\n        this.vProjectile = new ParticleSystem(projectileParam);\r\n        this.vProjectile.addBehavior(new ColorOverLife(new Gradient([\r\n            [new ColorRange(new Vector4(1, 1, 1, 0), new Vector4(0, 1, 0.25, 1)), 0],\r\n            [new ColorRange(new Vector4(0, 1, 0.25, 1), new Vector4(1, 1, 1, 0)), 0.5]\r\n        ])));\r\n        this.vProjectile.emitter.renderOrder = 2;\r\n        this.vProjectile.emitter.name = 'vProjectile';\r\n        this.vProjectile.emitter.rotation.x = Math.PI / 2;\r\n        this.vProjectile.emitter.scale.x = 10;\r\n        this.add(this.vProjectile.emitter);\r\n    }\r\n\r\n    update(delta: number) {\r\n        this.hProjectile.update(delta);\r\n        this.vProjectile.update(delta);\r\n    }\r\n}\r\n","import {AdditiveBlending, Group, NormalBlending, TextureLoader, Vector4} from \"three\";\r\nimport {FrameOverLife, ParticleSystem, PointEmitter, RenderMode} from \"three.quarks\";\r\nimport {ConeEmitter} from \"three.quarks\";\r\nimport {IntervalValue} from \"three.quarks\";\r\nimport {SizeOverLife} from \"three.quarks\";\r\nimport {PiecewiseBezier} from \"three.quarks\";\r\nimport {ColorRange} from \"three.quarks\";\r\nimport {ConstantColor} from \"three.quarks\";\r\nimport {SphereEmitter} from \"three.quarks\";\r\nimport {RotationOverLife} from \"three.quarks\";\r\nimport {ConstantValue} from \"three.quarks\";\r\nimport {Bezier} from \"three.quarks\";\r\nimport {ColorOverLife} from \"three.quarks\";\r\nimport {RandomColor} from \"three.quarks\";\r\n\r\n// TODO\r\nexport class ToonExplosion extends Group {\r\n    private mainBeam: ParticleSystem;\r\n    private glowBeam: ParticleSystem;\r\n    private particles: ParticleSystem;\r\n    private beam: ParticleSystem;\r\n    private smoke: ParticleSystem;\r\n    private circle: ParticleSystem;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        let texture = new TextureLoader().load( \"textures/texture1.png\");\r\n        texture.name = \"textures/texture1.png\";\r\n        this.mainBeam = new ParticleSystem({\r\n            duration: 2,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.1, 0.3),\r\n            startSpeed: new IntervalValue(5, 15),\r\n            startSize: new IntervalValue(1.5, 1.25),\r\n            startColor: new ConstantColor(new Vector4(1, 1, 1, 1)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 8,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new ConeEmitter({\r\n                angle: 25 * Math.PI / 180,\r\n                radius: 0.2,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n        });\r\n        this.mainBeam.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.25, 0.05, 0), 0]])));\r\n        this.mainBeam.emitter.renderOrder = 2;\r\n        this.mainBeam.emitter.name = 'mainBeam';\r\n        this.add(this.mainBeam.emitter);\r\n\r\n        this.glowBeam = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n\r\n            startLife: new IntervalValue(1, 1.6),\r\n            startSpeed: new IntervalValue(0.7, 1.5),\r\n            startSize: new IntervalValue(0.4, 0.8),\r\n            startColor: new ConstantColor(new Vector4(1, 0.1509503, 0.07352942, .5)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 8,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new ConeEmitter({\r\n                angle: 80 * Math.PI / 180,\r\n                radius: 0.25,\r\n                thickness: 0.5,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n        });\r\n        this.glowBeam.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.25, 0.05, 0), 0]])));\r\n        this.glowBeam.emitter.renderOrder = 2;\r\n        this.glowBeam.emitter.name = 'glowBeam';\r\n        this.add(this.glowBeam.emitter);\r\n\r\n        this.smoke = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.5, 0.8),\r\n            startSpeed: new IntervalValue(1, 2.5),\r\n            startSize: new IntervalValue(1, 1.5),\r\n            startRotation: new IntervalValue(0, Math.PI * 2),\r\n            startColor: new ConstantColor(new Vector4(1,1,1,.5)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 12,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new SphereEmitter({\r\n                radius: .75,\r\n                thickness: 1,\r\n            }),\r\n\r\n            texture: texture,\r\n            blending: NormalBlending,\r\n            startTileIndex: 2,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n        });\r\n        this.smoke.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.95, 0.75, 0), 0]])));\r\n        this.smoke.addBehavior(new ColorOverLife(new ColorRange(new Vector4(1, 0.1509503, 0.07352942, 1), new Vector4(0, 0, 0, 0))));\r\n        this.smoke.addBehavior(new RotationOverLife(new IntervalValue(-Math.PI * 2, Math.PI * 2)));\r\n        this.smoke.emitter.renderOrder = -2;\r\n        this.smoke.emitter.name = 'smoke';\r\n        this.add(this.smoke.emitter);\r\n\r\n        this.particles = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.6, 1.2),\r\n            startSpeed: new IntervalValue(2, 10),\r\n            startSize: new IntervalValue(.1, .4),\r\n            startColor: new RandomColor(new Vector4(1,1,1,1), new Vector4(1, 0.1509503, 0.07352942, 1)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 12,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new ConeEmitter({\r\n                angle: 50 / 180 * Math.PI,\r\n                radius: .5,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: NormalBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.StretchedBillBoard,\r\n            speedFactor: 0.5,\r\n        });\r\n        this.particles.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.25, 0.05, 0), 0]])));\r\n        this.particles.emitter.renderOrder = 0;\r\n        this.particles.emitter.name = 'particles';\r\n        this.add(this.particles.emitter);\r\n\r\n        this.beam = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n\r\n            startLife: new ConstantValue(0.2),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new ConstantValue(7),\r\n            startColor: new ConstantColor(new Vector4(1, 0.3059356, 0.2426471, 1)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 10,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 2,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new PointEmitter(),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 1,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n        });\r\n        this.beam.emitter.renderOrder = 0;\r\n        this.beam.emitter.name = 'beam';\r\n        this.beam.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.66666, 0.33333, 0), 0]])));\r\n        this.add(this.beam.emitter);\r\n\r\n        this.circle = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new ConstantValue(0.4),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new ConstantValue(4),\r\n            startColor: new ConstantColor(new Vector4(1, 0.3059356, 0.2426471, 1)),\r\n            worldSpace: true,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 1,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new PointEmitter(),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 10,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n        });\r\n        this.circle.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(0.3, 0.6, 0.9, 1), 0]])));\r\n        this.circle.addBehavior(new FrameOverLife(new PiecewiseBezier([[new Bezier(10, 13, 16, 19), 0]])));\r\n        this.circle.emitter.renderOrder = 2;\r\n        this.circle.emitter.name = 'circle';\r\n        this.add(this.circle.emitter);\r\n\r\n    }\r\n\r\n    update(delta: number) {\r\n        this.mainBeam.update(delta);\r\n        this.glowBeam.update(delta);\r\n        this.particles.update(delta);\r\n        this.smoke.update(delta);\r\n        this.beam.update(delta);\r\n        this.circle.update(delta);\r\n    }\r\n}","import {AdditiveBlending, Group, NormalBlending, Scene, TextureLoader, Vector4} from \"three\";\r\nimport {\r\n    Bezier, ColorOverLife, ColorRange, ConstantColor,\r\n    ConstantValue, FrameOverLife,\r\n    IntervalValue,\r\n    ParticleSystem,\r\n    PiecewiseBezier, PointEmitter, RandomColor,\r\n    RenderMode, RotationOverLife,\r\n    SizeOverLife,\r\n    SphereEmitter\r\n} from \"three.quarks\";\r\n\r\nexport class Explosion extends Group {\r\n\r\n    static yellowColor = new Vector4(0.9, 0.60, 0.25, 1);\r\n    static yellowColor2 = new Vector4(1, 0.95, 0.4, 1);\r\n\r\n    private gatherParticles: ParticleSystem;\r\n    private mainBeam: ParticleSystem;\r\n    private glowBeam: ParticleSystem;\r\n    private smoke: ParticleSystem;\r\n    private particles: ParticleSystem;\r\n    private beam: ParticleSystem;\r\n    private circle: ParticleSystem;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        let texture = new TextureLoader().load( \"textures/texture1.png\");\r\n        texture.name = \"textures/texture1.png\";\r\n        let mainColor = Explosion.yellowColor;\r\n        let secColor = Explosion.yellowColor2;\r\n\r\n        this.gatherParticles = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.3, 0.4),\r\n            startSpeed: new IntervalValue(-100, -150),\r\n            startSize: new IntervalValue(1, 3),\r\n            startColor: new ConstantColor(new Vector4(1,1,1,1)),\r\n            worldSpace: false,\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 30,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n            shape: new SphereEmitter({\r\n                radius: 40,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.BillBoard\r\n        });\r\n        //this.gatherParticles.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.25, 0.05, 0), 0]])));\r\n        this.gatherParticles.addBehavior(new ColorOverLife(new ColorRange(new Vector4(mainColor.x, mainColor.y, mainColor.z, .2), new Vector4(mainColor.x, mainColor.y, mainColor.z, 1))));\r\n        this.gatherParticles.emitter.renderOrder = 2;\r\n        this.gatherParticles.emitter.name = 'gatherParticles';\r\n        this.add(this.gatherParticles.emitter);\r\n\r\n        this.mainBeam = new ParticleSystem({\r\n            duration: 2,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.1, 0.3),\r\n            startSpeed: new IntervalValue(100, 300),\r\n            startSize: new IntervalValue(1.5, 12.5),\r\n            startColor: new ConstantColor(new Vector4(1, 1, 1, 1)),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0.4,\r\n                count: 8,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new SphereEmitter({\r\n                radius: 2,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.BillBoard\r\n        });\r\n        this.mainBeam.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.25, 0.05, 0), 0]])));\r\n        this.mainBeam.emitter.renderOrder = 2;\r\n        this.mainBeam.emitter.name = 'mainBeam';\r\n        this.add(this.mainBeam.emitter);\r\n\r\n        this.glowBeam = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n\r\n            startLife: new IntervalValue(1, 1.6),\r\n            startSpeed: new IntervalValue(20, 45),\r\n            startSize: new IntervalValue(4, 8),\r\n            startColor: new ConstantColor(mainColor),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0.4,\r\n                count: 8,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new SphereEmitter({\r\n                radius: 2,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.BillBoard\r\n        });\r\n        this.glowBeam.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.25, 0.05, 0), 0]])));\r\n        this.glowBeam.emitter.renderOrder = 2;\r\n        this.glowBeam.emitter.name = 'glowBeam';\r\n        this.add(this.glowBeam.emitter);\r\n\r\n        this.smoke = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.5, 0.8),\r\n            startSpeed: new IntervalValue(20, 50),\r\n            startSize: new IntervalValue(10, 15),\r\n            startRotation: new IntervalValue(0, Math.PI * 2),\r\n            startColor: new ConstantColor(new Vector4(1,1,1,.5)),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0.4,\r\n                count: 12,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new SphereEmitter({\r\n                radius: 7.5,\r\n                thickness: 1,\r\n            }),\r\n\r\n            texture: texture,\r\n            blending: NormalBlending,\r\n            startTileIndex: 2,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.BillBoard\r\n        });\r\n        this.smoke.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.95, 0.75, 0), 0]])));\r\n        this.smoke.addBehavior(new ColorOverLife(new ColorRange(mainColor, new Vector4(0, 0, 0, 0))));\r\n        this.smoke.addBehavior(new RotationOverLife(new IntervalValue(-Math.PI * 2, Math.PI * 2)));\r\n        this.smoke.emitter.renderOrder = -2;\r\n        this.smoke.emitter.name = 'smoke';\r\n        this.add(this.smoke.emitter);\r\n\r\n        this.particles = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.6, 1.2),\r\n            startSpeed: new IntervalValue(40, 200),\r\n            startSize: new IntervalValue(1, 4),\r\n            startColor: new RandomColor(new Vector4(1,1,1,1), mainColor),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0.4,\r\n                count: 12,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new SphereEmitter({\r\n                radius: 2,\r\n                thickness: 1,\r\n                arc: Math.PI * 2,\r\n            }),\r\n            texture: texture,\r\n            blending: NormalBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.StretchedBillBoard,\r\n            speedFactor: 0.1,\r\n        });\r\n        this.particles.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.25, 0.05, 0), 0]])));\r\n        this.particles.emitter.renderOrder = 0;\r\n        this.particles.emitter.name = 'particles';\r\n        this.add(this.particles.emitter);\r\n\r\n        this.beam = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n\r\n            startLife: new ConstantValue(0.2),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new ConstantValue(100),\r\n            startColor: new ConstantColor(secColor),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 10,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0.35,\r\n                count: 2,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new PointEmitter(),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 1,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.BillBoard\r\n        });\r\n        this.beam.emitter.renderOrder = -2;\r\n        this.beam.emitter.name = 'beam';\r\n        this.beam.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(1, 0.66666, 0.33333, 0), 0]])));\r\n        this.add(this.beam.emitter);\r\n\r\n        this.circle = new ParticleSystem({\r\n            duration: 1,\r\n            looping: false,\r\n            startLife: new ConstantValue(0.4),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new ConstantValue(40),\r\n            startColor: new ConstantColor(secColor),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0.4,\r\n                count: 1,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new PointEmitter(),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 10,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            renderMode: RenderMode.BillBoard\r\n        });\r\n        this.circle.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(0.3, 0.6, 0.9, 1), 0]])));\r\n        this.circle.addBehavior(new FrameOverLife(new PiecewiseBezier([[new Bezier(10, 13, 16, 19), 0]])));\r\n        this.circle.emitter.renderOrder = 2;\r\n        this.circle.emitter.name = 'circle';\r\n        this.add(this.circle.emitter);\r\n    }\r\n\r\n    update(delta: number) {\r\n        //delta /= 1000;\r\n        this.gatherParticles.update(delta);\r\n        this.beam.update(delta);\r\n        this.mainBeam.update(delta);\r\n        this.glowBeam.update(delta);\r\n        this.circle.update(delta);\r\n        this.smoke.update(delta);\r\n        this.particles.update(delta);\r\n    }\r\n}\r\n","import {AdditiveBlending, Group, TextureLoader, Vector4} from \"three\";\r\nimport {\r\n    Bezier,\r\n    ColorOverLife, ColorRange, ConeEmitter,\r\n    ConstantColor,\r\n    ConstantValue, Gradient,\r\n    IntervalValue, OrbitOverLife,\r\n    ParticleSystem, PiecewiseBezier,\r\n    PointEmitter,\r\n    RenderMode, SizeOverLife\r\n} from \"three.quarks\";\r\n\r\nexport class LevelUp extends Group {\r\n\r\n    private glow: ParticleSystem;\r\n    private particle: ParticleSystem;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        let texture = new TextureLoader().load( \"textures/texture1.png\");\r\n        texture.name = \"textures/texture1.png\";\r\n\r\n        let glowParam = {\r\n            duration: 2,\r\n            looping: false,\r\n            startLife: new ConstantValue(2.0),\r\n            startSpeed: new ConstantValue(0),\r\n            startSize: new IntervalValue(60, 80),\r\n            startColor: new ConstantColor(new Vector4(1, 1, 0.8, 1)),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 10,\r\n            emissionOverTime: new ConstantValue(0),\r\n            emissionBursts: [{\r\n                time: 0,\r\n                count: 1,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],\r\n\r\n            shape: new PointEmitter(),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 1,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            instancingGeometry: [\r\n                -1, -1, 0, 0, 0,\r\n                1, -1, 0, 1, 0,\r\n                1, 1, 0, 1, 1,\r\n                -1, 1, 0, 0, 1\r\n            ],\r\n            renderMode: RenderMode.LocalSpaceBillBoard\r\n        };\r\n\r\n        this.glow = new ParticleSystem(glowParam);\r\n        /*this.glow.addBehavior(new ColorOverLife(new Gradient([\r\n            [new ColorRange(new Vector4(1, 1, 1, 0), new Vector4(0, 1, 0.25, 1)), 0],\r\n            [new ColorRange(new Vector4(0, 1, 0.25, 1), new Vector4(1, 1, 1, 0)), 0.5]\r\n        ])));*/\r\n        this.glow.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(0, 0.75, 0.90, 1),0], [new Bezier(1, 0.90, 0.75, 0), 0.5]])));\r\n        this.glow.emitter.renderOrder = 0;\r\n        this.glow.emitter.name = 'glow';\r\n        this.glow.emitter.rotation.x = -Math.PI / 2;\r\n        this.add(this.glow.emitter);\r\n\r\n\r\n        let particleParam = {\r\n            duration: 0.6,\r\n            looping: false,\r\n            startLife: new IntervalValue(0.6, 0.8),\r\n            startSpeed: new IntervalValue(120, 180),\r\n            startSize: new IntervalValue(2, 4),\r\n            startColor: new ConstantColor(new Vector4(1, 1, 0.8, 1)),\r\n            worldSpace: false,\r\n\r\n            maxParticle: 100,\r\n            emissionOverTime: new ConstantValue(80),\r\n            /*emissionBursts: [{\r\n                time: 0,\r\n                count: 30,\r\n                cycle: 1,\r\n                interval: 0.01,\r\n                probability: 1,\r\n            }],*/\r\n            shape: new ConeEmitter({\r\n                radius: 25,\r\n                thickness: 0.2,\r\n                angle: Math.PI / 100\r\n            }),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            //speedFactor: 0.1,\r\n            renderMode: RenderMode.BillBoard\r\n        };\r\n\r\n        this.particle = new ParticleSystem(particleParam);\r\n        this.particle.addBehavior(new SizeOverLife(new PiecewiseBezier([[new Bezier(0, 0.75, 0.90, 1),0], [new Bezier(1, 0.90, 0.75, 0), 0.5]])));\r\n        this.particle.addBehavior(new OrbitOverLife(new PiecewiseBezier([[new Bezier(0, Math.PI * 4* 0.75, Math.PI * 4 * 0.90, Math.PI * 4),0]])));\r\n        this.particle.emitter.renderOrder = 2;\r\n        this.particle.emitter.name = 'particle';\r\n        this.particle.emitter.rotation.x = -Math.PI / 2;\r\n        this.add(this.particle.emitter);\r\n\r\n    }\r\n\r\n    update(delta: number) {\r\n        this.glow.update(delta);\r\n        this.particle.update(delta);\r\n    }\r\n}\r\n","import * as React from \"react\";\r\nimport * as THREE from \"three\";\r\nimport {Object3D} from \"three\";\r\nimport {ParticleEmitter, QuarksLoader} from \"three.quarks\";\r\nimport {Application} from \"./Application\";\r\nimport {TextureLoader} from \"three\";\r\nimport {ParticleSystem} from \"three.quarks\";\r\nimport {ConeEmitter} from \"three.quarks\";\r\nimport {ConstantValue} from \"three.quarks\";\r\nimport {ConstantColor} from \"three.quarks\";\r\nimport {Vector4} from \"three\";\r\nimport {AdditiveBlending} from \"three\";\r\nimport {Mesh} from \"three\";\r\nimport {BoxBufferGeometry} from \"three\";\r\nimport {MeshStandardMaterial} from \"three\";\r\nimport {ToonProjectile} from \"../example/ToonProjectile\";\r\nimport {Color} from \"three\";\r\nimport {AxesHelper} from \"three\";\r\nimport {PointLight} from \"three\";\r\nimport {AmbientLight} from \"three\";\r\nimport {BulletMuzzle} from \"../example/BulletMuzzle\";\r\nimport {BulletProjectile} from \"../example/BulletProjectile\";\r\nimport {BulletHit} from \"../example/BulletHit\";\r\nimport {ToonExplosion} from \"../example/ToonExplosion\";\r\nimport {Explosion} from \"../example/Explosion\";\r\nimport {LevelUp} from \"../example/LevelUp\";\r\n\r\n\r\nexport interface AppContext {\r\n    scene: THREE.Scene;\r\n    script: (delta: number) => void;\r\n    selection: Array<Object3D>;\r\n    actions: {\r\n        onOpenDemo: (index: number)=>void;\r\n        onSaveAs: ()=>void;\r\n        onImport: (files: FileList)=>void;\r\n        select: (object: Object3D) => void;\r\n        selectAddition: (object: Object3D) => void;\r\n        addObject3d: (type: string, parent: Object3D) => void;\r\n        removeObject3d: (object: Object3D) => void;\r\n        duplicateObject3d: (object: Object3D) => void;\r\n        updateParticleSystem: (object: ParticleEmitter) => void;\r\n        updateProperties: () => void;\r\n    }\r\n}\r\n\r\nconst ApplicationContext = React.createContext<AppContext | null>(null);\r\n\r\nexport const ApplicationContextConsumer = ApplicationContext.Consumer;\r\n\r\nexport class ApplicationContextProvider extends React.Component<{ }, AppContext> {\r\n\r\n    createScene(demoIndex: number) {\r\n        const scene = new THREE.Scene();\r\n\r\n        scene.background = new Color(0x666666);\r\n\r\n        let demoObject;\r\n        if (demoIndex === 0) {\r\n            demoObject = new ToonProjectile();\r\n            demoObject.name = \"Toon Projectile\";\r\n            demoObject.userData = {\r\n                script:\r\n                    \"    this.position.x += delta * 30;\\n\" +\r\n                    \"    if (this.position.x > 20)\\n\" +\r\n                    \"        this.position.x = -20;\\n\"\r\n            };\r\n            demoObject.userData.func = new Function(\"delta\", demoObject.userData.script);\r\n        } else if (demoIndex === 1) {\r\n            demoObject = new BulletMuzzle();\r\n            demoObject.name = \"BulletMuzzle\";\r\n        } else if (demoIndex === 2) {\r\n            demoObject = new BulletProjectile();\r\n            demoObject.name = \"BulletProjectile\";\r\n        } else if (demoIndex === 3) {\r\n            demoObject = new BulletHit();\r\n            demoObject.name = \"BulletHit\";\r\n        } else if (demoIndex === 4) {\r\n            demoObject = new ToonExplosion();\r\n            demoObject.name = \"ToonExplosion\";\r\n        } else if (demoIndex === 5) {\r\n            demoObject = new Explosion();\r\n            demoObject.name = \"Explosion\";\r\n        } else if (demoIndex === 6) {\r\n            demoObject = new LevelUp();\r\n            demoObject.name = \"LevelUp\";\r\n        } else {\r\n            demoObject = new Explosion();\r\n            demoObject.name = \"Explosion\";\r\n        }\r\n        scene.add(demoObject);\r\n\r\n        const axisHelper = new AxesHelper(100);\r\n        axisHelper.name = \"axisHelper\";\r\n        scene.add(axisHelper);\r\n\r\n        const light = new PointLight(new Color(1, 1, 1), 0.8, 200);\r\n        light.position.set(50, 50, 50);\r\n        scene.add(light);\r\n\r\n        const ambientLight = new AmbientLight(new Color(1, 1, 1), 0.2);\r\n        scene.add(ambientLight);\r\n\r\n        return scene;\r\n    }\r\n\r\n    constructor(props: Readonly<{}>) {\r\n        super(props);\r\n        const state: AppContext = {\r\n            scene: this.createScene(0),\r\n            script: this.animate,\r\n            selection: [],\r\n            actions: {\r\n                onOpenDemo: (index: number) => {\r\n                    const scene = this.createScene(index);\r\n                    this.setState({scene: scene});\r\n                },\r\n                onSaveAs: () => {\r\n                    const a = document.createElement(\"a\");\r\n                    const file = new Blob([JSON.stringify(this.state.scene.toJSON())], {type: \"application/json\"});\r\n                    a.href = URL.createObjectURL(file);\r\n                    a.download = \"scene.json\";\r\n                    a.click();\r\n                },\r\n                onImport: (files: FileList) => {\r\n                    const nFiles = files.length;\r\n                    for (let nFileId = 0; nFileId < nFiles; nFileId++) {\r\n                        const jsonURL = URL.createObjectURL( files[nFileId] );\r\n\r\n                        const loader = new QuarksLoader();\r\n                        loader.setCrossOrigin(\"\");\r\n                        loader.load(jsonURL, (object3D: Object3D)=>{\r\n                            this.state.scene.add(object3D);\r\n                        }, ()=>{}, ()=>{});\r\n                    }\r\n                },\r\n                select: object => {\r\n                    this.setState({selection: [object]});\r\n                },\r\n                selectAddition: object => {\r\n                    if (this.state.selection.indexOf(object) === -1) {\r\n                        this.state.selection.push(object);\r\n                        this.setState({selection: this.state.selection});\r\n                    }\r\n                },\r\n                addObject3d: this.addObject3d,\r\n                removeObject3d: this.removeObject3d,\r\n                duplicateObject3d: this.duplicateObject3d,\r\n                updateParticleSystem: () => {\r\n                },\r\n                updateProperties: () => {\r\n                    this.setState({scene: this.state.scene});\r\n                }\r\n            }\r\n        };\r\n\r\n        this.state = state;\r\n    }\r\n\r\n    removeObject3d = (object3D: Object3D) => {\r\n        if (object3D.parent) {\r\n            object3D.parent.remove(object3D);\r\n        }\r\n    };\r\n\r\n    duplicateObject3d = (object3D: Object3D) => {\r\n        if (object3D.parent) {\r\n            object3D.parent.add(object3D.clone());\r\n        }\r\n    }\r\n\r\n    addObject3d = (type: string, parent: Object3D) => {\r\n        let object;\r\n        switch (type) {\r\n            case 'particle':\r\n                const texture = new TextureLoader().load(\"textures/texture1.png\");\r\n                const particleSystem = new ParticleSystem({\r\n                    maxParticle: 10000,\r\n                    shape: new ConeEmitter(),\r\n                    emissionOverTime: new ConstantValue(100),\r\n                    startLife: new ConstantValue(30),\r\n                    startSpeed: new ConstantValue(10),\r\n                    startSize: new ConstantValue(1),\r\n                    startColor: new ConstantColor(new Vector4(1, 1, 1, 1)),\r\n                    texture: texture,\r\n                    blending: AdditiveBlending,\r\n                    startTileIndex: 0,\r\n                    uTileCount: 10,\r\n                    vTileCount: 10,\r\n                    worldSpace: true,\r\n                });\r\n                object = particleSystem.emitter;\r\n                this.state.scene.add(object);\r\n                break;\r\n            case 'box':\r\n                object = new Mesh(new BoxBufferGeometry(10, 10, 10), new MeshStandardMaterial({color: 0xcccccc}));\r\n                this.state.scene.add(object);\r\n                break;\r\n        }\r\n        if (object) {\r\n            parent.add(object);\r\n            this.state.actions.select(object);\r\n            this.setState({});\r\n        }\r\n    };\r\n\r\n\r\n    update = 0;\r\n    animate = (delta: number) => {\r\n        /*this.toonProjectile!.position.x += delta * 30;\r\n        if (this.toonProjectile!.position.x > 20)\r\n            this.toonProjectile!.position.x = -20;*/\r\n\r\n        this.update += delta;\r\n        if (this.update > 0.1) {\r\n            this.state.actions.updateProperties();\r\n            this.update = 0;\r\n        }\r\n    };\r\n\r\n    render() {\r\n        //console.log( \"rendering ApplicationContext \");\r\n        return (\r\n            <ApplicationContext.Provider value={this.state}>\r\n                {this.props.children}\r\n            </ApplicationContext.Provider>\r\n        )\r\n    }\r\n}\r\n/*\r\n        this.particleSystem = new ParticleSystem({\r\n            maxParticle: 10000,\r\n            shape: new ConeEmitter(),\r\n            emissionOverTime: new ConstantValue(100),\r\n            startLife: new ConstantValue(30),\r\n            startSpeed: new ConstantValue(10),\r\n            startSize: new ConstantValue(1),\r\n            startColor: new ConstantColor(new Vector4(1,1,1, 1)),\r\n            texture: texture,\r\n            blending: AdditiveBlending,\r\n            startTileIndex: 0,\r\n            uTileCount: 10,\r\n            vTileCount: 10,\r\n            worldSpace: true,\r\n        });*/\r\n//this.particleSystem.emitter.position.set(10, 0, 0);\r\n//scene.add(this.particleSystem.emitter);","import * as React from \"react\";\r\nimport Stats from \"stats.js\";\r\nimport {WEBGL} from \"../WebGL\";\r\nimport {\r\n    PerspectiveCamera,\r\n    WebGLRenderer,\r\n    Clock,\r\n} from \"three\";\r\nimport {RefObject} from \"react\";\r\nimport {OrbitControls} from \"three/examples/jsm/controls/OrbitControls\";\r\nimport {ParticleEmitter} from \"three.quarks\";\r\nimport {AppContext, ApplicationContextConsumer} from \"./ApplicationContext\";\r\n\r\ninterface ThreejsViewportProps {\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\nexport class ThreejsViewport extends React.PureComponent<ThreejsViewportProps> {\r\n    container: RefObject<HTMLDivElement>;\r\n    stats?: Stats;\r\n    camera?: PerspectiveCamera;\r\n    renderer?: WebGLRenderer;\r\n    private clock?: Clock;\r\n    private controls?: OrbitControls;\r\n\r\n    private appContext?: AppContext;\r\n\r\n    constructor(props: Readonly<ThreejsViewportProps>) {\r\n        super(props);\r\n        this.container = React.createRef();\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        if ( this.init() ) {\r\n            this.animate();\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Readonly<ThreejsViewportProps>, prevState: Readonly<{}>, snapshot?: any): void {\r\n        this.camera!.aspect = this.props.width / this.props.height;\r\n        this.camera!.updateProjectionMatrix();\r\n        this.renderer!.setSize( this.props.width, this.props.height );\r\n    }\r\n\r\n    init() {\r\n        if (!this.container.current) {\r\n            return false;\r\n        }\r\n\r\n        if ( !WEBGL.isWebGLAvailable() ) {\r\n            document.body.appendChild( WEBGL.getWebGLErrorMessage() );\r\n            return false;\r\n        }\r\n\r\n        this.renderer = new WebGLRenderer();\r\n\r\n        /*if ( this.renderer.extensions.get( 'ANGLE_instanced_arrays' ) === null ) {\r\n            document.getElementById( 'notSupported' )!.style.display = '';\r\n            return false;\r\n        }*/\r\n\r\n        const width = this.props.width;\r\n        const height = this.props.height;\r\n\r\n        this.clock = new Clock();\r\n\r\n        this.camera = new PerspectiveCamera( 50, width / height, 1, 1000 );\r\n        this.camera.position.set(50, 50, 50);\r\n\r\n        this.controls = new OrbitControls( this.camera, this.renderer.domElement );\r\n        this.controls.enableKeys = false;\r\n        this.controls.enableDamping = true;\r\n        this.controls.dampingFactor = 0.1;\r\n        this.controls.rotateSpeed = 0.2;\r\n        this.controls.update();\r\n\r\n        this.renderer.setPixelRatio( window.devicePixelRatio );\r\n        this.renderer.setSize( width, height );\r\n        this.container.current!.appendChild( this.renderer.domElement );\r\n\r\n        this.stats = new Stats();\r\n        this.stats.dom.style.position = \"absolute\";\r\n        this.stats.dom.style.left = \"\";\r\n        this.stats.dom.style.right = \"0\";\r\n        this.container.current!.appendChild( this.stats.dom );\r\n\r\n        //window.addEventListener( 'resize', this.onWindowResize, false );\r\n\r\n        this.onResize(null);\r\n\r\n        return true;\r\n\r\n    }\r\n\r\n    onResize = (event: any ) => {\r\n\r\n        if (this.renderer!.domElement.parentElement!.clientWidth - 10 !== this.renderer!.domElement.width ||\r\n            this.renderer!.domElement.parentElement!.clientHeight - 10 !== this.renderer!.domElement.height) {\r\n\r\n            const newWidth = this.renderer!.domElement.parentElement!.clientWidth - 10;\r\n            const newHeight = this.renderer!.domElement.parentElement!.clientHeight - 10;\r\n\r\n            this.camera!.aspect = newWidth / newHeight;\r\n            this.camera!.updateProjectionMatrix();\r\n            this.renderer!.domElement.style.width = '100%';\r\n            this.renderer!.domElement.style.height = '100%';\r\n            this.renderer!.setSize(newWidth, newHeight);\r\n        }\r\n    };\r\n\r\n    animate = () => {\r\n        requestAnimationFrame( this.animate );\r\n\r\n        this.onResize(null);\r\n        this.renderScene();\r\n        this.stats!.update();\r\n    };\r\n\r\n    renderScene() {\r\n        if (this.appContext) {\r\n            this.controls!.update();\r\n            const delta = this.clock!.getDelta();\r\n            //let time = performance.now() * 0.0005;\r\n            //this.particleSystem!.update(this.clock!.getDelta());\r\n            this.appContext.script(delta);\r\n            //this.particleSystem!.emitter.rotation.y = this.clock!.getElapsedTime();\r\n            //this.particleSystem!.emitter.position.set(Math.cos(this.clock!.getElapsedTime()) * 20, 0, Math.sin(this.clock!.getElapsedTime()) * 20);\r\n            //console.log(this.particleSystem!.emitter.modelViewMatrix);\r\n\r\n            this.appContext.scene.traverse(object => {\r\n                if (object.userData && object.userData.func) {\r\n                    object.userData.func.call(object, delta);\r\n                }\r\n                if (object instanceof ParticleEmitter) {\r\n                    /*if (object.name === 'muzzle1' && object.system.particleNum > 0) {\r\n                        console.log(object.system.particles);\r\n                    }*/\r\n                    object.system.update(delta);\r\n                }\r\n            });\r\n\r\n            this.renderer!.render(this.appContext.scene, this.camera!);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        console.log( \"rendering ThreejsViewPort\");\r\n        return (\r\n        <ApplicationContextConsumer>\r\n            { context => {\r\n                    if (context) {\r\n                        this.appContext = context;\r\n                        return <div ref={this.container} style={{width: '100%', height: '100%'}}></div>;\r\n                    }\r\n                }\r\n            }\r\n        </ApplicationContextConsumer>);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport \"./NumberInput.scss\";\r\n\r\ninterface NumberInputProps{\r\n    value: number;\r\n    onChange: (value: number)=>void;\r\n}\r\n\r\nexport const NumberInput : React.FC<NumberInputProps> = (props) => {\r\n\r\n    const [inputValue, setInputValue] = React.useState(props.value + '');\r\n    const [focus, setFocus] = React.useState(false);\r\n\r\n    const onInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (focus) {\r\n            setInputValue(e.target.value);\r\n        }\r\n    };\r\n\r\n    const onInputBlur = (e: React.FocusEvent) => {\r\n        const x = parseFloat(inputValue);\r\n        if (x !== props.value)\r\n            props.onChange(x);\r\n        setFocus(false);\r\n    };\r\n\r\n    const onInputFocus = (e: React.FocusEvent) => {\r\n        if (inputValue !== props.value + '') {\r\n            setInputValue(props.value + '');\r\n        }\r\n        setFocus(true);\r\n    };\r\n\r\n    const onKeyDown = (e: React.KeyboardEvent) => {\r\n        if (e.key === 'Enter') {\r\n            const x = parseFloat(inputValue);\r\n            if (x !== props.value)\r\n                props.onChange(x);\r\n        }\r\n    };\r\n\r\n    return <input className=\"number-input\" value={focus? inputValue: props.value} size={5}\r\n            onChange={onInputChange} onBlur={onInputBlur} onFocus={onInputFocus} onKeyDown={onKeyDown}\r\n        />;\r\n};\r\n","import * as React from \"react\";\r\nimport {NumberInput} from \"./NumberInput\";\r\n\r\ninterface Vector3Props {\r\n    name: string;\r\n    x: number;\r\n    y: number;\r\n    z: number;\r\n    onChange: (x: number, y: number, z: number)=>void;\r\n    unitConversion?: number;\r\n}\r\n\r\nexport class Vector3Editor extends React.PureComponent<Vector3Props> {\r\n    render() {\r\n        console.log('rendered Vector3');\r\n        const {x, y, z, unitConversion = 1, onChange, name} = this.props;\r\n        return(<div className=\"property\">\r\n                <label className=\"name\">{name}</label>\r\n                <label>X:</label><NumberInput value={x * unitConversion} onChange={value => {onChange(value / unitConversion, y, z)}}/>\r\n                <label>Y:</label><NumberInput value={y * unitConversion} onChange={value => {onChange(x, value / unitConversion, z)}}/>\r\n                <label>Z:</label><NumberInput value={z * unitConversion} onChange={value => {onChange(x, y, value / unitConversion)}}/>\r\n            </div>\r\n        );\r\n    }\r\n}","import * as React from 'react';\r\n\r\ninterface StringInputProps{\r\n    value: string;\r\n    onChange: (value: string)=>void;\r\n}\r\n\r\nexport const StringInput : React.FC<StringInputProps> = (props) => {\r\n\r\n    const [inputValue, setInputValue] = React.useState(props.value);\r\n    const [focus, setFocus] = React.useState(false);\r\n\r\n    const onInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (focus) {\r\n            setInputValue(e.target.value);\r\n        }\r\n    };\r\n\r\n    const onInputBlur = (e: React.FocusEvent) => {\r\n        if (inputValue !== props.value)\r\n            props.onChange(inputValue);\r\n        setFocus(false);\r\n    };\r\n\r\n    const onInputFocus = (e: React.FocusEvent) => {\r\n        if (inputValue !== props.value) {\r\n            setInputValue(props.value);\r\n        }\r\n        setFocus(true);\r\n    };\r\n\r\n    const onKeyDown = (e: React.KeyboardEvent) => {\r\n        if (e.key === 'Enter') {\r\n            if (inputValue !== props.value)\r\n                props.onChange(inputValue);\r\n        }\r\n    };\r\n\r\n    return <input className=\"string-input\" value={focus? inputValue: props.value} size={20}\r\n            onChange={onInputChange} onBlur={onInputBlur} onFocus={onInputFocus} onKeyDown={onKeyDown}\r\n        />;\r\n};\r\n","import * as React from \"react\";\r\nimport {Euler, Object3D, Vector3} from \"three\";\r\nimport {Vector3Editor} from \"./editors/Vector3Editor\";\r\nimport {ApplicationContextConsumer} from \"./ApplicationContext\";\r\nimport {StringInput} from \"./editors/StringInput\";\r\n\r\n\r\ninterface ObjectPropertiesProps {\r\n    object3d: Object3D,\r\n    updateProperties: Function,\r\n}\r\n\r\ninterface ObjectPropertiesState {\r\n\r\n}\r\n\r\nexport class ObjectProperties extends React.PureComponent<ObjectPropertiesProps, ObjectPropertiesState> {\r\n    constructor(props: Readonly<ObjectPropertiesProps>) {\r\n        super(props);\r\n    }\r\n\r\n    onChangeName = (name: string) => {\r\n        this.props.object3d.name = name;\r\n        this.props.updateProperties();\r\n    };\r\n    onChangePosition = (x: number, y: number, z: number) => {\r\n        this.props.object3d.position.set(x, y, z);\r\n        this.props.updateProperties();\r\n    };\r\n    onChangeScale = (x: number, y: number, z: number) => {\r\n        this.props.object3d.scale.set(x, y, z);\r\n        this.props.updateProperties();\r\n    };\r\n    onChangeRotation = (x: number, y: number, z: number) => {\r\n        this.props.object3d.rotation.set(x, y, z);\r\n        this.props.updateProperties();\r\n    };\r\n\r\n    render() {\r\n        console.log('rendered objectProperties');\r\n        return (\r\n            <div>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <div className=\"property\">\r\n                            <label className=\"name\">Name:</label>\r\n                            <StringInput value={this.props.object3d.name} onChange={this.onChangeName}/>\r\n                        </div>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <Vector3Editor name=\"Position\" x={this.props.object3d.position.x}\r\n                                       y={this.props.object3d.position.y} z={this.props.object3d.position.z}\r\n                                       onChange={this.onChangePosition}/>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <Vector3Editor name=\"Rotation\" x={this.props.object3d.rotation.x}\r\n                                       y={this.props.object3d.rotation.y} z={this.props.object3d.rotation.z}\r\n                                       onChange={this.onChangeRotation} unitConversion={180 / Math.PI}/>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <Vector3Editor name=\"Scale\" x={this.props.object3d.scale.x}\r\n                                       y={this.props.object3d.scale.y} z={this.props.object3d.scale.z}\r\n                                       onChange={this.onChangeScale}/>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {ColorResult, SketchPicker} from \"react-color\";\r\nimport {Vector4} from \"three\";\r\nimport \"./ColorEditor.scss\";\r\n\r\ninterface ColorEditorProps {\r\n    color: Vector4;\r\n    onChange: (color: Vector4) => void;\r\n}\r\n\r\nfunction ConvertToColor(color: Vector4) {\r\n    return `rgba(${((color.x * 255) | 0)},${((color.y * 255) | 0)},${((color.z * 255) | 0)},${color.w})`;\r\n}\r\n\r\nexport const ColorEditor: React.FC<ColorEditorProps> = (props) => {\r\n    const [open, setOpen] = React.useState(false);\r\n\r\n    const togglePicker = () => {\r\n        setOpen(!open);\r\n    };\r\n\r\n    const closePicker = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    const colorChange = (colorResult: ColorResult) => {\r\n        const color = new Vector4();\r\n        color.x = Math.min(255, colorResult.rgb.r) / 255;\r\n        color.y = Math.min(255, colorResult.rgb.g) / 255;\r\n        color.z = Math.min(255, colorResult.rgb.b) / 255;\r\n        color.w = colorResult.rgb.a!;\r\n        onChange(color);\r\n    };\r\n\r\n    const {color, onChange} = props;\r\n\r\n    return (\r\n        <div className=\"color-editor\">\r\n            <button style={{backgroundColor: ConvertToColor(color), height: '20px'}} onClick={togglePicker}/>\r\n            {ConvertToColor(color)}\r\n            {\r\n                open ? <div className=\"popover\">\r\n                    <div className=\"cover\" onClick={closePicker}/>\r\n                    <SketchPicker\r\n                        color={{\r\n                            r: ((color.x * 255) | 0),\r\n                            g: ((color.y * 255) | 0),\r\n                            b: ((color.z * 255) | 0),\r\n                            a: color.w\r\n                        }}\r\n                        onChange={colorChange}/>\r\n                </div> : null\r\n            }\r\n        </div>);\r\n};\r\n","import React from \"react\";\r\n\r\nfunction interp(a: number, b: number, x: number) {\r\n    return a * (1 - x) + b * x;\r\n}\r\n\r\nexport interface TransformProps {\r\n    xFrom: number;\r\n    yFrom: number;\r\n    xTo: number;\r\n    yTo: number;\r\n}\r\n\r\nexport class TransformComponent<T extends TransformProps = TransformProps, K = {}> extends React.Component<T, K> {\r\n\r\n    x = (value: number) => interp(this.props.xFrom, this.props.xTo, value);\r\n    y = (value: number) => interp(this.props.yFrom, this.props.yTo, value);\r\n\r\n    shouldComponentUpdate(nextProps: TransformProps) {\r\n        const { xFrom, yFrom, xTo, yTo } = this.props;\r\n        return (\r\n            nextProps.xFrom !== xFrom ||\r\n            nextProps.yFrom !== yFrom ||\r\n            nextProps.xTo !== xTo ||\r\n            nextProps.yTo !== yTo\r\n        );\r\n    }\r\n}","import React from \"react\";\r\nimport {TransformComponent, TransformProps} from \"./TransformComponent\";\r\nimport {Bezier} from \"three.quarks\";\r\n\r\nexport interface CurveProps extends TransformProps {\r\n    curveColor: string;\r\n    curveWidth: number;\r\n    value: Bezier;\r\n}\r\n\r\nexport class CurveComponent extends TransformComponent<CurveProps> {\r\n    shouldComponentUpdate(nextProps: CurveProps) {\r\n        if (super.shouldComponentUpdate(nextProps)) return true;\r\n        const {\r\n            curveColor,\r\n            curveWidth,\r\n            value\r\n        } = this.props;\r\n        const [p0, p1, p2, p3] = value.p;\r\n        return nextProps.curveColor !== curveColor ||\r\n            nextProps.curveWidth !== curveWidth ||\r\n            nextProps.value !== value;\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            curveColor,\r\n            curveWidth,\r\n            value\r\n        } = this.props;\r\n        const {x, y} = this;\r\n\r\n        const segments = Math.floor((x(1) - x(0)) / 5);\r\n\r\n        let curve = `M${x(0)},${y(value.genValue(0))} `;\r\n        if (segments > 0) {\r\n            for (let i = 1 / segments; i <= 1; i += 1 / segments) {\r\n                curve += `L${x(i)},${y(value.genValue(i))} `;\r\n            }\r\n        }\r\n        curve += `L${x(1)},${y(value.genValue(1))} `;\r\n\r\n        return (<path\r\n            fill=\"none\"\r\n            stroke={curveColor}\r\n            strokeWidth={curveWidth}\r\n            d={curve} />);\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport {TransformComponent, TransformProps} from \"./TransformComponent\";\r\n\r\ninterface HandleProps extends TransformProps {\r\n    handleRadius: number,\r\n    handleColor: string,\r\n    hover: boolean,\r\n    down: boolean,\r\n    background: string,\r\n    handleStroke: number,\r\n    xstart: number,\r\n    ystart: number,\r\n    xval: number,\r\n    yval: number,\r\n    onMouseEnter: (event: React.MouseEvent)=>void,\r\n    onMouseLeave: (event: React.MouseEvent)=>void,\r\n    onMouseDown: (event: React.MouseEvent)=>void,\r\n}\r\n\r\nexport class HandleComponent extends TransformComponent<HandleProps> {\r\n    shouldComponentUpdate(nextProps: HandleProps) {\r\n        if (super.shouldComponentUpdate(nextProps)) return true;\r\n        const {\r\n            xstart,\r\n            ystart,\r\n            handleRadius,\r\n            handleColor,\r\n            hover,\r\n            down,\r\n            background,\r\n            handleStroke,\r\n            xval,\r\n            yval,\r\n            onMouseEnter,\r\n            onMouseLeave,\r\n            onMouseDown\r\n        } = this.props;\r\n        return nextProps.xstart !== xstart ||\r\n            nextProps.ystart !== ystart ||\r\n            nextProps.handleRadius !== handleRadius ||\r\n            nextProps.handleColor !== handleColor ||\r\n            nextProps.hover !== hover ||\r\n            nextProps.down !== down ||\r\n            nextProps.background !== background ||\r\n            nextProps.handleStroke !== handleStroke ||\r\n            nextProps.xval !== xval ||\r\n            nextProps.yval !== yval ||\r\n            nextProps.onMouseDown !== onMouseDown ||\r\n            nextProps.onMouseLeave !== onMouseLeave ||\r\n            nextProps.onMouseEnter !== onMouseEnter;\r\n    }\r\n\r\n    render() {\r\n        const { x, y } = this;\r\n        const {\r\n            xstart,\r\n            ystart,\r\n            handleRadius,\r\n            handleColor,\r\n            hover,\r\n            down,\r\n            background,\r\n            handleStroke,\r\n            xval,\r\n            yval,\r\n            onMouseEnter,\r\n            onMouseLeave,\r\n            onMouseDown\r\n        } = this.props;\r\n\r\n        const sx = x(xstart);\r\n        const sy = y(ystart);\r\n        const cx = x(xval);\r\n        const cy = y(yval);\r\n        const a = Math.atan2(cy-sy, cx-sx);\r\n        const cxs = cx - handleRadius * Math.cos(a);\r\n        const cys = cy - handleRadius * Math.sin(a);\r\n\r\n        return <g>\r\n            <line\r\n                stroke={handleColor}\r\n                strokeWidth={hover||down ? 1 + handleStroke : handleStroke}\r\n                x1={cxs}\r\n                y1={cys}\r\n                x2={sx}\r\n                y2={sy} />\r\n            <circle\r\n                cx={cx}\r\n                cy={cy}\r\n                r={handleRadius}\r\n                stroke={handleColor}\r\n                strokeWidth={down ? 2 * handleStroke : handleStroke}\r\n                fill={down ? background: handleColor}\r\n                onMouseEnter={onMouseEnter}\r\n                onMouseLeave={onMouseLeave}\r\n                onMouseDown={onMouseDown} />\r\n        </g>;\r\n    }\r\n}","import * as React from \"react\";\r\nimport {CurveComponent} from \"./CurveComponent\";\r\nimport {PiecewiseBezier} from \"three.quarks\";\r\nimport {HandleComponent} from \"./HandleComponent\";\r\nimport {createRef} from \"react\";\r\n\r\ninterface BezierCurvesEditorProps {\r\n    value: PiecewiseBezier\r\n    onChange?: (value:PiecewiseBezier) => void,\r\n    width: number,\r\n    height: number,\r\n    padding?: Array<number>,\r\n    className?: string,\r\n    background?: string,\r\n    gridColor?: string,\r\n    curveColor?: string,\r\n    handleColor?: string,\r\n    curveWidth?: number,\r\n    handleRadius?: number,\r\n    handleStroke?: number,\r\n    readOnly?: boolean,\r\n    style?: React.CSSProperties,\r\n    pointers?: React.CSSProperties,\r\n    textStyle?: React.CSSProperties,\r\n}\r\n\r\ninterface BezierCurvesEditorState {\r\n    curve: number,\r\n    hover: number,\r\n    down: number,\r\n}\r\n\r\nexport class BezierCurvesEditor extends React.PureComponent<BezierCurvesEditorProps, BezierCurvesEditorState> {\r\n\r\n\r\n    static defaultP = {\r\n        padding: [0, 0, 0, 0],\r\n        handleRadius: 4,\r\n    }; //[25, 5, 25, 18]\r\n\r\n    constructor(props: Readonly<BezierCurvesEditorProps>) {\r\n        super(props);\r\n        this.state = {\r\n            curve: -1,\r\n            down: -1,\r\n            hover: -1,\r\n        };\r\n    }\r\n\r\n    rootRef = createRef<HTMLDivElement>();\r\n\r\n    positionForEvent = (e: React.MouseEvent) => {\r\n        if (this.rootRef.current) {\r\n            const rect = this.rootRef.current.getBoundingClientRect();\r\n            return [e.clientX - rect.left, e.clientY - rect.top];\r\n        } else {\r\n            return [0, 0];\r\n        }\r\n    };\r\n\r\n    x = (value:number) => {\r\n    };\r\n\r\n    y = (value:number) => {\r\n    };\r\n\r\n    inversex = (x:number) => {\r\n    };\r\n\r\n    inversey = (y:number) => {\r\n    };\r\n\r\n    onDownLeave = (e: React.MouseEvent) => {\r\n        if (this.state.down) {\r\n            this.onDownMove(e);\r\n            this.setState({\r\n                down: -1,\r\n                hover: -1\r\n            });\r\n        }\r\n    };\r\n    onDownMove = (e: React.MouseEvent) => {\r\n        if (this.state.down >= 0) {\r\n            e.preventDefault();\r\n            const [x, y] = this.positionForEvent(e);\r\n            const value = new PiecewiseBezier(this.props.value.functions);\r\n\r\n            const valueX = x / this.props.width;\r\n            const curveIndex = this.state.curve;\r\n            const curve = value.getFunction(curveIndex);\r\n\r\n            if (this.state.down === 0) {\r\n                const old = curve.p[0];\r\n                curve.p[0] = (this.props.height - y) / this.props.height;\r\n                curve.p[1] += curve.p[0] - old;\r\n                value.setStartX(curveIndex, x / this.props.width);\r\n                if (curveIndex - 1 >= 0) {\r\n                    const pCurve = value.getFunction(curveIndex - 1);\r\n                    pCurve.p[3] = (this.props.height - y) / this.props.height;\r\n                    pCurve.p[2] += curve.p[0] - old;\r\n                    value.setFunction(curveIndex - 1, value.getFunction(curveIndex - 1).clone());\r\n                }\r\n                value.setFunction(curveIndex, curve.clone());\r\n            }\r\n            if (this.state.down === 3) {\r\n                const old = curve.p[3];\r\n                curve.p[3] = (this.props.height - y) / this.props.height;\r\n                curve.p[2] += curve.p[3] - old;\r\n                value.setEndX(curveIndex, x / this.props.width);\r\n                if (curveIndex + 1 < value.numOfFunctions) {\r\n                    const nCurve = value.getFunction(curveIndex + 1);\r\n                    nCurve.p[0] = (this.props.height - y) / this.props.height;\r\n                    nCurve.p[1] += curve.p[3] - old;\r\n                    value.setFunction(curveIndex + 1, value.getFunction(curveIndex + 1).clone());\r\n                }\r\n                value.setFunction(curveIndex, curve.clone());\r\n            }\r\n            if (this.state.down === 1) {\r\n                curve.p[1] = (this.props.height - y) / this.props.height;\r\n                value.setFunction(curveIndex, curve.clone());\r\n            }\r\n            if (this.state.down === 2) {\r\n                curve.p[2] = (this.props.height - y) / this.props.height;\r\n                value.setFunction(curveIndex, curve.clone());\r\n            }\r\n            //value[i] = this.inversex(x);\r\n            //value[i + 1] = this.inversey(y);\r\n            if (this.props.onChange)\r\n                this.props.onChange(value);\r\n        }\r\n    };\r\n\r\n    onDownUp = () => {\r\n        // this.onDownMove(e);\r\n        this.setState({\r\n            down: -1,\r\n        });\r\n    };\r\n\r\n\r\n    onEnterHandle(curve: number, h: number) {\r\n        if (!this.state.down) {\r\n            this.setState({\r\n                hover: h,\r\n                curve: curve,\r\n            });\r\n        }\r\n    }\r\n    onDownHandle(curve: number, h: number, e: React.MouseEvent) {\r\n        e.preventDefault();\r\n        this.setState({\r\n            hover: -1,\r\n            down: h,\r\n            curve: curve,\r\n        });\r\n    }\r\n\r\n    onLeaveHandle() {\r\n        if (!this.state.down) {\r\n            this.setState({\r\n                hover: -1,\r\n            });\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        const {\r\n            width,\r\n            height,\r\n            value,\r\n            curveWidth = 1,\r\n            curveColor = \"#000\",\r\n            handleRadius = BezierCurvesEditor.defaultP.handleRadius,\r\n            handleColor = \"#f00\",\r\n            handleStroke = 1,\r\n            background = \"#fff\",\r\n        } = this.props;\r\n\r\n        const {\r\n            curve: curveIndex,\r\n            down,\r\n            hover\r\n        } = this.state;\r\n\r\n        const curves = [];\r\n        for (let i = 0; i < value.numOfFunctions; i ++) {\r\n            const x1 = value.getStartX(i);\r\n            const x2 = value.getEndX(i);\r\n            const curve = value.getFunction(i);\r\n            const slope0 = curve.getSlope(0);\r\n            const slope1 = curve.getSlope(1);\r\n\r\n            curves.push(\r\n                <g key={i}>\r\n                    <CurveComponent xFrom={x1 * width} xTo={x2 * width} yFrom={height} yTo={0}\r\n                        curveColor={curveColor} curveWidth={curveWidth} value={curve}/>\r\n                    <HandleComponent\r\n                        xFrom={x1 * width} xTo={x2 * width} yFrom={height} yTo={0}\r\n                        onMouseDown={(e)=>this.onDownHandle(i, 0, e)}\r\n                        onMouseEnter={(e)=>this.onEnterHandle(i, 0)}\r\n                        onMouseLeave={(e)=>this.onLeaveHandle()}\r\n                        xstart={0}\r\n                        ystart={curve.p[0]}\r\n                        xval={0}\r\n                        yval={curve.p[0]}\r\n                        handleRadius={handleRadius}\r\n                        handleColor={handleColor}\r\n                        down={curveIndex === i && down === 0}\r\n                        hover={curveIndex === i && hover === 0}\r\n                        handleStroke={handleStroke}\r\n                        background={background}\r\n                    />\r\n                    <HandleComponent\r\n                        xFrom={x1 * width} xTo={x2 * width} yFrom={height} yTo={0}\r\n                        onMouseDown={(e)=>this.onDownHandle(i, 1, e)}\r\n                        onMouseEnter={(e)=>this.onEnterHandle(i, 1)}\r\n                        onMouseLeave={(e)=>this.onLeaveHandle()}\r\n                        xstart={0}\r\n                        ystart={curve.p[0]}\r\n                        xval={1.0 / 3}\r\n                        yval={1.0 / 3 * slope0 + curve.p[0]}\r\n                        handleRadius={handleRadius}\r\n                        handleColor={handleColor}\r\n                        down={curveIndex === i && down === 1}\r\n                        hover={curveIndex === i && hover === 1}\r\n                        handleStroke={handleStroke}\r\n                        background={background}\r\n                    />\r\n                    <HandleComponent\r\n                        xFrom={x1 * width} xTo={x2 * width} yFrom={height} yTo={0}\r\n                        onMouseDown={(e)=>this.onDownHandle(i, 2, e)}\r\n                        onMouseEnter={(e)=>this.onEnterHandle(i, 2)}\r\n                        onMouseLeave={(e)=>this.onLeaveHandle()}\r\n                        xstart={1}\r\n                        ystart={curve.p[3]}\r\n                        xval={1 - 1.0 / 3}\r\n                        yval={curve.p[3] - 1.0 / 3 * slope1}\r\n                        handleRadius={handleRadius}\r\n                        handleColor={handleColor}\r\n                        down={curveIndex === i && down === 2}\r\n                        hover={curveIndex === i && hover === 2}\r\n                        handleStroke={handleStroke}\r\n                        background={background}\r\n                    />\r\n                    <HandleComponent\r\n                        xFrom={x1 * width} xTo={x2 * width} yFrom={height} yTo={0}\r\n                        onMouseDown={(e)=>this.onDownHandle(i, 3, e)}\r\n                        onMouseEnter={(e)=>this.onEnterHandle(i, 3)}\r\n                        onMouseLeave={(e)=>this.onLeaveHandle()}\r\n                        xstart={1}\r\n                        ystart={curve.p[3]}\r\n                        xval={1}\r\n                        yval={curve.p[3]}\r\n                        handleRadius={handleRadius}\r\n                        handleColor={handleColor}\r\n                        down={curveIndex === i && down === 3}\r\n                        hover={curveIndex === i && hover === 3}\r\n                        handleStroke={handleStroke}\r\n                        background={background}\r\n                    />\r\n                </g>);\r\n        }\r\n        return <div ref={this.rootRef}\r\n                    onMouseMove={this.onDownMove}\r\n                    onMouseUp={this.onDownUp}\r\n                    onMouseLeave={this.onDownLeave}>\r\n            <svg width={width} height={height}>\r\n                {curves}\r\n            </svg>\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from \"react\";\r\nimport {FunctionValueGenerator, ValueGenerator} from \"three.quarks\";\r\nimport {ColorGenerator, ConstantColor, FunctionColorGenerator} from \"three.quarks\";\r\nimport {ConstantValue} from \"three.quarks\";\r\nimport {Vector4} from \"three\";\r\nimport {IntervalValue} from \"three.quarks\";\r\nimport {PiecewiseBezier} from \"three.quarks\";\r\nimport {ColorRange} from \"three.quarks\";\r\nimport {RandomColor} from \"three.quarks\";\r\nimport {Gradient} from \"three.quarks\";\r\nimport {NumberInput} from \"./NumberInput\";\r\nimport {ColorEditor} from \"./ColorEditor\";\r\nimport \"./GeneratorEditor.scss\";\r\nimport {BezierCurvesEditor} from \"./bezier/BezierCurvesEditor\";\r\n\r\ntype EditorType =\r\n    'constant'\r\n    | 'intervalValue'\r\n    | 'piecewiseBezier'\r\n    | 'color'\r\n    | 'randomColor'\r\n    | 'colorRange'\r\n    | 'gradient';\r\nexport type ValueType = 'value' | 'functionValue' | 'color' | 'functionColor';\r\n\r\nconst ValueToEditor: { [a: string]: Array<EditorType> } = {\r\n    'value': ['constant', 'intervalValue'],\r\n    'functionValue': ['piecewiseBezier'],\r\n    'color': ['color', 'randomColor'],\r\n    'functionColor': ['colorRange', 'gradient'],\r\n};\r\n\r\nexport type GenericGenerator = ValueGenerator | FunctionValueGenerator | ColorGenerator | FunctionColorGenerator;\r\n\r\ninterface GeneratorEditorProps {\r\n    allowedType: Array<ValueType>;\r\n    name: string;\r\n    generator: GenericGenerator;\r\n    updateGenerator: (generator: GenericGenerator) => void;\r\n}\r\n\r\ninterface GeneratorEditorState {\r\n    open: boolean;\r\n}\r\n\r\nexport class GeneratorEditor extends React.PureComponent<GeneratorEditorProps, GeneratorEditorState> {\r\n\r\n    constructor(props: Readonly<GeneratorEditorProps>) {\r\n        super(props);\r\n        const currentEditor = ValueToEditor[props.allowedType[0]][0];\r\n        this.state = {\r\n            open: false,\r\n        }\r\n    }\r\n    changeEditor = (e: React.ChangeEvent<HTMLSelectElement>) => {\r\n        const editorType = e.target.value;\r\n        let generator: GenericGenerator | null = null;\r\n        switch(editorType) {\r\n            case \"constant\":\r\n                generator = new ConstantValue(0);\r\n                break;\r\n            case \"color\":\r\n                generator = new ConstantColor(new Vector4(1,1,1,1));\r\n                break;\r\n            case \"intervalValue\":\r\n                generator = new IntervalValue(0, 1);\r\n                break;\r\n            case \"colorRange\":\r\n                generator = new ColorRange(new Vector4(0,0,0,1), new Vector4(1,1,1,1));\r\n                break;\r\n            case \"randomColor\":\r\n                generator = new RandomColor(new Vector4(0,0,0,1), new Vector4(1,1,1,1));\r\n                break;\r\n            case \"piecewiseBezier\":\r\n                generator = new PiecewiseBezier();\r\n                break;\r\n        }\r\n        if (generator)\r\n            this.props.updateGenerator(generator);\r\n    }\r\n\r\n    changeValue = (x: number) => {\r\n        this.props.updateGenerator(new ConstantValue(x));\r\n    };\r\n\r\n    changeColor = (x: Vector4) => {\r\n        this.props.updateGenerator(new ConstantColor(x));\r\n    };\r\n\r\n    changeValueA = (x: number) => {\r\n        const interval = this.props.generator as IntervalValue;\r\n        this.props.updateGenerator(new IntervalValue(x, interval.b));\r\n    };\r\n\r\n    changeValueB = (x: number) => {\r\n        const interval = this.props.generator as IntervalValue;\r\n        this.props.updateGenerator(new IntervalValue(interval.a, x));\r\n    };\r\n\r\n    changeColorRangeA = (x: Vector4) => {\r\n        const colorRange = this.props.generator as ColorRange;\r\n        this.props.updateGenerator(new ColorRange(x, colorRange.b));\r\n    };\r\n    changeColorRangeB = (x: Vector4) => {\r\n        const colorRange = this.props.generator as ColorRange;\r\n        this.props.updateGenerator(new ColorRange(colorRange.a, x));\r\n    };\r\n    changeRandomColorA = (x: Vector4) => {\r\n        const randomColor = this.props.generator as RandomColor;\r\n        this.props.updateGenerator(new RandomColor(x, randomColor.b));\r\n    };\r\n    changeRandomColorB = (x: Vector4) => {\r\n        const randomColor = this.props.generator as RandomColor;\r\n        this.props.updateGenerator(new RandomColor(randomColor.a, x));\r\n    };\r\n\r\n    changeCurve = (x: PiecewiseBezier) => {\r\n        this.props.updateGenerator(new PiecewiseBezier(x.functions));\r\n    }\r\n\r\n    getEditorType(generator: GenericGenerator): EditorType {\r\n        if (generator instanceof ConstantValue) {\r\n            return 'constant';\r\n        } else if (generator instanceof IntervalValue) {\r\n            return 'intervalValue';\r\n        } else if (generator instanceof PiecewiseBezier) {\r\n            return 'piecewiseBezier';\r\n        } else if (generator instanceof ConstantColor) {\r\n            return 'color';\r\n        } else if (generator instanceof RandomColor) {\r\n            return 'randomColor';\r\n        } else if (generator instanceof ColorRange) {\r\n            return 'colorRange';\r\n        } else if (generator instanceof Gradient) {\r\n            return 'gradient';\r\n        }\r\n        return 'constant';\r\n    }\r\n\r\n    render() {\r\n        console.log('render GeneratorEditor');\r\n        const {name, generator, allowedType} = this.props;\r\n\r\n        const editorTypes = [];\r\n        for (const valueType of allowedType) {\r\n            for (const editorType of ValueToEditor[valueType]) {\r\n                editorTypes.push(editorType);\r\n            }\r\n        }\r\n\r\n        const currentEditor = this.getEditorType(generator);\r\n        console.log(currentEditor);\r\n\r\n        let editor;\r\n        switch (currentEditor) {\r\n            case \"constant\":\r\n                editor = <React.Fragment>\r\n                    <NumberInput value={(generator as ConstantValue).value}\r\n                                 onChange={this.changeValue}/></React.Fragment>;\r\n                break;\r\n            case \"color\":\r\n                editor = (<React.Fragment>\r\n                    <ColorEditor color={(generator as ConstantColor).color} onChange={this.changeColor}/>\r\n                </React.Fragment>);\r\n                break;\r\n            case \"intervalValue\":\r\n                editor = <React.Fragment>\r\n                    <NumberInput value={(generator as IntervalValue).a}\r\n                                 onChange={this.changeValueA}/>-<NumberInput\r\n                    value={(generator as IntervalValue).b} onChange={this.changeValueB}/></React.Fragment>;\r\n                break;\r\n            case \"piecewiseBezier\":\r\n                editor = <React.Fragment>\r\n                    <BezierCurvesEditor height={40} width={240} value={(generator as PiecewiseBezier)} onChange={this.changeCurve}/>\r\n                </React.Fragment>;\r\n                break;\r\n            case \"colorRange\":\r\n                editor = (<React.Fragment>\r\n                    <ColorEditor color={(generator as ColorRange).a} onChange={this.changeColorRangeA}/>-\r\n                    <ColorEditor color={(generator as ColorRange).b} onChange={this.changeColorRangeB}/>\r\n                </React.Fragment>);\r\n                break;\r\n            case \"randomColor\":\r\n                editor = (<React.Fragment>\r\n                    <ColorEditor color={(generator as RandomColor).a} onChange={this.changeRandomColorA}/>-\r\n                    <ColorEditor color={(generator as RandomColor).b} onChange={this.changeRandomColorB}/>\r\n                </React.Fragment>);\r\n                break;\r\n        }\r\n        return <div className=\"property\">\r\n            <label className=\"name\">{name}</label>\r\n            {editor}\r\n            <select className=\"editor-select\" onChange={this.changeEditor} value={currentEditor}>\r\n                {editorTypes.map(editorType => <option key={editorType} value={editorType}>{editorType}</option>)}\r\n            </select>\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from \"react\";\r\nimport {ApplicationContextConsumer} from \"./ApplicationContext\";\r\nimport {GeneratorEditor, GenericGenerator, ValueType} from \"./editors/GeneratorEditor\";\r\nimport {ParticleSystem} from \"three.quarks\";\r\nimport {FunctionValueGenerator, ValueGenerator} from \"three.quarks\";\r\nimport {ColorGenerator, FunctionColorGenerator} from \"three.quarks\";\r\n\r\ninterface ParticleSystemPropertiesProps {\r\n    particleSystem: ParticleSystem,\r\n    updateProperties: Function,\r\n}\r\n\r\ninterface ParticleSystemPropertiesState {\r\n\r\n}\r\n\r\nexport class ParticleSystemProperties extends React.PureComponent<ParticleSystemPropertiesProps, ParticleSystemPropertiesState> {\r\n    constructor(props: Readonly<ParticleSystemPropertiesProps>) {\r\n        super(props);\r\n    }\r\n    onChangeStartSpeed = (g: GenericGenerator) => {\r\n        console.log(\"change start speed\");\r\n        this.props.particleSystem.startSpeed = g as ValueGenerator | FunctionValueGenerator;\r\n        this.props.updateProperties();\r\n    };\r\n    onChangeStartLife = (g: GenericGenerator) => {\r\n        console.log(\"change start life\");\r\n        this.props.particleSystem.startLife = g as ValueGenerator | FunctionValueGenerator;\r\n        this.props.updateProperties();\r\n    };\r\n    onChangeStartSize = (g: GenericGenerator) => {\r\n        console.log(\"change start size\");\r\n        this.props.particleSystem.startSize = g as ValueGenerator | FunctionValueGenerator;\r\n        this.props.updateProperties();\r\n    };\r\n    onChangeStartColor = (g: GenericGenerator) => {\r\n        console.log(\"change start color\");\r\n        this.props.particleSystem.startColor = g as ColorGenerator | FunctionColorGenerator;\r\n        this.props.updateProperties();\r\n    };\r\n    OnChangeStartRotation = (g: GenericGenerator) => {\r\n        console.log(\"change start rotation\");\r\n        this.props.particleSystem.startRotation = g as ValueGenerator | FunctionValueGenerator;\r\n        this.props.updateProperties();\r\n    };\r\n    OnChangeEmissionOverTime = (g: GenericGenerator) => {\r\n        console.log(\"change start rotation\");\r\n        this.props.particleSystem.emissionOverTime = g as ValueGenerator | FunctionValueGenerator;\r\n        this.props.updateProperties();\r\n    };\r\n\r\n    render() {\r\n        console.log('rendered objectProperties');\r\n        const valueFunctionTypes = ['value', 'functionValue'] as Array<ValueType>;\r\n        const colorValueFunctionTypes = ['color', 'functionColor'] as Array<ValueType>;\r\n        return (\r\n            <div>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <GeneratorEditor name=\"Start Life\"\r\n                                         allowedType={valueFunctionTypes}\r\n                                         generator={this.props.particleSystem.startLife}\r\n                                         updateGenerator={this.onChangeStartLife}/>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <GeneratorEditor name=\"Start Size\"\r\n                                         allowedType={valueFunctionTypes}\r\n                                         generator={this.props.particleSystem.startSize}\r\n                                         updateGenerator={this.onChangeStartSize}/>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <GeneratorEditor name=\"Start Speed\"\r\n                                         allowedType={valueFunctionTypes}\r\n                                         generator={this.props.particleSystem.startSpeed}\r\n                                         updateGenerator={this.onChangeStartSpeed}/>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <GeneratorEditor name=\"Start Color\"\r\n                                         allowedType={colorValueFunctionTypes}\r\n                                         generator={this.props.particleSystem.startColor}\r\n                                         updateGenerator={this.onChangeStartColor}/>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <GeneratorEditor name=\"Start Rotation\"\r\n                                         allowedType={valueFunctionTypes}\r\n                                         generator={this.props.particleSystem.startRotation}\r\n                                         updateGenerator={this.OnChangeStartRotation}/>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <GeneratorEditor name=\"Emission Over Time\"\r\n                                         allowedType={valueFunctionTypes}\r\n                                         generator={this.props.particleSystem.emissionOverTime}\r\n                                         updateGenerator={this.OnChangeEmissionOverTime}/>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import * as React from \"react\";\r\n\r\n\r\ninterface FileInputProps {\r\n    fileName: string\r\n    onChange: (files: FileList) => void;\r\n}\r\n\r\nexport class FileInput extends React.Component<FileInputProps>\r\n{\r\n    constructor(props: any)\r\n    {\r\n        super(props);\r\n    }\r\n\r\n    handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (e.target.files)\r\n            this.props.onChange(e.target.files);\r\n    };\r\n\r\n    render ()\r\n    {\r\n        return <div>\r\n            <input type=\"file\" onChange={this.handleChange} />\r\n            {this.props.fileName}\r\n        </div>;\r\n    }\r\n}","import * as React from \"react\";\r\nimport {AdditiveBlending, Blending, NormalBlending, Texture} from \"three\";\r\nimport {ApplicationContextConsumer} from \"./ApplicationContext\";\r\nimport {GeneratorEditor, GenericGenerator, ValueType} from \"./editors/GeneratorEditor\";\r\nimport {ParticleSystem} from \"three.quarks\";\r\nimport {NumberInput} from \"./editors/NumberInput\";\r\nimport {FileInput} from \"./editors/FileInput\";\r\n\r\n\r\ninterface ParticleRendererPropertiesProps {\r\n    particleSystem: ParticleSystem,\r\n    updateProperties: Function,\r\n}\r\n\r\ninterface ParticleRendererPropertiesState {\r\n\r\n}\r\n\r\nexport class ParticleRendererProperties extends React.PureComponent<ParticleRendererPropertiesProps, ParticleRendererPropertiesState> {\r\n    constructor(props: Readonly<ParticleRendererPropertiesProps>) {\r\n        super(props);\r\n    }\r\n\r\n    onChangeTexture = (files: FileList) => {\r\n        console.log(\"change texture\");\r\n        const image = document.createElement( 'img' );\r\n        const texture = new Texture( image );\r\n        image.onload = function()  {\r\n            texture.needsUpdate = true;\r\n        };\r\n\r\n        if (files && files[0]) {\r\n            const reader = new FileReader();\r\n            reader.onload = function (e) {\r\n                image.src = reader.result as string;\r\n            };\r\n            reader.readAsDataURL(files[0]);\r\n        }\r\n        this.props.particleSystem.texture = texture;\r\n        this.props.updateProperties();\r\n    };\r\n    onChangeStartTile = (index: number) => {\r\n        this.props.particleSystem.startTileIndex = index;\r\n        this.props.updateProperties();\r\n    };\r\n    onChangeUTileCount = (u: number) => {\r\n        this.props.particleSystem.uTileCount = u;\r\n        this.props.updateProperties();\r\n    };\r\n    onChangeVTileCount = (v: number) => {\r\n        this.props.particleSystem.vTileCount = v;\r\n        this.props.updateProperties();\r\n    };\r\n    onChangeBlending = (e: React.ChangeEvent<HTMLSelectElement>) => {\r\n        console.log(e.target.value);\r\n        switch (e.target.value) {\r\n            case \"Normal\":\r\n                this.props.particleSystem.blending = NormalBlending;\r\n                this.props.particleSystem.emitter.material.blending = NormalBlending;\r\n                break;\r\n            case \"Additive\":\r\n                this.props.particleSystem.blending = AdditiveBlending;\r\n                this.props.particleSystem.emitter.material.blending = AdditiveBlending;\r\n                break;\r\n        }\r\n        this.props.updateProperties();\r\n    }\r\n\r\n    getValueOfBlending = (blending: Blending) => {\r\n        switch (blending) {\r\n            case NormalBlending:\r\n                return \"Normal\"\r\n            case AdditiveBlending:\r\n                return \"Additive\";\r\n        }\r\n    }\r\n\r\n    render() {\r\n        console.log('rendered particleRendererProperties');\r\n        return (\r\n            <div>\r\n\r\n                texture?: Texture;\r\n                blending?: Blending;\r\n                worldSpace?: boolean;\r\n\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <div className=\"property\">\r\n                            <label className=\"name\">Blend Mode</label>\r\n                            <select className=\"editor-select\" onChange={this.onChangeBlending} value={this.getValueOfBlending(this.props.particleSystem.blending)}>\r\n                                <option key={0} value=\"Normal\" >Normal</option>\r\n                                <option key={1} value=\"Additive\" >Additive</option>\r\n                            </select>\r\n                        </div>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <div className=\"property\">\r\n                            <label className=\"name\">UVTile</label>\r\n                            <label>Column:</label><NumberInput value={this.props.particleSystem.uTileCount} onChange={this.onChangeUTileCount}/>\r\n                            <label>Row:</label><NumberInput value={this.props.particleSystem.vTileCount} onChange={this.onChangeVTileCount}/>\r\n                        </div>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <div className=\"property\">\r\n                            <label className=\"name\">Start Tile Index</label><NumberInput value={this.props.particleSystem.startTileIndex} onChange={this.onChangeStartTile}/>\r\n                        </div>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <div className=\"property\">\r\n                            <label className=\"name\">Texture</label>\r\n                            <FileInput fileName={this.props.particleSystem.texture? this.props.particleSystem.texture.name: \"..\"} onChange={this.onChangeTexture} />\r\n                        </div>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport Editor from 'react-simple-code-editor';\r\nimport { highlight, languages } from 'prismjs';\r\nimport \"./ScriptEditor.scss\";\r\n\r\ninterface ScriptEditorProps{\r\n    value: string;\r\n    onChange: (value: string)=>void;\r\n}\r\n\r\nexport const ScriptEditor : React.FC<ScriptEditorProps> = (props) => {\r\n\r\n    const [inputValue, setInputValue] = React.useState(props.value);\r\n    const [focus, setFocus] = React.useState(false);\r\n\r\n    const onInputChange = (value: string) => {\r\n        if (focus) {\r\n            setInputValue(value);\r\n        }\r\n    };\r\n\r\n    const onInputBlur = (e: React.FocusEvent) => {\r\n        if (inputValue !== props.value)\r\n            props.onChange(inputValue);\r\n        setFocus(false);\r\n    };\r\n\r\n    const onInputFocus = (e: React.FocusEvent) => {\r\n        if (inputValue !== props.value) {\r\n            setInputValue(props.value);\r\n        }\r\n        setFocus(true);\r\n    };\r\n\r\n    const onKeyDown = (e: React.KeyboardEvent) => {\r\n        if (e.key === 'Enter') {\r\n            if (inputValue !== props.value)\r\n                props.onChange(inputValue);\r\n        }\r\n    };\r\n\r\n    return(\r\n        <Editor\r\n            value={focus? inputValue: props.value}\r\n            onValueChange={onInputChange}\r\n            highlight={code => highlight(code, languages.javascript, \"javascript\")}\r\n            padding={10}\r\n            onBlur={onInputBlur} onFocus={onInputFocus} //onKeyDown={onKeyDown}\r\n            style={{\r\n                fontFamily: '\"Consolas\", monospace',\r\n                fontSize: 12,\r\n            }}\r\n        />);\r\n};\r\n","import * as React from \"react\";\r\nimport {Euler, Object3D, Vector3} from \"three\";\r\nimport {Vector3Editor} from \"./editors/Vector3Editor\";\r\nimport {ApplicationContextConsumer} from \"./ApplicationContext\";\r\nimport {StringInput} from \"./editors/StringInput\";\r\nimport {ScriptEditor} from \"./editors/ScriptEditor\";\r\n\r\ninterface ScriptPropertiesProps {\r\n    object3d: Object3D,\r\n    updateProperties: Function,\r\n}\r\n\r\ninterface ScriptPropertiesState {\r\n\r\n}\r\n\r\nexport class ScriptProperties extends React.PureComponent<ScriptPropertiesProps, ScriptPropertiesState> {\r\n    constructor(props: Readonly<ScriptPropertiesProps>) {\r\n        super(props);\r\n    }\r\n\r\n    onChangeScript = (script: string) => {\r\n        if (this.props.object3d.userData === null) {\r\n            this.props.object3d.userData = {};\r\n        }\r\n        this.props.object3d.userData.script = script;\r\n        this.props.object3d.userData.func = new Function(\"delta\", script);\r\n        this.props.updateProperties();\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <div className=\"property\">\r\n                        <label className=\"script\">Script:</label>\r\n                        <ScriptEditor value={this.props.object3d.userData.script || \"\"} onChange={this.onChangeScript}/>\r\n                        </div>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import {Blending, Texture} from \"three\";\r\nimport {ApplicationContextConsumer} from \"./ApplicationContext\";\r\nimport {GeneratorEditor, GenericGenerator, ValueType} from \"./editors/GeneratorEditor\";\r\nimport {ConeEmitter, DonutEmitter, EmitterShape, ParticleSystem, PointEmitter, SphereEmitter} from \"three.quarks\";\r\nimport {NumberInput} from \"./editors/NumberInput\";\r\nimport {FileInput} from \"./editors/FileInput\";\r\nimport React, {ChangeEvent} from \"react\";\r\n\r\n\r\ninterface EmitterShapePropertiesProps {\r\n    particleSystem: ParticleSystem,\r\n    updateProperties: Function,\r\n}\r\n\r\ninterface EmitterShapePropertiesState {\r\n\r\n}\r\n\r\nexport class EmitterShapeProperties extends React.PureComponent<EmitterShapePropertiesProps, EmitterShapePropertiesState> {\r\n    constructor(props: Readonly<EmitterShapePropertiesProps>) {\r\n        super(props);\r\n    }\r\n\r\n    getValueOfShape = (shape: EmitterShape) => {\r\n        if (this.props.particleSystem.emitterShape instanceof PointEmitter) {\r\n            return \"PointEmitter\";\r\n        } else if (this.props.particleSystem.emitterShape instanceof ConeEmitter) {\r\n            return \"ConeEmitter\";\r\n        } else if (this.props.particleSystem.emitterShape instanceof SphereEmitter) {\r\n            return \"SphereEmitter\";\r\n        } else if (this.props.particleSystem.emitterShape instanceof DonutEmitter) {\r\n            return \"DonutEmitter\";\r\n        } else\r\n            return \"\";\r\n    };\r\n\r\n    onChangeShape = (e: ChangeEvent<HTMLSelectElement>) => {\r\n        switch (e.target.value) {\r\n            case \"PointEmitter\":\r\n                if (!(this.props.particleSystem.emitterShape instanceof PointEmitter)) {\r\n                    this.props.particleSystem.emitterShape = new PointEmitter();\r\n                    this.props.updateProperties();\r\n                }\r\n                break;\r\n            case \"ConeEmitter\":\r\n                if (!(this.props.particleSystem.emitterShape instanceof ConeEmitter)) {\r\n                    this.props.particleSystem.emitterShape = new ConeEmitter();\r\n                    this.props.updateProperties();\r\n                }\r\n                break;\r\n            case \"SphereEmitter\":\r\n                if (!(this.props.particleSystem.emitterShape instanceof SphereEmitter)) {\r\n                    this.props.particleSystem.emitterShape = new SphereEmitter();\r\n                    this.props.updateProperties();\r\n                }\r\n                break;\r\n            case \"DonutEmitter\":\r\n                if (!(this.props.particleSystem.emitterShape instanceof DonutEmitter)) {\r\n                    this.props.particleSystem.emitterShape = new DonutEmitter();\r\n                    this.props.updateProperties();\r\n                }\r\n                break;\r\n        }\r\n    };\r\n\r\n    onChangeKeyValue = (k: string, v: number) => {\r\n        (this.props.particleSystem.emitterShape as any)[k] = v;\r\n        this.props.updateProperties();\r\n    };\r\n\r\n    renderShapeProperties() {\r\n        const properties = [];\r\n        for (const key in this.props.particleSystem.emitterShape) {\r\n            properties.push(\r\n                <div key={key} className=\"property\">\r\n                    <label className=\"name\">{key}:</label>\r\n                    <NumberInput value={(this.props.particleSystem.emitterShape as any)[key]} onChange={(value) => this.onChangeKeyValue(key, value)}/>\r\n                </div>\r\n            );\r\n        }\r\n        return properties;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                        <div className=\"property\">\r\n                            <label className=\"name\">Shape</label>\r\n                            <select className=\"editor-select\" onChange={this.onChangeShape} value={this.getValueOfShape(this.props.particleSystem.emitterShape)}>\r\n                                <option key={0} value=\"PointEmitter\" >PointEmitter</option>\r\n                                <option key={1} value=\"ConeEmitter\" >ConeEmitter</option>\r\n                                <option key={2} value=\"SphereEmitter\" >SphereEmitter</option>\r\n                                <option key={3} value=\"DonutEmitter\" >DonutEmitter</option>\r\n                            </select>\r\n                        </div>\r\n                    }\r\n                </ApplicationContextConsumer>\r\n                <ApplicationContextConsumer>\r\n                    {context => context && this.renderShapeProperties()}\r\n                </ApplicationContextConsumer>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import * as React from \"react\";\r\nimport {ApplicationContextConsumer} from \"./ApplicationContext\";\r\nimport {\r\n    ParticleSystem,\r\n    ParticleEmitter\r\n} from \"three.quarks\";\r\nimport {Object3D} from \"three\";\r\nimport {ButtonGroup} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ToggleButtonGroup from '@material-ui/lab/ToggleButtonGroup';\r\n\r\ninterface ParticleSystemControllerProps {\r\n    object3d: Object3D,\r\n    updateProperties: Function,\r\n}\r\n\r\ninterface ParticleSystemControllerState {\r\n\r\n}\r\n\r\nexport class ParticleSystemController extends React.PureComponent<ParticleSystemControllerProps, ParticleSystemControllerState> {\r\n    constructor(props: Readonly<ParticleSystemControllerProps>) {\r\n        super(props);\r\n    }\r\n\r\n    getSystems = () => {\r\n        const systems: Array<ParticleSystem> = [];\r\n        if (this.props.object3d instanceof ParticleEmitter) {\r\n            systems.push(this.props.object3d.system);\r\n        }\r\n        this.props.object3d.traverse(object => {\r\n            if (object instanceof ParticleEmitter) {\r\n                systems.push(object.system);\r\n            }\r\n        });\r\n        return systems;\r\n    };\r\n\r\n    checkPause = (systems: Array<ParticleSystem>) => {\r\n        let paused = true;\r\n        systems.forEach(system => {\r\n            if (!system.paused) {\r\n                paused = false;\r\n            }\r\n        });\r\n        return paused;\r\n    };\r\n\r\n    togglePause = () => {\r\n        const systems: Array<ParticleSystem> = this.getSystems();\r\n        const paused = this.checkPause(systems);\r\n\r\n        if (paused) {\r\n            systems.forEach(system => {\r\n                system.play();\r\n            });\r\n        } else {\r\n            systems.forEach(system => {\r\n                system.pause();\r\n            });\r\n        }\r\n        this.props.updateProperties();\r\n    };\r\n\r\n    onRestart = () => {\r\n        this.getSystems().forEach((system) => {\r\n            system.restart();\r\n        });\r\n        this.props.updateProperties();\r\n    };\r\n\r\n    onStop = () => {\r\n        this.getSystems().forEach((system) => {\r\n            system.restart();\r\n            system.pause();\r\n        });\r\n        this.props.updateProperties();\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <ToggleButtonGroup color=\"primary\" aria-label=\"primary button group\">\r\n                </ToggleButtonGroup>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                    <ButtonGroup color=\"primary\" aria-label=\"primary button group\">\r\n                        <Button disabled={!this.checkPause(this.getSystems())} onClick={this.togglePause}>Play</Button>\r\n                        <Button disabled={this.checkPause(this.getSystems())} onClick={this.togglePause}>Pause</Button>\r\n                        <Button onClick={this.onRestart}>Restart</Button>\r\n                        <Button onClick={this.onStop}>Stop</Button>\r\n                    </ButtonGroup>}\r\n                </ApplicationContextConsumer>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import * as React from \"react\";\r\nimport {ApplicationContextConsumer, ApplicationContextProvider} from \"./ApplicationContext\";\r\nimport {GeneratorEditor, GenericGenerator, ValueType} from \"./editors/GeneratorEditor\";\r\nimport {\r\n    Behavior,\r\n    ColorOverLife,\r\n    FrameOverLife,\r\n    OrbitOverLife,\r\n    ParticleSystem,\r\n    RotationOverLife,\r\n    SizeOverLife\r\n} from \"three.quarks\";\r\nimport {FunctionValueGenerator, ValueGenerator} from \"three.quarks\";\r\nimport {ColorGenerator, FunctionColorGenerator} from \"three.quarks\";\r\nimport {ListItem, List, Theme, createStyles, Typography, Toolbar, ListItemIcon} from \"@material-ui/core\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport ButtonGroup from \"@material-ui/core/ButtonGroup\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport {memo} from \"react\";\r\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\r\n\r\ninterface BehaviorsPropertiesProps {\r\n    behaviors: Array<Behavior>,\r\n    updateProperties: Function,\r\n}\r\n\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            width: '100%',\r\n        },\r\n        listRoot: {\r\n            width: '100%',\r\n            backgroundColor: theme.palette.background.paper,\r\n        }\r\n    }),\r\n);\r\n\r\n/*\r\n<GeneratorEditor name=\"Start Speed\"\r\n                 allowedType={valueFunctionTypes}\r\n                 generator={this.props.particleSystem.startSpeed}\r\n                 updateGenerator={this.onChangeStartSpeed}/>*/\r\n\r\nfunction BehaviorsPropertiesFunc(props: BehaviorsPropertiesProps) {\r\n    const classes = useStyles();\r\n    const [checked, setChecked] = React.useState([0, 1, 2, 3]);\r\n    const [selectedIndex, setSelectedIndex] = React.useState(1);\r\n    const handleListItemClick = (event: any, index: number) => {\r\n        setSelectedIndex(index);\r\n    };\r\n\r\n    const handleToggle = (value: number) => () => {\r\n        const currentIndex = checked.indexOf(value);\r\n        const newChecked = [...checked];\r\n\r\n        if (currentIndex === -1) {\r\n            newChecked.push(value);\r\n        } else {\r\n            newChecked.splice(currentIndex, 1);\r\n        }\r\n\r\n        setChecked(newChecked);\r\n    };\r\n\r\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n    const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n        setAnchorEl(event.currentTarget);\r\n    };\r\n    const handleClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n\r\n    const onChangeBehaviorFunc = (index: number) => (generator: GenericGenerator) => {\r\n        const behavior = props.behaviors[index];\r\n        switch (behavior.type) {\r\n            case 'ColorOverLife':\r\n                (behavior as ColorOverLife).func = generator as FunctionColorGenerator;\r\n                break;\r\n            case 'RotationOverLife':\r\n                (behavior as RotationOverLife).angularVelocityFunc = generator as FunctionValueGenerator | ValueGenerator;\r\n                break;\r\n            case 'SizeOverLife':\r\n                (behavior as SizeOverLife).func = generator as FunctionValueGenerator;\r\n                break;\r\n            case 'FrameOverLife':\r\n                (behavior as FrameOverLife).func = generator as FunctionValueGenerator;\r\n                break;\r\n            case 'OrbitOverLife':\r\n                (behavior as OrbitOverLife).angularVelocityFunc = generator as FunctionValueGenerator | ValueGenerator;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        console.log(\"changing\")\r\n        props.updateProperties();\r\n    }\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <ButtonGroup color=\"primary\" aria-label=\"primary button group\">\r\n                <Button color=\"inherit\" aria-controls=\"simple-menu\"\r\n                        aria-haspopup=\"true\" onClick={handleClick} id=\"new-button\">\r\n                    New\r\n                </Button>\r\n                <Menu\r\n                    id=\"simple-menu\"\r\n                    anchorEl={anchorEl}\r\n                    keepMounted\r\n                    open={Boolean(anchorEl)}\r\n                    onClose={handleClose}\r\n                >\r\n                    <MenuItem onClick={handleClose}>SizeOverLife</MenuItem>\r\n                    <MenuItem onClick={handleClose}>ColorOverLife</MenuItem>\r\n                    <MenuItem onClick={handleClose}>RotationOverLife</MenuItem>\r\n                    <MenuItem onClick={handleClose}>FrameOverLife</MenuItem>\r\n                    <MenuItem onClick={handleClose}>OrbitOverLife</MenuItem>\r\n                </Menu>\r\n                <Button>Remove</Button>\r\n            </ButtonGroup>\r\n            <List dense className={classes.listRoot}>\r\n                <ApplicationContextConsumer>\r\n                    {context => context &&\r\n                    props.behaviors.map((behavior, index) => {\r\n                        const labelId = `behavior-list-label-${index}`;\r\n                        let valueTypes: Array<ValueType>;\r\n                        let func: FunctionColorGenerator | FunctionValueGenerator | ValueGenerator | null = null;\r\n                        switch (behavior.type) {\r\n                            case 'ColorOverLife':\r\n                                valueTypes = ['functionColor'];\r\n                                func = (behavior as ColorOverLife).func;\r\n                                break;\r\n                            case 'RotationOverLife':\r\n                                valueTypes = ['functionValue', 'value'];\r\n                                func = (behavior as RotationOverLife).angularVelocityFunc;\r\n                                break;\r\n                            case 'SizeOverLife':\r\n                                valueTypes = ['functionValue'];\r\n                                func = (behavior as SizeOverLife).func;\r\n                                break;\r\n                            case 'FrameOverLife':\r\n                                valueTypes = ['functionValue'];\r\n                                func = (behavior as FrameOverLife).func;\r\n                                break;\r\n                            case 'OrbitOverLife':\r\n                                valueTypes = ['functionValue'];\r\n                                func = (behavior as OrbitOverLife).angularVelocityFunc;\r\n                                break;\r\n                            default:\r\n                                valueTypes = ['functionValue'];\r\n                                break;\r\n                        }\r\n\r\n                        let editor;\r\n                        if (func) {\r\n                            editor = <GeneratorEditor name=\"Func\"\r\n                                                      allowedType={valueTypes}\r\n                                                      generator={func!}\r\n                                                      updateGenerator={onChangeBehaviorFunc(index)}/>;\r\n                        }\r\n\r\n                        return (\r\n                            <ListItem key={index}\r\n                                      selected={selectedIndex === index}\r\n                                      onClick={(event) => handleListItemClick(event, index)}>\r\n                                <ListItemIcon>\r\n                                    <Checkbox\r\n                                        edge=\"end\"\r\n                                        onChange={handleToggle(index)}\r\n                                        checked={checked.indexOf(index) !== -1}\r\n                                        inputProps={{'aria-labelledby': labelId}}\r\n                                    />\r\n                                </ListItemIcon>\r\n                                <ListItemText id={labelId} primary={behavior.type}\r\n                                              secondary={editor}/>\r\n                            </ListItem>\r\n                        );\r\n                    })\r\n                }\r\n                </ApplicationContextConsumer>\r\n            </List>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport const BehaviorsProperties = React.memo(BehaviorsPropertiesFunc);","import * as React from \"react\";\r\nimport {ConstantValue} from \"three.quarks\";\r\nimport {FunctionValueGenerator, ValueGenerator} from \"three.quarks\";\r\nimport {ColorGenerator, ConstantColor, FunctionColorGenerator} from \"three.quarks\";\r\nimport {Object3D, Vector4} from \"three\";\r\nimport {ObjectProperties} from \"./ObjectProperties\";\r\nimport {ApplicationContextConsumer} from \"./ApplicationContext\";\r\nimport {ParticleEmitter} from \"three.quarks\";\r\nimport {ParticleSystemProperties} from \"./ParticleSystemProperties\";\r\nimport {ParticleRendererProperties} from \"./ParticleRendererProperties\";\r\nimport {ScriptProperties} from \"./ScriptProperties\";\r\nimport {EmitterShapeProperties} from \"./EmitterShapeProperties\";\r\nimport {ParticleSystemController} from \"./ParticleSystemController\";\r\nimport {createStyles, makeStyles, Theme} from \"@material-ui/core\";\r\nimport MuiAccordionSummary from \"@material-ui/core/AccordionSummary\";\r\nimport MuiAccordion from \"@material-ui/core/Accordion\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\r\nimport \"./PropertiesEditor.scss\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {BehaviorsProperties} from \"./BehaviorsProperties\";\r\n\r\nconst Accordion = withStyles({\r\n    root: {\r\n        border: '1px solid rgba(0, 0, 0, .125)',\r\n        boxShadow: 'none',\r\n        '&:not(:last-child)': {\r\n            borderBottom: 0,\r\n        },\r\n        '&:before': {\r\n            display: 'none',\r\n        },\r\n        '&$expanded': {\r\n            margin: 'auto',\r\n        },\r\n    },\r\n    expanded: {},\r\n})(MuiAccordion);\r\n\r\nconst AccordionSummary = withStyles({\r\n    root: {\r\n        backgroundColor: 'rgba(0, 0, 0, .03)',\r\n        borderBottom: '1px solid rgba(0, 0, 0, .125)',\r\n        marginBottom: -1,\r\n        minHeight: 32,\r\n        '&$expanded': {\r\n            minHeight: 32,\r\n        },\r\n    },\r\n    content: {\r\n        margin: 0,\r\n        '&$expanded': {\r\n            margin: 0,\r\n        },\r\n    },\r\n    expandIcon: {\r\n        padding: 0\r\n    },\r\n    expanded: {},\r\n})(MuiAccordionSummary);\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            width: '100%',\r\n        },\r\n        heading: {\r\n            fontSize: theme.typography.pxToRem(15),\r\n            fontWeight: theme.typography.fontWeightRegular,\r\n        },\r\n    }),\r\n);\r\n\r\ninterface PropertiesEditorProps {\r\n    object3d: Object3D\r\n}\r\n\r\nexport default function PropertiesEditor(props: PropertiesEditorProps) {\r\n    const classes = useStyles();\r\n    const [expanded, setExpanded] = React.useState(['Object', 'EmitterShape', 'ParticleRenderer','ParticleEmitter','Behaviors','Script']);\r\n\r\n    const handleChange = (panel: string) => (event: any, isExpanded: boolean) => {\r\n        if (isExpanded) {\r\n            expanded.push(panel);\r\n        } else {\r\n            expanded.splice(expanded.indexOf(panel), 1);\r\n        }\r\n        setExpanded(expanded);\r\n    };\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <ApplicationContextConsumer>\r\n                {context => context &&\r\n                    <ParticleSystemController object3d={props.object3d}\r\n                                              updateProperties={context.actions.updateProperties}/>\r\n                }\r\n            </ApplicationContextConsumer>\r\n            <Accordion expanded={(expanded.indexOf('Object') !== -1)} onChange={handleChange('Object')}>\r\n                <AccordionSummary\r\n                    expandIcon={<ExpandMoreIcon/>}\r\n                    aria-controls=\"object-content\"\r\n                    id=\"object-header\"\r\n                >\r\n                    <Typography className={classes.heading}>Object</Typography>\r\n                </AccordionSummary>\r\n                <AccordionDetails>\r\n                    <ApplicationContextConsumer>\r\n                        {context => context &&\r\n                            <ObjectProperties object3d={props.object3d}\r\n                                              updateProperties={context.actions.updateProperties}/>\r\n                        }\r\n                    </ApplicationContextConsumer>\r\n                </AccordionDetails>\r\n            </Accordion>\r\n            {(props.object3d instanceof ParticleEmitter) &&\r\n            <Accordion expanded={(expanded.indexOf('EmitterShape') !== -1)} onChange={handleChange('EmitterShape')}>\r\n                <AccordionSummary\r\n                    expandIcon={<ExpandMoreIcon/>}\r\n                    aria-controls=\"emitter-shape-content\"\r\n                    id=\"emitter-shape-header\">\r\n                    <Typography className={classes.heading}>Emitter Shape</Typography>\r\n                </AccordionSummary>\r\n                <AccordionDetails>\r\n                    <ApplicationContextConsumer>\r\n                        {context => context &&\r\n                            <EmitterShapeProperties particleSystem={(props.object3d as ParticleEmitter).system}\r\n                                                    updateProperties={context.actions.updateProperties}/>\r\n                        }\r\n                    </ApplicationContextConsumer>\r\n                </AccordionDetails>\r\n            </Accordion>\r\n            }\r\n            {(props.object3d instanceof ParticleEmitter) &&\r\n            <Accordion expanded={(expanded.indexOf('ParticleRenderer') !== -1)} onChange={handleChange('ParticleRenderer')}>\r\n                <AccordionSummary\r\n                    expandIcon={<ExpandMoreIcon/>}\r\n                    aria-controls=\"particle-renderer-content\"\r\n                    id=\"particle-renderer-header\">\r\n                    <Typography className={classes.heading}>Particle Renderer</Typography>\r\n                </AccordionSummary>\r\n                <AccordionDetails>\r\n                    <ApplicationContextConsumer>\r\n                        {context => context &&\r\n                            <ParticleRendererProperties particleSystem={(props.object3d as ParticleEmitter).system}\r\n                                                        updateProperties={context.actions.updateProperties}/>\r\n                        }\r\n                    </ApplicationContextConsumer>\r\n                </AccordionDetails>\r\n            </Accordion>\r\n            }\r\n            {(props.object3d instanceof ParticleEmitter) &&\r\n            <Accordion expanded={(expanded.indexOf('ParticleEmitter') !== -1)} onChange={handleChange('ParticleEmitter')}>\r\n                <AccordionSummary\r\n                    expandIcon={<ExpandMoreIcon/>}\r\n                    aria-controls=\"particle-emitter-content\"\r\n                    id=\"particle-emitter-header\">\r\n                    <Typography className={classes.heading}>Particle Emitter</Typography>\r\n                </AccordionSummary>\r\n                <AccordionDetails>\r\n                    <ApplicationContextConsumer>\r\n                        {context => context &&\r\n                            <ParticleSystemProperties particleSystem={(props.object3d as ParticleEmitter).system}\r\n                                                      updateProperties={context.actions.updateProperties}/>\r\n                        }\r\n                    </ApplicationContextConsumer>\r\n                </AccordionDetails>\r\n            </Accordion>\r\n            }\r\n            {(props.object3d instanceof ParticleEmitter) &&\r\n            <Accordion expanded={(expanded.indexOf('Behaviors') !== -1)} onChange={handleChange('Behaviors')}>\r\n                <AccordionSummary\r\n                    expandIcon={<ExpandMoreIcon/>}\r\n                    aria-controls=\"behaviors-content\"\r\n                    id=\"behaviors-header\">\r\n                    <Typography className={classes.heading}>Behaviors</Typography>\r\n                </AccordionSummary>\r\n                <AccordionDetails>\r\n                    <ApplicationContextConsumer>\r\n                        {context => context &&\r\n                            <BehaviorsProperties behaviors={(props.object3d as ParticleEmitter).system.behaviors}\r\n                                                        updateProperties={context.actions.updateProperties}/>\r\n                        }\r\n                    </ApplicationContextConsumer>\r\n                </AccordionDetails>\r\n            </Accordion>\r\n            }\r\n            <Accordion expanded={(expanded.indexOf('Script') !== -1)} onChange={handleChange('Script')}>\r\n                <AccordionSummary\r\n                    expandIcon={<ExpandMoreIcon/>}\r\n                    aria-controls=\"script-content\"\r\n                    id=\"script-header\"\r\n                >\r\n                    <Typography className={classes.heading}>Script</Typography>\r\n                </AccordionSummary>\r\n                <AccordionDetails>\r\n                    <ApplicationContextConsumer>\r\n                        {context => context &&\r\n                            <ScriptProperties object3d={props.object3d}\r\n                                              updateProperties={context.actions.updateProperties}/>\r\n                        }\r\n                    </ApplicationContextConsumer>\r\n                </AccordionDetails>\r\n            </Accordion>\r\n        </div>\r\n    );\r\n}","import React from \"react\";\r\nimport {AppContext, ApplicationContextConsumer} from \"./ApplicationContext\";\r\nimport {Object3D, Scene} from \"three\";\r\nimport {ParticleSystem} from \"three.quarks\";\r\nimport {ParticleEmitter} from \"three.quarks\";\r\nimport './SceneGraphView.scss';\r\nimport {Item, Menu, MenuProvider, Separator, Submenu} from \"react-contexify\";\r\nimport {MenuItemEventHandler} from \"react-contexify/lib/types\";\r\nimport 'react-contexify/dist/ReactContexify.min.css';\r\nimport {TreeView} from \"@material-ui/lab\";\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport {makeStyles, createStyles} from \"@material-ui/core\";\r\nimport TreeItem from \"@material-ui/lab/TreeItem\";\r\nimport {Theme, Typography} from \"@material-ui/core\";\r\nimport AccordionSummary from \"@material-ui/core/AccordionSummary\";\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            height: 240,\r\n            flexGrow: 1,\r\n        },\r\n        heading: {\r\n            fontSize: theme.typography.pxToRem(15),\r\n            fontWeight: theme.typography.fontWeightRegular,\r\n        },\r\n    }),\r\n);\r\n\r\ninterface SceneGraphViewMaterialProps {\r\n    context: AppContext\r\n    scene: Scene;\r\n}\r\n\r\nexport function SceneGraphViewMaterial(props: SceneGraphViewMaterialProps) {\r\n    const classes = useStyles();\r\n\r\n    const [selected, setSelected] = React.useState<string[]>([]);\r\n    const [expanded, setExpanded] = React.useState<string[]>(['1']);\r\n\r\n\r\n\r\n    const countIndex = (index: number, object3d: Object3D): Object3D | null => {\r\n        if (index == 0)\r\n            return object3d;\r\n        index --;\r\n        for (const child of object3d.children) {\r\n            const res = countIndex(index, child);\r\n            if (res)\r\n                return res;\r\n            index --;\r\n        }\r\n        return null;\r\n    }\r\n    const handleSelect = (event: React.ChangeEvent<{}>, nodeIds: string[]) => {\r\n        if (nodeIds.length > 0) {\r\n            const index = parseInt(nodeIds[0]);\r\n            const object3d = countIndex(index, props.scene);\r\n            if (object3d)\r\n                props.context.actions.select(object3d);\r\n        }\r\n        setSelected(nodeIds);\r\n    };\r\n    const handleToggle = (event: React.ChangeEvent<{}>, nodeIds: string[]) => {\r\n        //console.log(event.target);\r\n        if ((event.target as HTMLElement).tagName === 'svg') {\r\n            setExpanded(nodeIds);\r\n        }\r\n    };\r\n\r\n    const getObjectName = (object3d: Object3D) => {\r\n        let type = 'object';\r\n        if (object3d instanceof ParticleEmitter) {\r\n            type = 'ParticleSystem';\r\n        } else {\r\n            type =  object3d.type;\r\n        }\r\n        let name = 'unnamed';\r\n        if (object3d.name) {\r\n            name = object3d.name;\r\n        }\r\n        return `[${type}] ${name}`;\r\n    };\r\n\r\n    const renderObject = (context: AppContext, object3d: THREE.Object3D, index: number): [React.ReactNode, number] => {\r\n        const items = [];\r\n        const originIndex = index;\r\n        index ++;\r\n        for (const child of object3d.children) {\r\n            const result = renderObject(context, child, index);\r\n            items.push(result[0]);\r\n            index = result[1];\r\n        }\r\n        //selected={context.selection.indexOf(object3d) !== -1}\r\n        if (originIndex !== 0) {\r\n            return [<TreeItem key={object3d.uuid} nodeId={\"\" + originIndex}\r\n                              label={<MenuProvider id=\"scene-graph-menu\" data={{object3d: object3d}}>{getObjectName(object3d)}</MenuProvider>}>\r\n                {items}\r\n            </TreeItem>, index];\r\n        } else {\r\n            return [<React.Fragment>{items}</React.Fragment>, index];\r\n        }\r\n    }\r\n\r\n    const onContextMenuClick = ({event, props}: MenuItemEventHandler) => console.log(event,props);\r\n\r\n    const onContextMenuAddParticleSystem = ({event, props: contextProps}: MenuItemEventHandler) => {\r\n        if ((contextProps as any).object3d) {\r\n            props.context.actions.addObject3d('particle', (contextProps! as any).object3d);\r\n        }\r\n    };\r\n    const onContextMenuRemove = ({event, props: contextProps}: MenuItemEventHandler) => {\r\n        if ((contextProps as any).object3d) {\r\n            props.context.actions.removeObject3d((contextProps! as any).object3d);\r\n        }\r\n    };\r\n\r\n    const onContextMenuDuplicate = ({event, props: contextProps}: MenuItemEventHandler) => {\r\n        if ((contextProps as any).object3d) {\r\n            props.context.actions.duplicateObject3d((contextProps! as any).object3d);\r\n        }\r\n    };\r\n\r\n    const onContextMenuExport = ({event, props: contextProps}: MenuItemEventHandler) => {\r\n        console.log(contextProps);\r\n        if ((contextProps! as any).object3d) {\r\n            const a = document.createElement(\"a\");\r\n            const json = (contextProps! as any).object3d.toJSON();\r\n            //json.images.forEach((image: any) => image.url = \"http://localhost:3000/textures/texture1.png\");\r\n            const file = new Blob([JSON.stringify(json)], {type: \"application/json\"});\r\n            a.href = URL.createObjectURL(file);\r\n            a.download = \"scene.json\";\r\n            a.click();\r\n        }\r\n    };\r\n\r\n    const renderScene = (context: AppContext, scene: THREE.Scene) => {\r\n        return <TreeView\r\n            className={classes.root}\r\n            selected={selected}\r\n            expanded={expanded}\r\n            onNodeToggle={handleToggle}\r\n            onNodeSelect={handleSelect}\r\n            defaultCollapseIcon={<ExpandMoreIcon />}\r\n            defaultExpandIcon={<ChevronRightIcon />}\r\n        >\r\n            {renderObject(context, scene, 0)[0]}\r\n        </TreeView>;\r\n    }\r\n\r\n    return <div>\r\n        <Typography className={classes.heading}> Scene Graph </Typography>\r\n        {renderScene(props.context, props.scene)}\r\n        <Menu id=\"scene-graph-menu\">\r\n            <Submenu label=\"Add\">\r\n                <Item onClick={onContextMenuAddParticleSystem}>Particle System</Item>\r\n                <Item onClick={onContextMenuClick}>Ball</Item>\r\n            </Submenu>\r\n            <Separator />\r\n            <Item onClick={onContextMenuDuplicate}>Duplicate</Item>\r\n            <Item onClick={onContextMenuRemove}>Remove</Item>\r\n            <Separator />\r\n            <Item onClick={onContextMenuExport}>Export</Item>\r\n            <Item disabled>Dolor</Item>\r\n        </Menu>\r\n    </div>;\r\n}\r\n","import * as React from \"react\";\r\nimport MainMenu from \"./MainMenu\";\r\nimport {ThreejsViewport} from \"./ThreejsViewport\";\r\nimport PropertiesEditor from \"./PropertiesEditor\";\r\nimport {SceneGraphView} from \"./SceneGraphView\";\r\n\r\nimport './layout.scss';\r\nimport {ApplicationContextConsumer, ApplicationContextProvider} from \"./ApplicationContext\";\r\nimport {SceneGraphViewMaterial} from \"./SceneGraphViewMaterial\";\r\n\r\nexport class Application extends React.Component<{}> {\r\n\r\n    constructor(props: Readonly<{}>) {\r\n        super(props);\r\n    }\r\n\r\n    render() {\r\n        console.log(\"render application\");\r\n        return (\r\n            <ApplicationContextProvider>\r\n                <div className=\"application\">\r\n                    <div className=\"main-menu\">\r\n                        <ApplicationContextConsumer>\r\n                            {context => context &&\r\n                                <MainMenu onSaveAs={context.actions.onSaveAs}\r\n                                            onImport={context.actions.onImport}\r\n                                            onOpenDemo={context.actions.onOpenDemo}/>\r\n                            }\r\n                        </ApplicationContextConsumer>\r\n                    </div>\r\n                    <div className=\"main\">\r\n                        <div className=\"viewport\">\r\n                            <ThreejsViewport width={600} height={600}/>\r\n                        </div>\r\n                        <div className=\"sidebar\">\r\n                            <ApplicationContextConsumer>\r\n                                {\r\n                                    context => context && <SceneGraphViewMaterial context={context} scene={context.scene} />\r\n                                }\r\n                            </ApplicationContextConsumer>\r\n                            <ApplicationContextConsumer>\r\n                                { context => context && context.selection.length > 0 &&\r\n                                    <PropertiesEditor object3d={context.selection[0]}/>\r\n                                }\r\n                            </ApplicationContextConsumer>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </ApplicationContextProvider>);\r\n    }\r\n}\r\n","import React, {useState} from 'react';\r\nimport {PiecewiseBezier} from \"three.quarks\";\r\nimport {Application} from \"./components/Application\";\r\nimport {Bezier} from \"three.quarks\";\r\nimport blue from \"@material-ui/core/colors/blue\";\r\nimport red from \"@material-ui/core/colors/red\";\r\nimport createMuiTheme from \"@material-ui/core/styles/createMuiTheme\";\r\nimport { ThemeProvider } from '@material-ui/core';\r\nimport {BezierCurvesEditor} from \"./components/editors/bezier/BezierCurvesEditor\";\r\n\r\nconst theme = createMuiTheme({\r\n    palette: {\r\n        primary: {\r\n            main: blue[500],\r\n        },\r\n        secondary: {\r\n            main: red[500],\r\n        },\r\n    },\r\n    typography: {\r\n        fontSize: 12,\r\n    }\r\n});\r\n\r\nconst App: React.FC = () => {\r\n\r\n  /*const [bezierCurves, setBezierCurves] = useState(\r\n      new PiecewiseBezier([\r\n        [new Bezier(0, 0.5 / 3, 0.5 / 3 * 2, 0.5), 0],\r\n        [new Bezier(0.5, 0.5, 0.5, 0.5), 0.5],\r\n      ])\r\n  );return <div className=\"App\">\r\n        <header className=\"App-header\">\r\n            <BezierCurvesEditor width={200} height={100} value={bezierCurves} onChange={(bezierCurves) => {setBezierCurves(bezierCurves)}}/>\r\n        </header>\r\n    </div>;*/\r\n\r\n    return (<ThemeProvider theme={theme}><Application /></ThemeProvider>);\r\n};\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}