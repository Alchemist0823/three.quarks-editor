(this["webpackJsonpthree.quarks-editor"]=this["webpackJsonpthree.quarks-editor"]||[]).push([[0],{225:function(e,t,n){},332:function(e,t,n){},333:function(e,t,n){},334:function(e,t,n){},335:function(e,t,n){},336:function(e,t,n){},337:function(e,t,n){},338:function(e,t,n){},348:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(46),o=n.n(a),s=n(2),c=n(3),l=n(4),u=n(5),d=n(406),h=n(394),p=n(400),m=n(409),v=n(411),f=n(114),w=n(405),b=n(404),g=n(178),x=n.n(g),j=n(1),y=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).fileRef=void 0,i.openFileDialog=function(e){i.fileRef.current&&i.fileRef.current.click()},i.importFile=function(e){e.target.files&&i.props.onImport(e.target.files)},i.openDemo=function(e){i.props.onOpenDemo(e)},i.handleMenuClick=function(e){console.log(e.currentTarget),i.setState({anchorEl:e.currentTarget})},i.handleMenuClose=function(){i.setState({anchorEl:void 0})},i.state={anchorEl:void 0},i.fileRef=r.createRef(),i}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(j.jsx)(m.a,{sx:{flexGrow:1},children:Object(j.jsx)(b.a,{position:"static",children:Object(j.jsxs)(v.a,{variant:"dense",children:[Object(j.jsx)(w.a,{edge:"start",sx:{marginRight:function(e){return e.spacing(2)}},color:"inherit","aria-label":"menu",children:Object(j.jsx)(x.a,{})}),Object(j.jsx)(f.a,{variant:"h6",sx:{marginRight:function(e){return e.spacing(1)}},children:"Three.Quarks"}),Object(j.jsx)(d.a,{color:"inherit",sx:{marginRight:function(e){return e.spacing(1)}},"aria-controls":"simple-menu","aria-haspopup":"true",onClick:this.handleMenuClick,id:"file-button",children:"File"}),Object(j.jsxs)(h.a,{id:"file-menu",anchorEl:this.state.anchorEl,keepMounted:!0,open:Boolean(this.state.anchorEl&&"file-button"===this.state.anchorEl.id),onClose:this.handleMenuClose,children:[Object(j.jsx)(p.a,{children:"New"}),Object(j.jsx)(p.a,{onClick:this.openFileDialog,children:"Open"}),Object(j.jsx)(p.a,{onClick:this.props.onSaveAs,children:"Download"}),Object(j.jsx)("input",{ref:this.fileRef,type:"file",id:"fileElem",multiple:!0,accept:"application/json",style:{display:"none"},onChange:this.importFile})]}),Object(j.jsx)(d.a,{color:"inherit",sx:{marginRight:function(e){return e.spacing(1)}},"aria-controls":"simple-menu","aria-haspopup":"true",onClick:this.handleMenuClick,id:"demo-button",children:"Demo"}),Object(j.jsxs)(h.a,{id:"demo-menu",anchorEl:this.state.anchorEl,keepMounted:!0,open:Boolean(this.state.anchorEl&&"demo-button"===this.state.anchorEl.id),onClose:this.handleMenuClose,children:[Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(0)},children:"PlasmaProjectile"}),Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(1)},children:"BulletMuzzle"}),Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(2)},children:"BulletProjectile"}),Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(3)},children:"ShipSmoke"}),Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(4)},children:"HitImpact"}),Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(5)},children:"BlackHole"}),Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(6)},children:"Levelup"}),Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(7)},children:"EnergyMuzzle"}),Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(8)},children:"ElectricBall"}),Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(9)},children:"ShipTrail"}),Object(j.jsx)(p.a,{onClick:function(){return e.openDemo(10)},children:"Explosion2"})]})]})})})}}]),n}(r.PureComponent),O=n(180),S=n.n(O),C={isWebGLAvailable:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(t){return!1}},isWebGL2Available:function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(t){return!1}},getWebGLErrorMessage:function(){return this.getErrorMessage(1)},getWebGL2ErrorMessage:function(){return this.getErrorMessage(2)},getErrorMessage:function(e){var t={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext},n='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>',r=document.createElement("div");return r.id="webglmessage",r.style.fontFamily="monospace",r.style.fontSize="13px",r.style.fontWeight="normal",r.style.textAlign="center",r.style.background="#fff",r.style.color="#000",r.style.padding="1.5em",r.style.width="400px",r.style.margin="5em auto 0",n=(n=t[e]?n.replace("$0","graphics card"):n.replace("$0","browser")).replace("$1",{1:"WebGL",2:"WebGL 2"}[e]),r.innerHTML=n,r}},k=n(7),T=n(181),B=n(16);function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e,t,n){return t&&M(e.prototype,t),n&&M(e,n),e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function F(e,t){return F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},F(e,t)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I(e);if(t){var i=I(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return N(this,n)}}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(c){s=!0,i=c}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){if(e){if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function U(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}var J=function(e){R(n,e);var t=D(n);function n(e){var r;return P(this,n),L(E(r=t.call(this)),"type","ParticleEmitter"),L(E(r),"system",void 0),r.system=e,r.visible=!1,r}return z(n,[{key:"clone",value:function(){return this.system.clone().emitter}},{key:"dispose",value:function(){}},{key:"extractFromCache",value:function(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),null!==this.system&&(r.ps=this.system.toJSON(e)),this.children.length>0){r.children=[];for(var i=0;i<this.children.length;i++)r.children.push(this.children[i].toJSON(e).object)}if(t){var a=this.extractFromCache(e.geometries),o=this.extractFromCache(e.materials),s=this.extractFromCache(e.textures),c=this.extractFromCache(e.images);a.length>0&&(n.geometries=a),o.length>0&&(n.materials=o),s.length>0&&(n.textures=s),c.length>0&&(n.images=c)}return n.object=r,n}}]),n}(B.G),W=function e(){P(this,e),L(this,"startSpeed",0),L(this,"startColor",new B.Q),L(this,"startSize",1),L(this,"velocity",new B.P),L(this,"age",0),L(this,"life",1),L(this,"angularVelocity",void 0),L(this,"position",new B.P),L(this,"rotation",0),L(this,"rotationQuat",void 0),L(this,"size",1),L(this,"color",new B.Q),L(this,"uvTile",0)},G=function(){function e(t){P(this,e),this.value=t,L(this,"type",void 0),this.type="value"}return z(e,[{key:"genValue",value:function(){return this.value}},{key:"toJSON",value:function(){return{type:"ConstantValue",value:this.value}}},{key:"clone",value:function(){return new e(this.value)}}],[{key:"fromJSON",value:function(t){return new e(t.value)}}]),e}(),q=function(){function e(t,n){P(this,e),this.a=t,this.b=n,L(this,"type",void 0),this.type="value"}return z(e,[{key:"genValue",value:function(){return B.x.lerp(this.a,this.b,Math.random())}},{key:"toJSON",value:function(){return{type:"IntervalValue",a:this.a,b:this.b}}},{key:"clone",value:function(){return new e(this.a,this.b)}}],[{key:"fromJSON",value:function(t){return new e(t.a,t.b)}}]),e}(),X=function(){function e(){P(this,e),L(this,"functions",void 0),this.functions=new Array}return z(e,[{key:"findFunction",value:function(e){for(var t=0,n=0,r=this.functions.length-1;n+1<r;)if(t=Math.floor((n+r)/2),e<this.getStartX(t))r=t-1;else{if(!(e>this.getEndX(t)))return t;n=t+1}for(var i=n;i<=r;i++)if(e>=this.functions[i][1]&&e<=this.getEndX(i))return i;return-1}},{key:"getStartX",value:function(e){return this.functions[e][1]}},{key:"setStartX",value:function(e,t){e>0&&(this.functions[e][1]=t)}},{key:"getEndX",value:function(e){return e+1<this.functions.length?this.functions[e+1][1]:1}},{key:"setEndX",value:function(e,t){e+1<this.functions.length&&(this.functions[e+1][1]=t)}},{key:"getFunction",value:function(e){return this.functions[e][0]}},{key:"setFunction",value:function(e,t){this.functions[e][0]=t}},{key:"numOfFunctions",get:function(){return this.functions.length}}]),e}(),H=function(){function e(t,n,r,i){P(this,e),L(this,"p",void 0),this.p=[t,n,r,i]}return z(e,[{key:"genValue",value:function(e){var t=e*e,n=e*e*e,r=1-e,i=r*r,a=i*r;return this.p[0]*a+this.p[1]*i*e*3+this.p[2]*r*t*3+this.p[3]*n}},{key:"derivativeCoefficients",value:function(e){for(var t=[],n=e,r=n.length-1;r>0;r--){for(var i=[],a=0;a<r;a++){var o=r*(n[a+1]-n[a]);i.push(o)}t.push(i),n=i}return t}},{key:"getSlope",value:function(e){var t=this.derivativeCoefficients(this.p)[0],n=1-e,r=n*e*2,i=e*e;return n*n*t[0]+r*t[1]+i*t[2]}},{key:"controlCurve",value:function(e,t){this.p[1]=e/3+this.p[0],this.p[2]=this.p[3]-t/3}},{key:"hull",value:function(e){var t,n=this.p,r=[],i=[],a=0,o=0,s=0;for(i[a++]=n[0],i[a++]=n[1],i[a++]=n[2],i[a++]=n[3];n.length>1;){for(r=[],o=0,s=n.length-1;o<s;o++)t=e*n[o]+(1-e)*n[o+1],i[a++]=t,r.push(t);n=r}return i}},{key:"split",value:function(t){var n=this.hull(t);return{left:new e(n[0],n[4],n[7],n[9]),right:new e(n[9],n[8],n[6],n[3]),span:n}}},{key:"clone",value:function(){return new e(this.p[0],this.p[1],this.p[2],this.p[3])}},{key:"toJSON",value:function(){return{p0:this.p[0],p1:this.p[1],p2:this.p[2],p3:this.p[3]}}}],[{key:"fromJSON",value:function(t){return new e(t.p0,t.p1,t.p2,t.p3)}}]),e}(),Q=function(e){R(n,e);var t=D(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[new H(0,1/3,1/3*2,1),0]];return P(this,n),L(E(e=t.call(this)),"type",void 0),e.type="function",e.functions=r,e}return z(n,[{key:"genValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.findFunction(e);return-1===t?(console.error(e),0):this.functions[t][0].genValue((e-this.getStartX(t))/(this.getEndX(t)-this.getStartX(t)))}},{key:"toSVG",value:function(e,t){if(t<1)return"";for(var n=["M",0,this.functions[0][0].p[0]].join(" "),r=1/t;r<=1;r+=1/t)n=[n,"L",r*e,this.genValue(r)].join(" ");return n}},{key:"toJSON",value:function(){return{type:"PiecewiseBezier",functions:this.functions.map((function(e){var t=V(e,2),n=t[0],r=t[1];return{function:n.toJSON(),start:r}}))}}},{key:"clone",value:function(){return new n(this.functions.map((function(e){var t=V(e,2),n=t[0],r=t[1];return[n.clone(),r]})))}}],[{key:"fromJSON",value:function(e){return new n(e.functions.map((function(e){return[H.fromJSON(e.function),e.start]})))}}]),n}(X);function Y(e){switch(e.type){case"ConstantValue":return G.fromJSON(e);case"IntervalValue":return q.fromJSON(e);case"PiecewiseBezier":return Q.fromJSON(e);default:return new G(0)}}var Z=function(e){return{r:e.x,g:e.y,b:e.z,a:e.w}},$=function(e){return new B.Q(e.r,e.g,e.b,e.a)},K=function(){function e(t,n){P(this,e),this.a=t,this.b=n,L(this,"type",void 0),this.type="value"}return z(e,[{key:"genColor",value:function(e){var t=Math.random();return e.copy(this.a).lerp(this.b,t)}},{key:"toJSON",value:function(){return{type:"RandomColor",a:Z(this.a),b:Z(this.b)}}},{key:"clone",value:function(){return new e(this.a.clone(),this.b.clone())}}],[{key:"fromJSON",value:function(t){return new e($(t.a),$(t.b))}}]),e}(),ee=function(){function e(t,n){P(this,e),this.a=t,this.b=n,L(this,"type",void 0),this.type="function"}return z(e,[{key:"genColor",value:function(e,t){return e.copy(this.a).lerp(this.b,t)}},{key:"toJSON",value:function(){return{type:"ColorRange",a:Z(this.a),b:Z(this.b)}}},{key:"clone",value:function(){return new e(this.a.clone(),this.b.clone())}}],[{key:"fromJSON",value:function(t){return new e($(t.a),$(t.b))}}]),e}(),te=function(){function e(t){P(this,e),this.color=t,L(this,"type",void 0),this.type="value"}return z(e,[{key:"genColor",value:function(e){return e.copy(this.color)}},{key:"toJSON",value:function(){return{type:"ConstantColor",color:Z(this.color)}}},{key:"clone",value:function(){return new e(this.color.clone())}}],[{key:"fromJSON",value:function(t){return new e($(t.color))}}]),e}();function ne(e){switch(e.type){case"ConstantColor":return te.fromJSON(e);case"ColorRange":return ee.fromJSON(e);case"RandomColor":return K.fromJSON(e);default:return new te(new B.Q(1,1,1,1))}}var re=function(){function e(t){P(this,e),this.func=t,L(this,"type","ColorOverLife")}return z(e,[{key:"initialize",value:function(e){}},{key:"update",value:function(e,t){this.func.genColor(e.color,e.age/e.life),e.color.x*=e.startColor.x,e.color.y*=e.startColor.y,e.color.z*=e.startColor.z,e.color.w*=e.startColor.w}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}},{key:"clone",value:function(){return new e(this.func.clone())}}]),e}(),ie=function(){function e(t){P(this,e),this.angularVelocityFunc=t,L(this,"type","RotationOverLife")}return z(e,[{key:"initialize",value:function(e){"value"===this.angularVelocityFunc.type?e.angularVelocity=this.angularVelocityFunc.genValue():e.angularVelocity=0}},{key:"update",value:function(e,t){"value"===this.angularVelocityFunc.type?e.rotation+=t*e.angularVelocity:e.rotation+=t*this.angularVelocityFunc.genValue(e.age/e.life)}},{key:"toJSON",value:function(){return{type:this.type,func:this.angularVelocityFunc.toJSON()}}},{key:"clone",value:function(){return new e(this.angularVelocityFunc)}}]),e}(),ae=function(){function e(t){P(this,e),this.func=t,L(this,"type","SizeOverLife")}return z(e,[{key:"initialize",value:function(e){}},{key:"update",value:function(e){e.size=e.startSize*this.func.genValue(e.age/e.life)}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}},{key:"clone",value:function(){return new e(this.func.clone())}}]),e}(),oe=function(){function e(t){P(this,e),this.func=t,L(this,"type","SpeedOverLife")}return z(e,[{key:"initialize",value:function(e){}},{key:"update",value:function(e){e.velocity.normalize().multiplyScalar(e.startSpeed*this.func.genValue(e.age/e.life))}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}},{key:"clone",value:function(){return new e(this.func.clone())}}]),e}(),se=function(){function e(t){P(this,e),this.func=t,L(this,"type","FrameOverLife")}return z(e,[{key:"initialize",value:function(e){}},{key:"update",value:function(e,t){e.uvTile=Math.floor(this.func.genValue(e.age/e.life))}},{key:"toJSON",value:function(){return{type:this.type,func:this.func.toJSON()}}},{key:"clone",value:function(){return new e(this.func.clone())}}]),e}();new B.P;var ce=function(){function e(t){P(this,e),this.angularVelocityFunc=t,L(this,"type","OrbitOverLife")}return z(e,[{key:"initialize",value:function(e){"value"===this.angularVelocityFunc.type?e.angularVelocity=this.angularVelocityFunc.genValue():e.angularVelocity=0}},{key:"update",value:function(e,t){var n=Math.atan2(e.position.y,e.position.x),r=Math.sqrt(e.position.x*e.position.x+e.position.y*e.position.y);n+=this.angularVelocityFunc.genValue(e.age/e.life)*t,e.position.x=Math.cos(n)*r,e.position.y=Math.sin(n)*r}},{key:"toJSON",value:function(){return{type:this.type,func:this.angularVelocityFunc.toJSON()}}},{key:"clone",value:function(){return new e(this.angularVelocityFunc.clone())}}]),e}();var le,ue=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};P(this,e),L(this,"radius",void 0),L(this,"arc",void 0),L(this,"thickness",void 0),L(this,"angle",void 0),this.radius=t.radius||10,this.arc=t.arc||2*Math.PI,this.thickness=t.thickness||1,this.angle=t.angle||Math.PI/6}return z(e,[{key:"initialize",value:function(e){var t=Math.random(),n=B.x.lerp(1-this.thickness,1,Math.random()),r=t*this.arc,i=Math.sqrt(n),a=Math.sin(r),o=Math.cos(r);e.position.x=i*o,e.position.y=i*a,e.position.z=0;var s=this.angle*i;e.velocity.set(0,0,Math.cos(s)).addScaledVector(e.position,Math.sin(s)).multiplyScalar(e.startSpeed),e.position.multiplyScalar(this.radius)}},{key:"toJSON",value:function(){return{type:"cone",radius:this.radius,arc:this.arc,thickness:this.thickness,angle:this.angle}}},{key:"clone",value:function(){return new e({radius:this.radius,arc:this.arc,thickness:this.thickness,angle:this.angle})}}]),e}(),de=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};P(this,e),L(this,"radius",void 0),L(this,"arc",void 0),L(this,"thickness",void 0),this.radius=t.radius||10,this.arc=t.arc||2*Math.PI,this.thickness=t.thickness||1}return z(e,[{key:"initialize",value:function(e){var t=Math.random(),n=Math.random(),r=B.x.lerp(1-this.thickness,1,Math.random()),i=t*this.arc,a=Math.acos(2*n-1),o=Math.cbrt(r),s=Math.sin(i),c=Math.cos(i),l=Math.sin(a),u=Math.cos(a);e.position.x=o*l*c,e.position.y=o*l*s,e.position.z=o*u,e.velocity.setScalar(0).addScaledVector(e.position,e.startSpeed),e.position.multiplyScalar(this.radius)}},{key:"toJSON",value:function(){return{type:"sphere",radius:this.radius,arc:this.arc,thickness:this.thickness}}},{key:"clone",value:function(){return new e({radius:this.radius,arc:this.arc,thickness:this.thickness})}}]),e}(),he=function(){function e(){P(this,e)}return z(e,[{key:"initialize",value:function(e){var t=Math.random(),n=Math.random(),r=t*Math.PI*2,i=Math.acos(2*n-1),a=Math.cbrt(Math.random()),o=Math.sin(r),s=Math.cos(r),c=Math.sin(i),l=Math.cos(i);e.velocity.x=a*c*s,e.velocity.y=a*c*o,e.velocity.z=a*l,e.velocity.multiplyScalar(e.startSpeed),e.position.setScalar(0)}},{key:"toJSON",value:function(){return{type:"point"}}},{key:"clone",value:function(){return new e}}]),e}(),pe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};P(this,e),L(this,"radius",void 0),L(this,"arc",void 0),L(this,"thickness",void 0),L(this,"angle",void 0),this.radius=t.radius||10,this.arc=t.arc||2*Math.PI,this.thickness=t.thickness||1,this.angle=t.angle||Math.PI/6}return z(e,[{key:"initialize",value:function(e){var t=Math.random(),n=B.x.lerp(this.thickness,1,Math.random()),r=t*this.arc,i=Math.sqrt(n),a=Math.sin(r),o=Math.cos(r);e.position.x=i*o,e.position.y=i*a,e.position.z=0;var s=this.angle*i;e.velocity.set(0,0,Math.cos(s)).addScaledVector(e.position,Math.sin(s)).multiplyScalar(e.startSpeed),e.position.multiplyScalar(this.radius)}},{key:"toJSON",value:function(){return{type:"donut",radius:this.radius,arc:this.arc,thickness:this.thickness,angle:this.angle}}},{key:"clone",value:function(){return new e({radius:this.radius,arc:this.arc,thickness:this.thickness,angle:this.angle})}}]),e}(),me="\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec4 vColor;\n\nvoid main() {\n\n    #include <clipping_planes_fragment>\n    \n    vec3 outgoingLight = vec3( 0.0 );\n    vec4 diffuseColor = vColor;\n    \n    #include <logdepthbuf_fragment>\n    \n    #ifdef USE_MAP\n    vec4 texelColor = texture2D( map, vUv);\n    diffuseColor *= texelColor;\n    #endif\n\n    outgoingLight = diffuseColor.rgb;\n\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    \n    #include <tonemapping_fragment>\n\n}\n";!function(e){e[e.BillBoard=0]="BillBoard",e[e.StretchedBillBoard=1]="StretchedBillBoard",e[e.LocalSpace=2]="LocalSpace"}(le||(le={}));var ve=1e3,fe=new B.P(0,0,1),we=function(e){R(n,e);var t=D(n);function n(e){var r;return P(this,n),L(E(r=t.call(this)),"type","ParticleSystemBatch"),L(E(r),"systems",void 0),L(E(r),"geometry",void 0),L(E(r),"material",void 0),L(E(r),"offsetBuffer",void 0),L(E(r),"rotationBuffer",void 0),L(E(r),"sizeBuffer",void 0),L(E(r),"colorBuffer",void 0),L(E(r),"uvTileBuffer",void 0),L(E(r),"velocityBuffer",void 0),L(E(r),"settings",void 0),L(E(r),"vector_",new B.P),L(E(r),"quaternion_",new B.I),L(E(r),"quaternion2_",new B.I),L(E(r),"rotationMat_",new B.y),r.systems=new Set,r.geometry=new B.r,r.settings=e,r.geometry.setIndex(r.settings.instancingGeometry.getIndex()),r.geometry.setAttribute("position",r.settings.instancingGeometry.getAttribute("position")),r.geometry.setAttribute("uv",r.settings.instancingGeometry.getAttribute("uv")),r.offsetBuffer=new B.q(new Float32Array(3e3),3),r.offsetBuffer.setUsage(B.j),r.geometry.setAttribute("offset",r.offsetBuffer),r.colorBuffer=new B.q(new Float32Array(4e3),4),r.colorBuffer.setUsage(B.j),r.geometry.setAttribute("color",r.colorBuffer),e.renderMode===le.LocalSpace?r.rotationBuffer=new B.q(new Float32Array(4e3),4):r.rotationBuffer=new B.q(new Float32Array(ve),1),r.rotationBuffer.setUsage(B.j),r.geometry.setAttribute("rotation",r.rotationBuffer),r.sizeBuffer=new B.q(new Float32Array(ve),1),r.sizeBuffer.setUsage(B.j),r.geometry.setAttribute("size",r.sizeBuffer),r.uvTileBuffer=new B.q(new Float32Array(ve),1),r.uvTileBuffer.setUsage(B.j),r.geometry.setAttribute("uvTile",r.uvTileBuffer),r.rebuildMaterial(),r.frustumCulled=!1,r.renderOrder=r.settings.renderOrder,r}return z(n,[{key:"addSystem",value:function(e){this.systems.add(e)}},{key:"removeSystem",value:function(e){this.systems.delete(e)}},{key:"rebuildMaterial",value:function(){var e={},t={USE_MAP:"",USE_UV:""};e.map=new B.N(this.settings.texture),e.uvTransform=new B.N((new B.y).copy(this.settings.texture.matrix));var n=this.settings.uTileCount,r=this.settings.vTileCount;if(t.UV_TILE="",e.tileCount=new B.N(new B.O(n,r)),this.settings.renderMode===le.BillBoard||this.settings.renderMode===le.LocalSpace){var i,a;this.settings.renderMode===le.LocalSpace?(i="\n\n#include <uv_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 offset;\nattribute vec4 rotation;\nattribute float size;\nattribute vec4 color;\nattribute float uvTile;\n\nvarying vec4 vColor;\n\n#ifdef UV_TILE\nuniform vec2 tileCount;\n#endif\n\nvoid main() {\n\n    #ifdef UV_TILE\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\n    #else\n        #include <uv_vertex>\n    #endif\n    \n    float x2 = rotation.x + rotation.x, y2 = rotation.y + rotation.y, z2 = rotation.z + rotation.z;\n    float xx = rotation.x * x2, xy = rotation.x * y2, xz = rotation.x * z2;\n    float yy = rotation.y * y2, yz = rotation.y * z2, zz = rotation.z * z2;\n    float wx = rotation.w * x2, wy = rotation.w * y2, wz = rotation.w * z2;\n    float sx = size, sy = size, sz = size;\n    \n    mat4 matrix = mat4(( 1.0 - ( yy + zz ) ) * sx, ( xy + wz ) * sx, ( xz - wy ) * sx, 0.0,  // 1. column\n                      ( xy - wz ) * sy, ( 1.0 - ( xx + zz ) ) * sy, ( yz + wx ) * sy, 0.0,  // 2. column\n                      ( xz + wy ) * sz, ( yz - wx ) * sz, ( 1.0 - ( xx + yy ) ) * sz, 0.0,  // 3. column\n                      offset.x, offset.y, offset.z, 1.0);\n    \n    vec4 mvPosition = modelViewMatrix * (matrix * vec4( position, 1.0 ));\n\n\tvColor = color;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",a=B.i):(i="\n\n#include <uv_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 offset;\nattribute float rotation;\nattribute float size;\nattribute vec4 color;\nattribute float uvTile;\n\nvarying vec4 vColor;\n\n#ifdef UV_TILE\nuniform vec2 tileCount;\n#endif\n\nvoid main() {\n\n    #ifdef UV_TILE\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\n    #else\n        #include <uv_vertex>\n    #endif\n\t\n    vec4 mvPosition = modelViewMatrix * vec4( offset, 1.0 );\n\t\n    vec2 alignedPosition = ( position.xy ) * size;\n    \n    vec2 rotatedPosition;\n    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n    \n    mvPosition.xy += rotatedPosition;\n\n\tvColor = color;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",a=B.n),this.material=new B.K({uniforms:e,defines:t,vertexShader:i,fragmentShader:me,transparent:!0,depthWrite:!1,blending:this.settings.blending||B.a,side:a})}else{if(this.settings.renderMode!==le.StretchedBillBoard)throw new Error("render mode unavailable");this.velocityBuffer=new B.q(new Float32Array(3e3),3),this.velocityBuffer.setUsage(B.j),this.geometry.setAttribute("velocity",this.velocityBuffer),e.speedFactor=new B.N(1),this.material=new B.K({uniforms:e,defines:t,vertexShader:"\n\n#include <uv_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 offset;\nattribute float rotation;\nattribute float size;\nattribute vec4 color;\nattribute vec3 velocity;\nattribute float uvTile;\n\nvarying vec4 vColor;\n\n#ifdef UV_TILE\nuniform vec2 tileCount;\n#endif\n\nuniform float speedFactor;\n\nvoid main() {\n\n    #ifdef UV_TILE\n        vUv = vec2((mod(uvTile, tileCount.y) + uv.x) * (1.0 / tileCount.x), ((tileCount.y - floor(uvTile / tileCount.y) - 1.0) + uv.y) * (1.0 / tileCount.y));\n    #else\n        #include <uv_vertex>\n    #endif\n\t\n    vec4 mvPosition = modelViewMatrix * vec4( offset, 1.0 );\n    vec3 viewVelocity = normalMatrix * velocity;\n\n    vec3 scaledPos = vec3(position.xy * size, position.z);\n    mvPosition.xyz += scaledPos + dot(scaledPos, viewVelocity) * viewVelocity / length(viewVelocity) * speedFactor;\n\n\tvColor = color;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",fragmentShader:me,transparent:!0,depthWrite:!1,blending:this.settings.blending||B.a})}}},{key:"update",value:function(){var e=this,t=0;this.systems.forEach((function(n){var r=n.particles,i=n.particleNum;e.quaternion2_.setFromRotationMatrix(n.emitter.matrixWorld),e.rotationMat_.setFromMatrix4(n.emitter.matrixWorld);for(var a=0;a<i;a++,t++){var o=r[a];e.settings.renderMode===le.LocalSpace?(o.rotationQuat.setFromAxisAngle(fe,o.rotation),n.worldSpace?e.rotationBuffer.setXYZW(t,o.rotationQuat.x,o.rotationQuat.y,o.rotationQuat.z,o.rotationQuat.w):(e.quaternion_.copy(o.rotationQuat).multiply(e.quaternion2_),e.rotationBuffer.setXYZW(t,e.quaternion_.x,e.quaternion_.y,e.quaternion_.z,e.quaternion_.w))):e.rotationBuffer.setX(t,o.rotation),n.worldSpace?e.offsetBuffer.setXYZ(t,o.position.x,o.position.y,o.position.z):(e.vector_.copy(o.position).applyMatrix4(n.emitter.matrixWorld),e.offsetBuffer.setXYZ(t,e.vector_.x,e.vector_.y,e.vector_.z)),e.colorBuffer.setXYZW(t,o.color.x,o.color.y,o.color.z,o.color.w),e.sizeBuffer.setX(t,o.size),e.uvTileBuffer.setX(t,o.uvTile),e.settings.renderMode===le.StretchedBillBoard&&(n.worldSpace?e.velocityBuffer.setXYZ(t,o.velocity.x*n.speedFactor,o.velocity.y*n.speedFactor,o.velocity.z*n.speedFactor):(e.vector_.copy(o.velocity).applyMatrix3(e.rotationMat_),e.velocityBuffer.setXYZ(t,e.vector_.x*n.speedFactor,e.vector_.y*n.speedFactor,e.vector_.z*n.speedFactor)))}})),this.geometry.instanceCount=t,t>0&&(this.offsetBuffer.updateRange.count=3*t,this.offsetBuffer.needsUpdate=!0,this.sizeBuffer.updateRange.count=t,this.sizeBuffer.needsUpdate=!0,this.colorBuffer.updateRange.count=4*t,this.colorBuffer.needsUpdate=!0,this.uvTileBuffer.updateRange.count=t,this.uvTileBuffer.needsUpdate=!0,this.settings.renderMode===le.StretchedBillBoard&&(this.velocityBuffer.updateRange.count=3*t,this.velocityBuffer.needsUpdate=!0),this.settings.renderMode===le.LocalSpace?this.rotationBuffer.updateRange.count=4*t:this.rotationBuffer.updateRange.count=t,this.rotationBuffer.needsUpdate=!0)}},{key:"dispose",value:function(){this.geometry.dispose()}}]),n}(B.A),be=new B.P(0,0,1),ge=new B.H(1,1,1,1),xe=function(){function e(t,n){var r,i,a,o,s,c,l,u,d,h,p,m,v,f,w,b,g,x,j,y;P(this,e),L(this,"autoDestroy",void 0),L(this,"looping",void 0),L(this,"duration",void 0),L(this,"maxParticle",void 0),L(this,"startLife",void 0),L(this,"startSpeed",void 0),L(this,"startRotation",void 0),L(this,"startSize",void 0),L(this,"startColor",void 0),L(this,"startTileIndex",void 0),L(this,"emissionOverTime",void 0),L(this,"emissionOverDistance",void 0),L(this,"emissionBursts",void 0),L(this,"worldSpace",void 0),L(this,"speedFactor",void 0),L(this,"particleNum",void 0),L(this,"burstIndex",void 0),L(this,"burstWaveIndex",void 0),L(this,"time",void 0),L(this,"paused",void 0),L(this,"waitEmiting",void 0),L(this,"emitEnded",void 0),L(this,"markForDestroy",void 0),L(this,"behaviors",void 0),L(this,"particles",void 0),L(this,"emitterShape",void 0),L(this,"emitter",void 0),L(this,"rendererSettings",void 0),L(this,"renderer",void 0),L(this,"neededToUpdateRender",void 0),L(this,"oldWorldMatrix",new B.z),L(this,"normalMatrix",new B.y),L(this,"firstTimeUpdate",!0),this.renderer=t,this.autoDestroy=void 0!==n.autoDestroy&&n.autoDestroy,this.duration=null!==(r=n.duration)&&void 0!==r?r:1,this.maxParticle=null!==(i=n.maxParticle)&&void 0!==i?i:100,this.looping=void 0===n.looping||n.looping,this.startLife=null!==(a=n.startLife)&&void 0!==a?a:new G(5),this.startSpeed=null!==(o=n.startSpeed)&&void 0!==o?o:new G(0),this.startRotation=null!==(s=n.startRotation)&&void 0!==s?s:new G(0),this.startSize=null!==(c=n.startSize)&&void 0!==c?c:new G(1),this.startColor=null!==(l=n.startColor)&&void 0!==l?l:new te(new B.Q(1,1,1,1)),this.emissionOverTime=null!==(u=n.emissionOverTime)&&void 0!==u?u:new G(10),this.emissionOverDistance=null!==(d=n.emissionOverDistance)&&void 0!==d?d:new G(0),this.emissionBursts=null!==(h=n.emissionBursts)&&void 0!==h?h:[],this.emitterShape=null!==(p=n.shape)&&void 0!==p?p:new de,this.behaviors=null!==(m=n.behaviors)&&void 0!==m?m:new Array,this.worldSpace=null!==(v=n.worldSpace)&&void 0!==v&&v,this.speedFactor=null!==(f=n.speedFactor)&&void 0!==f?f:0,this.rendererSettings={blending:null!==(w=n.blending)&&void 0!==w?w:B.F,instancingGeometry:null!==(b=n.instancingGeometry)&&void 0!==b?b:ge,renderMode:null!==(g=n.renderMode)&&void 0!==g?g:le.BillBoard,renderOrder:null!==(x=n.renderOrder)&&void 0!==x?x:0,texture:n.texture,uTileCount:null!==(j=n.uTileCount)&&void 0!==j?j:1,vTileCount:null!==(y=n.vTileCount)&&void 0!==y?y:1},this.neededToUpdateRender=!0,this.particles=new Array,this.startTileIndex=n.startTileIndex||0,this.emitter=new J(this),this.particleNum=0,this.burstIndex=0,this.burstWaveIndex=0,this.time=0,this.paused=!1,this.waitEmiting=0,this.emitEnded=!1,this.markForDestroy=!1}return z(e,[{key:"texture",get:function(){return this.rendererSettings.texture},set:function(e){this.rendererSettings.texture=e,this.neededToUpdateRender=!0}},{key:"uTileCount",get:function(){return this.rendererSettings.uTileCount},set:function(e){this.rendererSettings.uTileCount=e,this.neededToUpdateRender=!0}},{key:"vTileCount",get:function(){return this.rendererSettings.vTileCount},set:function(e){this.rendererSettings.vTileCount=e,this.neededToUpdateRender=!0}},{key:"renderMode",get:function(){return this.rendererSettings.renderMode},set:function(e){this.rendererSettings.renderMode=e,this.neededToUpdateRender=!0}},{key:"renderOrder",get:function(){return this.rendererSettings.renderOrder},set:function(e){this.rendererSettings.renderOrder=e,this.neededToUpdateRender=!0}},{key:"blending",get:function(){return this.rendererSettings.blending},set:function(e){this.rendererSettings.blending=e,this.neededToUpdateRender=!0}},{key:"pause",value:function(){this.paused=!0}},{key:"play",value:function(){this.paused=!1}},{key:"spawn",value:function(e){for(var t=0;t<e&&this.particleNum<this.maxParticle;t++){for(this.particleNum++;this.particles.length<this.particleNum;)this.particles.push(new W);var n=this.particles[this.particleNum-1];this.startColor.genColor(n.startColor,this.time),n.color.copy(n.startColor),n.startSpeed=this.startSpeed.genValue(this.time),n.life=this.startLife.genValue(this.time),n.age=0,n.rotation=this.startRotation.genValue(this.time),this.rendererSettings.renderMode===le.LocalSpace&&(n.rotationQuat=(new B.I).setFromAxisAngle(be,n.rotation)),n.startSize=n.size=this.startSize.genValue(this.time),n.uvTile=this.startTileIndex,this.emitterShape.initialize(n),this.worldSpace&&(n.position.applyMatrix4(this.emitter.matrixWorld),n.velocity.applyMatrix3(this.normalMatrix));for(var r=0;r<this.behaviors.length;r++)this.behaviors[r].initialize(n)}}},{key:"endEmit",value:function(){this.emitEnded=!0,this.autoDestroy&&(this.markForDestroy=!0)}},{key:"dispose",value:function(){this.renderer.deleteSystem(this),this.emitter.dispose(),this.emitter.parent&&this.emitter.parent.remove(this.emitter)}},{key:"restart",value:function(){this.paused=!1,this.particleNum=0,this.burstIndex=0,this.burstWaveIndex=0,this.time=0,this.waitEmiting=0,this.emitEnded=!1,this.markForDestroy=!1}},{key:"update",value:function(e){if(this.firstTimeUpdate&&(this.renderer.addSystem(this),this.firstTimeUpdate=!1),e>.1&&(e=.1),!this.paused)if(this.emitEnded&&0===this.particleNum)this.markForDestroy&&this.emitter.parent&&this.dispose();else{this.time>this.duration&&(this.looping?this.time-=this.duration:this.emitEnded||this.endEmit()),this.neededToUpdateRender&&(this.renderer.updateSystem(this),this.neededToUpdateRender=!1),this.normalMatrix.getNormalMatrix(this.emitter.matrixWorld);for(var t=0;t<this.particleNum;t++){var n=this.particles[t];n.age>=n.life&&(this.particles[t]=this.particles[this.particleNum-1],this.particles[this.particleNum-1]=n,this.particleNum--,t--)}if(!this.emitEnded){var r=Math.ceil(this.waitEmiting);this.spawn(r),this.waitEmiting-=r}for(;this.burstIndex<this.emissionBursts.length&&this.emissionBursts[this.burstIndex].time<=this.time;){if(Math.random()<this.emissionBursts[this.burstIndex].probability){var i=this.emissionBursts[this.burstIndex].count;this.spawn(i)}this.burstIndex++}for(var a=0;a<this.particleNum;a++){for(var o=this.particles[a],s=0;s<this.behaviors.length;s++)this.behaviors[s].update(o,e);o.position.addScaledVector(o.velocity,e),o.age+=e}this.oldWorldMatrix.copy(this.emitter.matrixWorld),this.emitEnded||(this.waitEmiting+=e*this.emissionOverTime.genValue(this.time/this.duration)),this.time+=e}}},{key:"toJSON",value:function(e){if(this.texture.toJSON(e),void 0!==this.texture.image){var t=this.texture.image;e.images[t.uuid]={uuid:t.uuid,url:this.texture.name}}return{autoDestroy:this.autoDestroy,looping:this.looping,duration:this.duration,maxParticle:this.maxParticle,shape:this.emitterShape.toJSON(),startLife:this.startLife.toJSON(),startSpeed:this.startSpeed.toJSON(),startRotation:this.startRotation.toJSON(),startSize:this.startSize.toJSON(),startColor:this.startColor.toJSON(),emissionOverTime:this.emissionOverTime.toJSON(),emissionOverDistance:this.emissionOverDistance.toJSON(),emissionBursts:this.emissionBursts,instancingGeometry:this.rendererSettings.instancingGeometry.toJSON(),renderOrder:this.renderOrder,renderMode:this.renderMode,speedFactor:this.renderMode===le.StretchedBillBoard?this.speedFactor:0,texture:this.texture.uuid,startTileIndex:this.startTileIndex,uTileCount:this.uTileCount,vTileCount:this.vTileCount,blending:this.blending,behaviors:this.behaviors.map((function(e){return e.toJSON()})),worldSpace:this.worldSpace}}},{key:"addBehavior",value:function(e){this.behaviors.push(e)}},{key:"getRendererSettings",value:function(){return this.rendererSettings}},{key:"clone",value:function(){var t,n=[],r=U(this.emissionBursts);try{for(r.s();!(t=r.n()).done;){var i=t.value,a={};Object.assign(a,i),n.push(a)}}catch(u){r.e(u)}finally{r.f()}var o,s=[],c=U(this.behaviors);try{for(c.s();!(o=c.n()).done;){var l=o.value;s.push(l.clone())}}catch(u){c.e(u)}finally{c.f()}return new e(this.renderer,{autoDestroy:this.autoDestroy,looping:this.looping,duration:this.duration,maxParticle:this.maxParticle,shape:this.emitterShape.clone(),startLife:this.startLife.clone(),startSpeed:this.startSpeed.clone(),startRotation:this.startRotation.clone(),startSize:this.startSize.clone(),startColor:this.startColor.clone(),emissionOverTime:this.emissionOverTime.clone(),emissionOverDistance:this.emissionOverDistance.clone(),emissionBursts:n,instancingGeometry:this.rendererSettings.instancingGeometry,renderMode:this.renderMode,speedFactor:this.speedFactor,texture:this.texture,startTileIndex:this.startTileIndex,uTileCount:this.uTileCount,vTileCount:this.vTileCount,blending:this.blending,behaviors:s,worldSpace:this.worldSpace})}}],[{key:"fromJSON",value:function(t,n,r){var i;switch(t.shape.type){case"cone":i=new ue(t.shape);break;case"donut":i=new pe(t.shape);break;default:i=new he;break;case"sphere":i=new de(t.shape)}return new e(r,{autoDestroy:t.autoDestroy,looping:t.looping,duration:t.duration,maxParticle:t.maxParticle,shape:i,startLife:Y(t.startLife),startSpeed:Y(t.startSpeed),startRotation:Y(t.startRotation),startSize:Y(t.startSize),startColor:ne(t.startColor),emissionOverTime:Y(t.emissionOverTime),emissionOverDistance:Y(t.emissionOverDistance),emissionBursts:t.emissionBursts,renderMode:t.renderMode,renderOrder:t.renderOrder,speedFactor:t.speedFactor,texture:n[t.texture],startTileIndex:t.startTileIndex,uTileCount:t.uTileCount,vTileCount:t.vTileCount,blending:t.blending,behaviors:t.behaviors.map((function(e){return function(e){switch(e.type){case"ColorOverLife":return new re(ne(e.func));case"RotationOverLife":return new ie(Y(e.func));case"SizeOverLife":return new ae(Y(e.func));case"SpeedOverLife":return new oe(Y(e.func));case"FrameOverLife":return new se(Y(e.func));case"OrbitOverLife":return new ce(Y(e.func));default:return new re(new ee(new B.Q(1,1,1,1),new B.Q(1,1,1,1)))}}(e)})),worldSpace:t.worldSpace})}}]),e}(),je=function(e){R(n,e);var t=D(n);function n(){var e;return P(this,n),L(E(e=t.call(this)),"batches",[]),L(E(e),"type","BatchedParticleRenderer"),e}return z(n,[{key:"addSystem",value:function(e){for(var t=e.getRendererSettings(),r=0;r<this.batches.length;r++)if(n.equals(this.batches[r].settings,t))return void this.batches[r].addSystem(e);var i=new we(t);i.addSystem(e),this.batches.push(i),this.add(i)}},{key:"deleteSystem",value:function(e){for(var t=e.getRendererSettings(),r=0;r<this.batches.length;r++)if(n.equals(this.batches[r].settings,t))return void this.batches[r].removeSystem(e)}},{key:"updateSystem",value:function(e){}},{key:"update",value:function(){for(var e=0;e<this.batches.length;e++)this.batches[e].update()}}],[{key:"equals",value:function(e,t){return e.texture===t.texture&&e.blending===t.blending&&e.renderMode===t.renderMode&&e.uTileCount===t.uTileCount&&e.vTileCount===t.vTileCount&&e.instancingGeometry===t.instancingGeometry&&e.renderOrder===t.renderOrder}}]),n}(B.G),ye={UVMapping:B.M,CubeReflectionMapping:B.c,CubeRefractionMapping:B.d,EquirectangularReflectionMapping:B.k,EquirectangularRefractionMapping:B.l,CubeUVReflectionMapping:B.f,CubeUVRefractionMapping:B.g},Oe={RepeatWrapping:B.J,ClampToEdgeWrapping:B.b,MirroredRepeatWrapping:B.B},Se={NearestFilter:B.C,NearestMipmapNearestFilter:B.E,NearestMipmapLinearFilter:B.D,LinearFilter:B.s,LinearMipmapNearestFilter:B.u,LinearMipmapLinearFilter:B.t},Ce=function(){function e(t){P(this,e),L(this,"manager",void 0),L(this,"crossOrigin","anonymous"),L(this,"path",void 0),L(this,"resourcePath",void 0),this.manager=void 0!==t?t:B.h,this.resourcePath=""}return z(e,[{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"load",value:function(e,t,n,r,i){var a=this,o=void 0===this.path?B.v.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;var s=new B.m(a.manager);this.path&&s.setPath(this.path),s.load(e,(function(r){var o=null;try{o=JSON.parse(r)}catch(c){return void 0!==i&&i(c),void console.error("THREE:ObjectLoader: Can't parse "+e+".",c.message)}var s=o.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?a.parse(o,n,t):console.error("THREE.ObjectLoader: Can't load "+e)}),r,i)}},{key:"loadImage",value:function(e,t){var n=this;return n.manager.itemStart(t),e.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}},{key:"parseImages",value:function(e,t){var n={};if(void 0!==e&&e.length>0){var r=new B.w(t),i=new B.p(r);i.setCrossOrigin(this.crossOrigin);for(var a=0,o=e.length;a<o;a++){var s=e[a],c=s.url;if(Array.isArray(c)){n[s.uuid]=[];for(var l=0,u=c.length;l<u;l++){var d=c[l],h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:this.resourcePath+d;n[s.uuid].push(this.loadImage(i,h))}}else{h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:this.resourcePath+s.url;n[s.uuid]=this.loadImage(i,h)}}}return n}},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o,s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(t[s.image])?new B.e(t[s.image]):new B.L(t[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=n(s.mapping,ye)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=n(s.wrap[0],Oe),o.wrapT=n(s.wrap[1],Oe)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=n(s.minFilter,Se)),void 0!==s.magFilter&&(o.magFilter=n(s.magFilter,Se)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),r[s.uuid]=o}return r}},{key:"parseObject",value:function(e,t,n){var r;switch(e.type){case"ParticleEmitter":r=xe.fromJSON(e.ps,t,n).emitter;break;case"Group":r=new B.o;break;default:r=new B.G}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children)for(var i=e.children,a=0;a<i.length;a++)r.add(this.parseObject(i[a],t,n));return r}},{key:"parse",value:function(e,t,n){var r=this.parseImages(e.images,(function(){void 0!==t&&t(a)})),i=this.parseTextures(e.textures,r),a=this.parseObject(e.object,i,n);return void 0!==e.images&&0!==e.images.length||void 0!==t&&t(a),a}}]),e}(),ke=function(e){R(n,e);var t=D(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[new ee(new B.Q(0,0,0,1),new B.Q(1,1,1,1)),0]];return P(this,n),L(E(e=t.call(this)),"type",void 0),e.type="function",e.functions=r,e}return z(n,[{key:"genColor",value:function(e,t){var n=this.findFunction(t);return-1===n?(console.error(t),e.copy(this.functions[0][0].a)):this.getFunction(n).genColor(e,(t-this.getStartX(n))/(this.getEndX(n)-this.getStartX(n)))}},{key:"toJSON",value:function(){return{type:"Gradient",functions:this.functions.map((function(e){var t=V(e,2),n=t[0],r=t[1];return{function:n.toJSON(),start:r}}))}}},{key:"clone",value:function(){return new n(this.functions.map((function(e){var t=V(e,2),n=t[0],r=t[1];return[n.clone(),r]})))}}],[{key:"fromJSON",value:function(e){return new n(e.functions.map((function(e){return[ee.fromJSON(e.function),e.start]})))}}]),n}(X),Te=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,r){var i;Object(s.a)(this,n),(i=t.call(this)).particles=void 0,i.smoke=void 0,i.glowBeam=void 0,i.mainBeam=void 0;var a=r[0].texture;return i.mainBeam=new xe(e,{duration:1,looping:!0,startLife:new q(.1,.15),startSpeed:new G(0),startSize:new G(1.25),startColor:new te(new k.x(1,1,1,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new G(40),shape:new de({radius:1e-4,thickness:1,arc:2*Math.PI}),texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderOrder:2}),i.mainBeam.addBehavior(new ae(new Q([[new H(1,.25,.05,0),0]]))),i.mainBeam.emitter.name="mainBeam",i.add(i.mainBeam.emitter),i.glowBeam=new xe(e,{duration:1,looping:!0,startLife:new q(.1,.15),startSpeed:new G(0),startSize:new G(3.5),startColor:new te(new k.x(1,.1509503,.07352942,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new G(40),shape:new de({radius:1e-4,thickness:1,arc:2*Math.PI}),texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderOrder:2}),i.glowBeam.addBehavior(new ae(new Q([[new H(1,.95,.75,0),0]]))),i.glowBeam.emitter.name="glowBeam",i.add(i.glowBeam.emitter),i.particles=new xe(e,{duration:1,looping:!0,startLife:new q(.3,.6),startSpeed:new q(2,5),startSize:new q(.1,.4),startColor:new K(new k.x(1,1,1,.5),new k.x(1,.1509503,.07352942,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new G(60),shape:new ue({angle:4.8423/180*Math.PI,radius:.3,thickness:1,arc:2*Math.PI}),texture:a,renderMode:le.StretchedBillBoard,speedFactor:.01,blending:k.m,startTileIndex:0,uTileCount:10,vTileCount:10,renderOrder:0}),i.particles.addBehavior(new ae(new Q([[new H(1,.25,.05,0),0]]))),i.particles.emitter.rotateY(-Math.PI/2),i.particles.emitter.name="particles",i.add(i.particles.emitter),i.smoke=new xe(e,{startLife:new q(.25,.3),startSpeed:new G(0),startSize:new q(.75,1.25),startRotation:new q(0,2*Math.PI),startColor:new te(new k.x(1,1,1,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new G(20),shape:new de({radius:.2,thickness:1}),texture:a,blending:k.m,startTileIndex:2,uTileCount:10,vTileCount:10,renderOrder:-2}),i.smoke.addBehavior(new ae(new Q([[new H(1,.95,.75,0),0]]))),i.smoke.addBehavior(new re(new ee(new k.x(1,.1509503,.07352942,1),new k.x(0,0,0,0)))),i.smoke.addBehavior(new ie(new q(2*-Math.PI,2*Math.PI))),i.smoke.emitter.name="smoke",i.add(i.smoke.emitter),i.userData={script:"    this.position.x += delta * 30;\n    if (this.position.x > 20)\n        this.position.x = -20;\n"},i.userData.func=new Function("delta",i.userData.script),i}return Object(c.a)(n,[{key:"update",value:function(e){this.mainBeam.update(e),this.glowBeam.update(e),this.particles.update(e),this.smoke.update(e)}}]),n}(k.i),Be=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,r){var i;Object(s.a)(this,n),(i=t.call(this)).beam=void 0,i.muzzle1=void 0,i.muzzle2=void 0,i.flash=void 0,i.smoke=void 0,i.particles=void 0;var a=r[0].texture;i.beam=new xe(e,{duration:1,looping:!1,startLife:new q(.1,.2),startSpeed:new G(0),startSize:new G(4),startColor:new te(new k.x(1,.585716,.1691176,1)),worldSpace:!1,maxParticle:10,emissionOverTime:new G(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10}),i.beam.emitter.renderOrder=0,i.beam.emitter.name="beam",i.beam.addBehavior(new ae(new Q([[new H(1,.95,.75,0),0]]))),i.add(i.beam.emitter);var o={duration:1,looping:!1,startLife:new q(.1,.2),startSpeed:new G(0),startSize:new q(1,5),startColor:new te(new k.x(1,1,1,1)),worldSpace:!1,maxParticle:5,emissionOverTime:new G(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:91,uTileCount:10,vTileCount:10,renderMode:le.LocalSpace,renderOrder:2};return i.muzzle1=new xe(e,o),i.muzzle1.addBehavior(new re(new ee(new k.x(1,.3882312,.125,1),new k.x(1,.826827,.3014706,1)))),i.muzzle1.addBehavior(new ae(new Q([[new H(1,.95,.75,0),0]]))),i.muzzle1.addBehavior(new se(new Q([[new H(91,94,97,100),0]]))),i.muzzle1.emitter.name="muzzle1",i.muzzle1.emitter.position.x=1,i.add(i.muzzle1.emitter),i.muzzle2=new xe(e,o),i.muzzle2.addBehavior(new re(new ee(new k.x(1,.3882312,.125,1),new k.x(1,.826827,.3014706,1)))),i.muzzle2.addBehavior(new ae(new Q([[new H(1,.95,.75,0),0]]))),i.muzzle2.addBehavior(new se(new Q([[new H(91,94,97,100),0]]))),i.muzzle2.emitter.renderOrder=2,i.muzzle2.emitter.name="muzzle2",i.muzzle2.emitter.position.x=1,i.muzzle2.emitter.rotation.x=Math.PI/2,i.add(i.muzzle2.emitter),i.flash=new xe(e,{duration:1,looping:!1,startLife:new q(.1,.2),startSpeed:new G(0),startSize:new q(1,2.5),startRotation:new q(-Math.PI,Math.PI),startColor:new te(new k.x(1,1,1,1)),worldSpace:!1,maxParticle:5,emissionOverTime:new G(0),emissionBursts:[{time:0,count:2,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:81,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:2}),i.flash.addBehavior(new re(new ee(new k.x(1,.95,.82,1),new k.x(1,.38,.12,1)))),i.flash.addBehavior(new se(new Q([[new H(81,84.333,87.666,91),0]]))),i.flash.emitter.name="flash",i.add(i.flash.emitter),i.smoke=new xe(e,{duration:2.5,looping:!1,startLife:new q(.6,.8),startSpeed:new q(.1,3),startSize:new q(.75,1.5),startRotation:new q(-Math.PI,Math.PI),startColor:new K(new k.x(.6323,.6323,.6323,.31),new k.x(1,1,1,.54)),worldSpace:!0,maxParticle:10,emissionOverTime:new G(0),emissionBursts:[{time:0,count:5,cycle:1,interval:.01,probability:1}],shape:new ue({angle:20*Math.PI/180,radius:.3,thickness:1,arc:2*Math.PI}),texture:a,blending:k.m,startTileIndex:81,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:-2}),i.smoke.addBehavior(new re(new ee(new k.x(1,1,1,1),new k.x(1,1,1,0)))),i.smoke.addBehavior(new ie(new q(-Math.PI/4,Math.PI/4))),i.smoke.addBehavior(new se(new Q([[new H(28,31,34,37),0]]))),i.smoke.emitter.name="smoke",i.smoke.emitter.rotation.y=Math.PI/2,i.add(i.smoke.emitter),i.particles=new xe(e,{duration:1,looping:!1,startLife:new q(.2,.6),startSpeed:new q(1,15),startSize:new q(.1,.3),startColor:new K(new k.x(1,.91,.51,1),new k.x(1,.44,.16,1)),worldSpace:!0,maxParticle:10,emissionOverTime:new G(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ue({angle:20*Math.PI/180,radius:.3,thickness:1,arc:2*Math.PI}),texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:le.StretchedBillBoard,speedFactor:.5,renderOrder:0}),i.particles.addBehavior(new ae(new Q([[new H(1,.95,.75,0),0]]))),i.particles.emitter.name="particles",i.particles.emitter.rotation.y=Math.PI/2,i.add(i.particles.emitter),i}return Object(c.a)(n,[{key:"update",value:function(e){this.beam.update(e),this.muzzle1.update(e),this.muzzle2.update(e),this.flash.update(e),this.smoke.update(e),this.particles.update(e)}}]),n}(k.i),Pe=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this)).hProjectile=void 0,r.vProjectile=void 0;var i=(new k.u).load("textures/projectile.png");i.name="textures/projectile.png";var a={duration:1,looping:!0,startLife:new G(1),startSpeed:new G(0),startSize:new q(1,4),startColor:new te(new k.x(1,1,1,1)),worldSpace:!1,maxParticle:10,emissionOverTime:new G(1),shape:new he,texture:i,blending:k.a,startTileIndex:0,uTileCount:1,vTileCount:1,renderMode:le.LocalSpace,renderOrder:2};return r.hProjectile=new xe(e,a),r.hProjectile.emitter.name="hProjectile",r.add(r.hProjectile.emitter),r.vProjectile=new xe(e,a),r.vProjectile.emitter.name="vProjectile",r.vProjectile.emitter.rotation.x=Math.PI/2,r.add(r.vProjectile.emitter),r}return Object(c.a)(n,[{key:"update",value:function(e){this.hProjectile.update(e),this.vProjectile.update(e)}}]),n}(k.i),Me=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,r){var i;Object(s.a)(this,n),(i=t.call(this)).mainBeam=void 0,i.glowBeam=void 0,i.particles=void 0,i.beam=void 0,i.smoke=void 0,i.circle=void 0;var a=r[0].texture;return i.mainBeam=new xe(e,{duration:2,looping:!1,startLife:new q(.1,.3),startSpeed:new q(5,15),startSize:new q(1.5,1.25),startColor:new te(new k.x(1,1,1,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ue({angle:25*Math.PI/180,radius:.2,thickness:1,arc:2*Math.PI}),texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderOrder:2}),i.mainBeam.addBehavior(new ae(new Q([[new H(1,.25,.05,0),0]]))),i.mainBeam.emitter.name="mainBeam",i.add(i.mainBeam.emitter),i.glowBeam=new xe(e,{duration:1,looping:!1,startLife:new q(1,1.6),startSpeed:new q(.7,1.5),startSize:new q(.4,.8),startColor:new te(new k.x(1,.1509503,.07352942,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new ue({angle:80*Math.PI/180,radius:.25,thickness:.5,arc:2*Math.PI}),texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderOrder:2}),i.glowBeam.addBehavior(new ae(new Q([[new H(1,.25,.05,0),0]]))),i.glowBeam.emitter.name="glowBeam",i.add(i.glowBeam.emitter),i.smoke=new xe(e,{duration:1,looping:!1,startLife:new q(.5,.8),startSpeed:new q(1,2.5),startSize:new q(1,1.5),startRotation:new q(0,2*Math.PI),startColor:new te(new k.x(1,1,1,.5)),worldSpace:!0,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:12,cycle:1,interval:.01,probability:1}],shape:new de({radius:.75,thickness:1}),texture:a,blending:k.m,startTileIndex:2,uTileCount:10,vTileCount:10,renderOrder:-2}),i.smoke.addBehavior(new ae(new Q([[new H(1,.95,.75,0),0]]))),i.smoke.addBehavior(new re(new ee(new k.x(1,.1509503,.07352942,1),new k.x(0,0,0,0)))),i.smoke.addBehavior(new ie(new q(2*-Math.PI,2*Math.PI))),i.smoke.emitter.name="smoke",i.add(i.smoke.emitter),i.particles=new xe(e,{duration:1,looping:!1,startLife:new q(.6,1.2),startSpeed:new q(2,10),startSize:new q(.1,.4),startColor:new K(new k.x(1,1,1,1),new k.x(1,.1509503,.07352942,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:12,cycle:1,interval:.01,probability:1}],shape:new ue({angle:50/180*Math.PI,radius:.5,thickness:1,arc:2*Math.PI}),texture:a,blending:k.m,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:le.StretchedBillBoard,speedFactor:.5,renderOrder:0}),i.particles.addBehavior(new ae(new Q([[new H(1,.25,.05,0),0]]))),i.particles.emitter.name="particles",i.add(i.particles.emitter),i.beam=new xe(e,{duration:1,looping:!1,startLife:new G(.2),startSpeed:new G(0),startSize:new G(7),startColor:new te(new k.x(1,.3059356,.2426471,1)),worldSpace:!0,maxParticle:10,emissionOverTime:new G(0),emissionBursts:[{time:0,count:2,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderOrder:0}),i.beam.emitter.name="beam",i.beam.addBehavior(new ae(new Q([[new H(1,.66666,.33333,0),0]]))),i.add(i.beam.emitter),i.circle=new xe(e,{duration:1,looping:!1,startLife:new G(.4),startSpeed:new G(0),startSize:new G(4),startColor:new te(new k.x(1,.3059356,.2426471,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:10,uTileCount:10,vTileCount:10,renderOrder:2}),i.circle.addBehavior(new ae(new Q([[new H(.3,.6,.9,1),0]]))),i.circle.addBehavior(new se(new Q([[new H(10,13,16,19),0]]))),i.circle.emitter.name="circle",i.add(i.circle.emitter),i}return Object(c.a)(n,[{key:"update",value:function(e){this.mainBeam.update(e),this.glowBeam.update(e),this.particles.update(e),this.smoke.update(e),this.beam.update(e),this.circle.update(e)}}]),n}(k.i),ze=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,r){var i;Object(s.a)(this,n),(i=t.call(this)).gatherParticles=void 0,i.glow=void 0,i.glow2=void 0,i.particle=void 0,i.name="levelUp";var a=r[0].texture,o=new k.x(.8,.8,.2,1);i.gatherParticles=new xe(e,{duration:.5,looping:!1,startLife:new q(.3,.4),startSpeed:new q(-100,-150),startSize:new q(1,2),startColor:new te(o),worldSpace:!1,maxParticle:100,emissionOverTime:new G(100),shape:new de({radius:60,thickness:.8,arc:Math.PI}),texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:le.StretchedBillBoard,speedFactor:.05,renderOrder:2}),i.gatherParticles.addBehavior(new re(new ee(new k.x(.2,.2,.2,1),new k.x(1,1,1,1)))),i.gatherParticles.emitter.name="gatherParticles",i.add(i.gatherParticles.emitter);var c={duration:2,looping:!1,startLife:new G(2),startSpeed:new G(0),startSize:new q(120,160),startColor:new te(o),worldSpace:!1,maxParticle:10,emissionOverTime:new G(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:le.LocalSpace,renderOrder:0};i.glow=new xe(e,c),i.glow.addBehavior(new ae(new Q([[new H(0,.75,.9,1),0],[new H(1,.9,.75,0),.5]]))),i.glow.emitter.name="glow",i.glow.emitter.rotation.x=-Math.PI/2,i.add(i.glow.emitter);var l={duration:2,looping:!1,startLife:new G(2),startSpeed:new G(0),startSize:new q(60,80),startColor:new te(o),worldSpace:!1,maxParticle:10,emissionOverTime:new G(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:0};i.glow2=new xe(e,l),i.glow2.addBehavior(new ae(new Q([[new H(0,.75,.9,1),0],[new H(1,.9,.75,0),.2]]))),i.glow2.emitter.name="glow2",i.add(i.glow2.emitter);var u={duration:1,looping:!1,startLife:new q(.6,.8),startSpeed:new q(120,180),startSize:new q(2,4),startColor:new te(o),worldSpace:!1,maxParticle:100,emissionOverTime:new Q([[new H(0,0,0,0),0],[new H(50,80,80,50),.4]]),shape:new ue({radius:25,thickness:.2,angle:Math.PI/100}),texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:2};return i.particle=new xe(e,u),i.particle.addBehavior(new ae(new Q([[new H(0,.75,.9,1),0],[new H(1,.9,.75,0),.5]]))),i.particle.addBehavior(new ce(new Q([[new H(0,4*Math.PI*.75,4*Math.PI*.9,4*Math.PI),0]]))),i.particle.emitter.name="particle",i.particle.emitter.rotation.x=-Math.PI/2,i.add(i.particle.emitter),i}return Object(c.a)(n,[{key:"update",value:function(e){this.gatherParticles.update(e),this.glow.update(e),this.glow2.update(e),this.particle.update(e)}}]),n}(k.i),Le=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,r){var i;Object(s.a)(this,n),(i=t.call(this)).smoke=void 0,i.name="shipSmoke";var a=r[0].texture,o=new k.x(.5,.5,.5,1);return i.smoke=new xe(e,{duration:5,looping:!0,startLife:new q(1.5,3),startSpeed:new q(20,30),startSize:new q(10,15),startColor:new te(o),worldSpace:!0,maxParticle:100,emissionOverTime:new G(20),shape:new ue({radius:10,thickness:1,angle:.2}),texture:a,blending:k.m,startTileIndex:2,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:2}),i.smoke.addBehavior(new re(new ee(new k.x(1,1,1,1),new k.x(.8,.8,.8,0)))),i.smoke.addBehavior(new ae(new Q([[new H(.2,1,1,1),0]]))),i.smoke.emitter.name="smoke",i.smoke.emitter.rotation.x=-Math.PI/2,i.add(i.smoke.emitter),i}return Object(c.a)(n,[{key:"update",value:function(e){this.smoke.update(e)}}]),n}(k.i),Re=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,r){var i;Object(s.a)(this,n),(i=t.call(this)).beam=void 0,i.beamWorld=void 0,i.electricity=void 0,i.electricBall=void 0,i.name="ElectricBall";var a=r[1].texture;return i.beam=new xe(e,{duration:1,looping:!0,startLife:new G(1),startSpeed:new G(0),startSize:new G(15),startColor:new te(new k.x(.5220588*.772549,.6440161*.772549,.772549,.772549)),worldSpace:!1,maxParticle:100,emissionOverTime:new G(1),emissionBursts:[],shape:new he,texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderOrder:0}),i.beam.emitter.name="beam",i.add(i.beam.emitter),i.beamWorld=new xe(e,{duration:1,looping:!0,startLife:new q(.1,.4),startSpeed:new G(0),startSize:new q(7.5,15),startColor:new K(new k.x(.11176472,.28738328,.8,1),new k.x(.8,.9275356*.8,.08235296,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new q(5,10),emissionBursts:[],shape:new de({radius:.01,thickness:1,arc:2*Math.PI}),texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderOrder:0}),i.beamWorld.emitter.name="beamWorld",i.beamWorld.addBehavior(new re(new ee(new k.x(1,1,1,1),new k.x(0,0,0,1)))),i.add(i.beamWorld.emitter),i.electricity=new xe(e,{duration:.5,looping:!0,startLife:new q(.2,.3),startSpeed:new G(0),startSize:new q(3,6),startRotation:new q(-Math.PI,Math.PI),startColor:new K(new k.x(.1397059,.3592291,1,1),new k.x(1,.9275356,.1029412,1)),worldSpace:!0,maxParticle:100,emissionOverTime:new q(5,10),emissionBursts:[],shape:new he,texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderOrder:2}),i.electricity.addBehavior(new se(new Q([[new H(53,56,59,62),0]]))),i.electricity.addBehavior(new ae(new Q([[new H(1,1,.75,0),0]]))),i.electricity.emitter.name="electricity",i.add(i.electricity.emitter),i.electricBall=new xe(e,{duration:.4,looping:!0,startLife:new q(.2,.4),startSpeed:new G(0),startSize:new q(5,10),startRotation:new q(-Math.PI,Math.PI),startColor:new K(new k.x(.1397059,.3592291,1,1),new k.x(1,.9275356,.1029412,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new G(3),emissionBursts:[],shape:new he,texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderOrder:1}),i.electricBall.addBehavior(new se(new Q([[new H(62,65,68,71),0]]))),i.electricBall.emitter.name="electricBall",i.add(i.electricBall.emitter),i.userData={script:"    this.position.x += delta * 30;\n    if (this.position.x > 20)\n        this.position.x = -20;\n"},i.userData.func=new Function("delta",i.userData.script),i}return Object(c.a)(n,[{key:"update",value:function(e){this.beam.update(e),this.beamWorld.update(e),this.electricity.update(e),this.electricBall.update(e)}}]),n}(k.i),Ie=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,r){var i;Object(s.a)(this,n),(i=t.call(this)).particles=void 0,i.glowBeam=void 0,i.beam=void 0;var a=r[0].texture;return i.beam=new xe(e,{duration:1,looping:!0,startLife:new G(1),startSpeed:new G(0),startSize:new G(20),startColor:new te(new k.x(.5220588*.772549,.6440161*.772549,.772549,.772549)),worldSpace:!1,maxParticle:100,emissionOverTime:new G(1),emissionBursts:[],shape:new he,texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderOrder:0}),i.beam.emitter.name="beam",i.add(i.beam.emitter),i.add(i.beam.emitter),i.glowBeam=new xe(e,{duration:1,looping:!0,startLife:new G(.5),startSpeed:new G(0),startSize:new G(10),startColor:new te(new k.x(.5220588*.772549,.6440161*.772549,.772549,.772549)),worldSpace:!0,maxParticle:500,emissionOverTime:new G(120),shape:new de({radius:1e-4,thickness:1,arc:2*Math.PI}),texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderOrder:2}),i.glowBeam.addBehavior(new ae(new Q([[new H(1,1,.8,.5),0]]))),i.glowBeam.addBehavior(new re(new ee(new k.x(1,1,1,1),new k.x(0,0,0,0)))),i.glowBeam.emitter.name="glowBeam",i.add(i.glowBeam.emitter),i.particles=new xe(e,{duration:1,looping:!0,startLife:new q(.3,.6),startSpeed:new q(20,40),startSize:new q(1,2),startColor:new K(new k.x(1,1,1,.5),new k.x(.5220588,.6440161,1,.772549)),worldSpace:!1,maxParticle:100,emissionOverTime:new G(60),shape:new ue({angle:80/180*Math.PI,radius:1,thickness:.3,arc:2*Math.PI}),texture:a,renderMode:le.StretchedBillBoard,speedFactor:.2,blending:k.m,startTileIndex:0,uTileCount:10,vTileCount:10,renderOrder:0}),i.particles.addBehavior(new ae(new Q([[new H(1,.25,.05,0),0]]))),i.particles.emitter.rotateY(-Math.PI/2),i.particles.emitter.name="particles",i.add(i.particles.emitter),i.userData={script:"    this.position.x += delta * 200;\n    if (this.position.x > 200)\n        this.position.x = -200;\n"},i.userData.func=new Function("delta",i.userData.script),i}return Object(c.a)(n,[{key:"update",value:function(e){this.beam.update(e),this.glowBeam.update(e),this.particles.update(e)}}]),n}(k.i),Fe=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,r){var i;Object(s.a)(this,n),(i=t.call(this)).mainBeam=void 0,i.glowBeam=void 0,i.smoke=void 0,i.particles=void 0,i.beam=void 0,i.circle=void 0,i.circle2=void 0;var a=r[0].texture,o=n.yellowColor,c=n.yellowColor2;return i.mainBeam=new xe(e,{duration:2,looping:!1,startLife:new q(.1,.3),startSpeed:new q(100,300),startSize:new q(1.5,12.5),startColor:new te(new k.x(1,1,1,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new de({radius:2,thickness:1,arc:2*Math.PI}),texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:2}),i.mainBeam.addBehavior(new ae(new Q([[new H(1,.25,.05,0),0]]))),i.mainBeam.emitter.name="mainBeam",i.add(i.mainBeam.emitter),i.glowBeam=new xe(e,{duration:1,looping:!1,startLife:new q(1,1.6),startSpeed:new q(20,45),startSize:new q(4,8),startColor:new te(o),worldSpace:!1,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:8,cycle:1,interval:.01,probability:1}],shape:new de({radius:2,thickness:1,arc:2*Math.PI}),texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:2}),i.glowBeam.addBehavior(new ae(new Q([[new H(1,.25,.05,0),0]]))),i.glowBeam.emitter.name="glowBeam",i.add(i.glowBeam.emitter),i.smoke=new xe(e,{duration:1,looping:!1,startLife:new q(.8,1.2),startSpeed:new q(20,50),startSize:new q(10,15),startRotation:new q(0,2*Math.PI),startColor:new te(new k.x(1,1,1,.5)),worldSpace:!1,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:12,cycle:1,interval:.01,probability:1}],shape:new de({radius:7.5,arc:Math.PI,thickness:1}),texture:a,blending:k.m,startTileIndex:2,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:-2}),i.smoke.addBehavior(new ae(new Q([[new H(1,.95,.75,0),0]]))),i.smoke.addBehavior(new re(new ee(o,new k.x(0,0,0,0)))),i.smoke.addBehavior(new ie(new q(2*-Math.PI,2*Math.PI))),i.smoke.addBehavior(new oe(new Q([[new H(1,.95,.75,0),0]]))),i.smoke.emitter.name="smoke",i.add(i.smoke.emitter),i.particles=new xe(e,{duration:1,looping:!1,startLife:new q(.6,1.2),startSpeed:new q(40,200),startSize:new q(1,4),startColor:new K(new k.x(1,1,1,1),o),worldSpace:!1,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:12,cycle:1,interval:.01,probability:1}],shape:new de({radius:2,thickness:1,arc:2*Math.PI}),texture:a,blending:k.m,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:le.StretchedBillBoard,speedFactor:.1,renderOrder:0}),i.particles.addBehavior(new ae(new Q([[new H(1,.25,.05,0),0]]))),i.particles.emitter.name="particles",i.add(i.particles.emitter),i.beam=new xe(e,{duration:1,looping:!1,startLife:new G(.2),startSpeed:new G(0),startSize:new G(100),startColor:new te(c),worldSpace:!1,maxParticle:10,emissionOverTime:new G(0),emissionBursts:[{time:0,count:2,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:-2}),i.beam.emitter.name="beam",i.beam.addBehavior(new ae(new Q([[new H(1,.66666,.33333,0),0]]))),i.add(i.beam.emitter),i.circle=new xe(e,{duration:1,looping:!1,startLife:new G(.4),startSpeed:new G(0),startSize:new G(40),startColor:new te(c),worldSpace:!1,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:10,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:2}),i.circle.addBehavior(new ae(new Q([[new H(.3,.6,.9,1),0]]))),i.circle.addBehavior(new se(new Q([[new H(10,13,16,19),0]]))),i.circle.emitter.name="circle",i.add(i.circle.emitter),i.circle2=new xe(e,{duration:1,looping:!1,startLife:new G(.4),startSpeed:new G(0),startSize:new G(40),startColor:new te(c),worldSpace:!1,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:10,uTileCount:10,vTileCount:10,renderMode:le.LocalSpace,renderOrder:2}),i.circle2.addBehavior(new ae(new Q([[new H(.3,.6,.9,1),0]]))),i.circle2.addBehavior(new se(new Q([[new H(10,13,16,19),0]]))),i.circle2.emitter.name="circle",i.circle2.emitter.rotation.x=Math.PI/2,i.add(i.circle2.emitter),i}return Object(c.a)(n,[{key:"update",value:function(e){this.beam.update(e),this.mainBeam.update(e),this.glowBeam.update(e),this.circle.update(e),this.smoke.update(e),this.particles.update(e),this.circle2.update(e)}}]),n}(k.i);Fe.yellowColor=new k.x(.9,.6,.25,1),Fe.yellowColor2=new k.x(1,.95,.4,1);var Ee=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,r){var i;Object(s.a)(this,n),(i=t.call(this)).particles=void 0,i.glow=void 0,i.glowTop=void 0,i.ringBase=void 0;var a=r[1].texture;i.particles=new xe(e,{duration:1,looping:!1,startLife:new q(.2,.6),startSpeed:new q(20,50),startSize:new G(2),startColor:new te(new k.x(.5,.5,.5,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:24,cycle:1,interval:.01,probability:1}],shape:new ue({angle:.2,radius:5}),texture:a,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:le.StretchedBillBoard,speedFactor:.1,renderOrder:0}),i.particles.emitter.renderOrder=0,i.particles.emitter.name="particles",i.particles.addBehavior(new ae(new Q([[new H(1,.95,.75,0),0]]))),i.particles.addBehavior(new re(new ee(new k.x(1,1,1,1),new k.x(0,.8,1,1)))),i.add(i.particles.emitter);var o={duration:1,looping:!1,startLife:new q(.6,.8),startSpeed:new G(0),startSize:new q(60,80),startColor:new te(new k.x(0,.3,.3,1)),worldSpace:!1,maxParticle:5,emissionOverTime:new G(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:-2};i.glow=new xe(e,o),i.glow.addBehavior(new re(new ee(new k.x(1,1,1,1),new k.x(0,0,0,1)))),i.glow.emitter.name="glow",i.glow.emitter.position.x=1,i.add(i.glow.emitter),i.glowTop=new xe(e,{duration:1,looping:!1,startLife:new q(.6,.8),startSpeed:new q(0,50),startSize:new q(40,60),startRotation:new G(0),startColor:new te(new k.x(0,.2,.2,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new G(0),emissionBursts:[{time:0,count:5,cycle:1,interval:.01,probability:1}],shape:new ue({angle:.01,radius:1}),texture:a,blending:k.a,startTileIndex:1,uTileCount:10,vTileCount:10,renderMode:le.BillBoard,renderOrder:-2}),i.glowTop.emitter.name="glowTop",i.glowTop.addBehavior(new re(new ke([[new ee(new k.x(1,1,1,1),new k.x(1,1,1,1)),0],[new ee(new k.x(1,1,1,1),new k.x(0,0,0,1)),.5]]))),i.add(i.glowTop.emitter);var c=new k.g(10,6,4,16,1,!0);return c.rotateX(Math.PI/2),i.ringBase=new xe(e,{duration:1,looping:!1,startLife:new G(.8),startSpeed:new G(0),startSize:new G(1),startColor:new te(new k.x(0,1,1,1)),worldSpace:!1,maxParticle:10,emissionOverTime:new G(0),emissionBursts:[{time:0,count:1,cycle:1,interval:.01,probability:1}],shape:new he,texture:a,blending:k.a,startTileIndex:91,uTileCount:10,vTileCount:10,instancingGeometry:c,renderMode:le.LocalSpace,renderOrder:1}),i.ringBase.addBehavior(new re(new ke([[new ee(new k.x(1,1,1,1),new k.x(1,1,1,1)),0],[new ee(new k.x(1,1,1,1),new k.x(0,0,0,1)),.5]]))),i.ringBase.addBehavior(new ae(new Q([[new H(.5,.75,.95,1),0]]))),i.ringBase.emitter.name="ringBase",i.add(i.ringBase.emitter),i}return Object(c.a)(n,[{key:"update",value:function(e){this.ringBase.update(e),this.glowTop.update(e),this.glow.update(e),this.particles.update(e)}}]),n}(k.i),Ne=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,r){var i;Object(s.a)(this,n),(i=t.call(this)).beam=void 0,i.particles=void 0,i.ring=void 0;var a=r[0].texture;return i.beam=new xe(e,{duration:1,looping:!0,startLife:new G(1),startSpeed:new G(0),startSize:new G(40),startColor:new te(new k.x(0,0,0,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new G(1),emissionBursts:[],shape:new he,texture:a,blending:1,startTileIndex:0,uTileCount:10,vTileCount:10,renderMode:0,renderOrder:0}),i.beam.emitter.name="beam",i.beam.emitter.rotation.set(0,0,0),i.add(i.beam.emitter),i.particles=new xe(e,{duration:1,looping:!0,startLife:new G(3),startSpeed:new G(0),startSize:new G(4),startColor:new te(new k.x(1,1,1,1)),worldSpace:!1,maxParticle:1e4,emissionOverTime:new G(8),emissionBursts:[],shape:new de({radius:18,arc:2*Math.PI,thickness:.01}),texture:a,blending:2,startTileIndex:4,uTileCount:10,vTileCount:10,renderMode:0,renderOrder:0}),i.particles.addBehavior(new ce(new G(1))),i.particles.addBehavior(new re(new ke([[new ee(new k.x(0,0,0,1),new k.x(1,1,1,1)),0],[new ee(new k.x(1,1,1,1),new k.x(1,1,1,1)),.2],[new ee(new k.x(1,1,1,1),new k.x(0,0,0,1)),.8]]))),i.particles.emitter.name="particles",i.particles.emitter.rotation.set(0,0,0),i.add(i.particles.emitter),i.ring=new xe(e,{duration:1,looping:!0,startLife:new G(1),startSpeed:new G(0),startSize:new G(30),startColor:new te(new k.x(.9254901960784314,.788235294117647,.1607843137254902,1)),worldSpace:!1,maxParticle:100,emissionOverTime:new G(1),emissionBursts:[],shape:new he,texture:a,blending:2,startTileIndex:4,uTileCount:10,vTileCount:10,renderMode:0,renderOrder:0}),i.ring.emitter.name="ring",i.ring.emitter.rotation.set(0,0,0),i.add(i.ring.emitter),i}return Object(c.a)(n,[{key:"update",value:function(e){this.beam.update(e),this.particles.update(e),this.ring.update(e)}}]),n}(k.i),De=r.createContext(null),Ve=De.Consumer,_e=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).textureLoader=void 0,r.updateProperties1=function(){r.setState({updateProperties:r.updateProperties2})},r.updateProperties2=function(){r.setState({updateProperties:r.updateProperties1})},r.removeObject3d=function(e){e.parent&&e.parent.remove(e)},r.duplicateObject3d=function(e){e.parent&&e.parent.add(e.clone())},r.addObject3d=function(e,t){var n;switch(e){case"particle":var i=r.state.textures[0].texture;n=new xe(r.state.batchedRenderer,{maxParticle:1e4,shape:new ue,emissionOverTime:new G(100),startLife:new G(30),startSpeed:new G(10),startSize:new G(1),startColor:new te(new k.x(1,1,1,1)),texture:i,blending:k.a,startTileIndex:0,uTileCount:10,vTileCount:10,worldSpace:!0}).emitter,r.state.scene.add(n);break;case"box":n=new k.k(new k.d(10,10,10),new k.l({color:13421772})),r.state.scene.add(n)}n&&(t.add(n),r.state.actions.select(n),r.setState({}))},r.update=0,r.animate=function(e){r.update+=e,r.update>.1&&(r.update=0)},r.textureLoader=new k.u;var i=r.textureLoader.load("/three.quarks-editor/textures/texture1.png");i.name="textures/texture1.png";var a=r.textureLoader.load("/three.quarks-editor/textures/texture2.png",(function(){console.log(a)}));a.name="textures/texture2.png";var o={scene:new k.q,script:r.animate,batchedRenderer:void 0,selection:[],textures:[{img:"/three.quarks-editor/textures/texture1.png",texture:i},{img:"/three.quarks-editor/textures/texture2.png",texture:a}],actions:{onOpenDemo:function(e){r.addDemo(e)},onSaveAs:function(){var e=document.createElement("a"),t=new Blob([JSON.stringify(r.state.scene.toJSON())],{type:"application/json"});e.href=URL.createObjectURL(t),e.download="scene.json",e.click()},onImport:function(e){for(var t=e.length,n=0;n<t;n++){var i=URL.createObjectURL(e[n]),a=new Ce;a.setCrossOrigin(""),a.load(i,r.state.batchedRenderer,(function(e){r.state.scene.add(e)}),(function(){}),(function(){}))}},select:function(e){r.setState({selection:[e]})},selectAddition:function(e){-1===r.state.selection.indexOf(e)&&(r.state.selection.push(e),r.setState({selection:r.state.selection}))},addObject3d:r.addObject3d,removeObject3d:r.removeObject3d,duplicateObject3d:r.duplicateObject3d,updateParticleSystem:function(){},addTexture:function(e){r.state.textures.push(e),r.setState({textures:r.state.textures})},setBatchedRenderer:function(e){r.setState({batchedRenderer:e})}},updateProperties:r.updateProperties1};return r.state=o,r}return Object(c.a)(n,[{key:"addDemo",value:function(e){var t;0===e?(t=new Te(this.state.batchedRenderer,this.state.textures)).name="Toon Projectile":1===e?(t=new Be(this.state.batchedRenderer,this.state.textures)).name="BulletMuzzle":2===e?(t=new Pe(this.state.batchedRenderer)).name="BulletProjectile":3===e?(t=new Le(this.state.batchedRenderer,this.state.textures)).name="shipSmoke":4===e?(t=new Me(this.state.batchedRenderer,this.state.textures)).name="ToonExplosion":5===e?(t=new Ne(this.state.batchedRenderer,this.state.textures)).name="Blackhole":6===e?(t=new ze(this.state.batchedRenderer,this.state.textures)).name="LevelUp":7===e?(t=new Ee(this.state.batchedRenderer,this.state.textures)).name="EnergyRifleMuzzle":8===e?(t=new Re(this.state.batchedRenderer,this.state.textures)).name="ElectricBall":9===e?(t=new Ie(this.state.batchedRenderer,this.state.textures)).name="ShipTrail":10===e&&((t=new Fe(this.state.batchedRenderer,this.state.textures)).name="Explosion2"),t&&this.state.scene.add(t),this.state.updateProperties()}}]),Object(c.a)(n,[{key:"render",value:function(){return Object(j.jsx)(De.Provider,{value:this.state,children:this.props.children})}}]),n}(r.Component),Ae=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).container=void 0,i.stats=void 0,i.camera=void 0,i.renderer=void 0,i.batchedRenderer=void 0,i.clock=void 0,i.controls=void 0,i.appContext=void 0,i.onResize=function(e){if(i.renderer.domElement.parentElement.clientWidth-10!==i.renderer.domElement.width||i.renderer.domElement.parentElement.clientHeight-10!==i.renderer.domElement.height){var t=i.renderer.domElement.parentElement.clientWidth-10,n=i.renderer.domElement.parentElement.clientHeight-10;i.camera.aspect=t/n,i.camera.updateProjectionMatrix(),i.renderer.domElement.style.width="100%",i.renderer.domElement.style.height="100%",i.renderer.setSize(t,n)}},i.animate=function(){requestAnimationFrame(i.animate),i.onResize(null),i.renderScene(),i.stats.update()},i.container=r.createRef(),i}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.init()&&this.animate()}},{key:"componentDidUpdate",value:function(e,t,n){this.camera.aspect=this.props.width/this.props.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.props.width,this.props.height)}},{key:"init",value:function(){var e;if(!this.container.current)return!1;if(!C.isWebGLAvailable())return document.body.appendChild(C.getWebGLErrorMessage()),!1;this.renderer=new k.y;var t=this.appContext.scene;this.batchedRenderer=new je,this.batchedRenderer.name="batched particle renderer",null===(e=this.appContext)||void 0===e||e.actions.setBatchedRenderer(this.batchedRenderer),t.add(this.batchedRenderer),t.background=new k.f(6710886);var n=new k.c(100);n.name="axisHelper",t.add(n);var r=new k.o(new k.f(1,1,1),.8,200);r.position.set(50,50,50),t.add(r);var i=new k.b(new k.f(1,1,1),.2);t.add(i);var a=this.props.width,o=this.props.height;return this.clock=new k.e,this.camera=new k.n(50,a/o,1,1e3),this.camera.position.set(50,50,50),this.controls=new T.a(this.camera,this.renderer.domElement),this.controls.enableKeys=!1,this.controls.enableDamping=!0,this.controls.dampingFactor=.1,this.controls.rotateSpeed=.2,this.controls.update(),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(a,o),this.container.current.appendChild(this.renderer.domElement),this.stats=new S.a,this.stats.dom.style.position="absolute",this.stats.dom.style.left="",this.stats.dom.style.right="0",this.container.current.appendChild(this.stats.dom),this.onResize(null),!0}},{key:"renderScene",value:function(){if(this.appContext){this.controls.update();var e=this.clock.getDelta();this.appContext.script(e),this.appContext.scene.traverse((function(t){t.userData&&t.userData.func&&t.userData.func.call(t,e),t instanceof J&&t.system.update(e)})),this.batchedRenderer.update(),this.renderer.render(this.appContext.scene,this.camera)}}},{key:"render",value:function(){var e=this;return console.log("rendering ThreejsViewPort"),Object(j.jsx)(Ve,{children:function(t){if(t)return e.appContext=t,Object(j.jsx)("div",{ref:e.container,style:{width:"100%",height:"100%"}})}})}}]),n}(r.PureComponent),Ue=n(21),Je=n(42),We=(n(225),function(e){var t=r.useState(e.value+""),n=Object(Ue.a)(t,2),i=n[0],a=n[1],o=r.useState(!1),s=Object(Ue.a)(o,2),c=s[0],l=s[1];return Object(j.jsx)("input",{className:"number-input",value:c?i:e.value,size:5,onChange:function(e){c&&a(e.target.value)},onBlur:function(t){var n=parseFloat(i);n!==e.value&&e.onChange(n),l(!1)},onFocus:function(t){i!==e.value+""&&a(e.value+""),l(!0)},onKeyDown:function(t){if("Enter"===t.key){var n=parseFloat(i);n!==e.value&&e.onChange(n)}}})}),Ge=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){console.log("rendered Vector3");var e=this.props,t=e.x,n=e.y,r=e.z,i=e.unitConversion,a=void 0===i?1:i,o=e.onChange,s=e.name;return Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:s}),Object(j.jsx)("label",{children:"X:"}),Object(j.jsx)(We,{value:t*a,onChange:function(e){o(e/a,n,r)}}),Object(j.jsx)("label",{children:"Y:"}),Object(j.jsx)(We,{value:n*a,onChange:function(e){o(t,e/a,r)}}),Object(j.jsx)("label",{children:"Z:"}),Object(j.jsx)(We,{value:r*a,onChange:function(e){o(t,n,e/a)}})]})}}]),n}(r.PureComponent),qe=function(e){var t=r.useState(e.value),n=Object(Ue.a)(t,2),i=n[0],a=n[1],o=r.useState(!1),s=Object(Ue.a)(o,2),c=s[0],l=s[1];return Object(j.jsx)("input",{className:"string-input",value:c?i:e.value,size:20,onChange:function(e){c&&a(e.target.value)},onBlur:function(t){i!==e.value&&e.onChange(i),l(!1)},onFocus:function(t){i!==e.value&&a(e.value),l(!0)},onKeyDown:function(t){"Enter"===t.key&&i!==e.value&&e.onChange(i)}})},Xe=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeName=function(e){r.props.object3d.name=e,r.props.updateProperties()},r.onChangePosition=function(e,t,n){r.props.object3d.position.set(e,t,n),r.props.updateProperties()},r.onChangeScale=function(e,t,n){r.props.object3d.scale.set(e,t,n),r.props.updateProperties()},r.onChangeRotation=function(e,t,n){r.props.object3d.rotation.set(e,t,n),r.props.updateProperties()},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return console.log("rendered objectProperties"),Object(j.jsxs)("div",{className:"property-container",children:[Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:"Name:"}),Object(j.jsx)(qe,{value:e.props.object3d.name,onChange:e.onChangeName})]})}}),Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(Ge,{name:"Position",x:e.props.object3d.position.x,y:e.props.object3d.position.y,z:e.props.object3d.position.z,onChange:e.onChangePosition})}}),Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(Ge,{name:"Rotation",x:e.props.object3d.rotation.x,y:e.props.object3d.rotation.y,z:e.props.object3d.rotation.z,onChange:e.onChangeRotation,unitConversion:180/Math.PI})}}),Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(Ge,{name:"Scale",x:e.props.object3d.scale.x,y:e.props.object3d.scale.y,z:e.props.object3d.scale.z,onChange:e.onChangeScale})}})]})}}]),n}(r.PureComponent),He=n(41),Qe=n(192);n(332);function Ye(e){return"rgba(".concat(255*e.x|0,",").concat(255*e.y|0,",").concat(255*e.z|0,",").concat(e.w,")")}var Ze=function(e){var t=r.useState(!1),n=Object(Ue.a)(t,2),i=n[0],a=n[1],o=e.color,s=e.onChange;return Object(j.jsxs)("div",{className:"color-editor",children:[Object(j.jsx)("button",{style:{backgroundColor:Ye(o),height:"20px"},onClick:function(){a(!i)}}),Ye(o),i?Object(j.jsxs)("div",{className:"popover",children:[Object(j.jsx)("div",{className:"cover",onClick:function(){a(!1)}}),Object(j.jsx)(Qe.a,{color:{r:255*o.x|0,g:255*o.y|0,b:255*o.z|0,a:o.w},onChange:function(e){var t=new k.x;t.x=Math.min(255,e.rgb.r)/255,t.y=Math.min(255,e.rgb.g)/255,t.z=Math.min(255,e.rgb.b)/255,t.w=e.rgb.a,s(t)}})]}):null]})},$e=(n(333),n(9)),Ke=n(8);function et(e,t,n){return e*(1-n)+t*n}var tt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).x=function(t){return et(e.props.xFrom,e.props.xTo,t)},e.y=function(t){return et(e.props.yFrom,e.props.yTo,t)},e}return Object(c.a)(n,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=t.xFrom,r=t.yFrom,i=t.xTo,a=t.yTo;return e.xFrom!==n||e.yFrom!==r||e.xTo!==i||e.yTo!==a}}]),n}(i.a.Component),nt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"shouldComponentUpdate",value:function(e){if(Object($e.a)(Object(Ke.a)(n.prototype),"shouldComponentUpdate",this).call(this,e))return!0;var t=this.props,r=t.curveColor,i=t.curveWidth,a=t.value,o=Object(Ue.a)(a.p,4);o[0],o[1],o[2],o[3];return e.curveColor!==r||e.curveWidth!==i||e.value!==a}},{key:"render",value:function(){var e=this.props,t=e.curveColor,n=e.curveWidth,r=e.value,i=this.x,a=this.y,o=Math.floor((i(1)-i(0))/5),s="M".concat(i(0),",").concat(a(r.genValue(0))," ");if(o>0)for(var c=1/o;c<=1;c+=1/o)s+="L".concat(i(c),",").concat(a(r.genValue(c))," ");return s+="L".concat(i(1),",").concat(a(r.genValue(1))," "),Object(j.jsx)("path",{fill:"none",stroke:t,strokeWidth:n,d:s})}}]),n}(tt),rt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"shouldComponentUpdate",value:function(e){if(Object($e.a)(Object(Ke.a)(n.prototype),"shouldComponentUpdate",this).call(this,e))return!0;var t=this.props,r=t.xstart,i=t.ystart,a=t.handleRadius,o=t.handleColor,s=t.hover,c=t.down,l=t.background,u=t.handleStroke,d=t.xval,h=t.yval,p=t.onMouseEnter,m=t.onMouseLeave,v=t.onMouseDown;return e.xstart!==r||e.ystart!==i||e.handleRadius!==a||e.handleColor!==o||e.hover!==s||e.down!==c||e.background!==l||e.handleStroke!==u||e.xval!==d||e.yval!==h||e.onMouseDown!==v||e.onMouseLeave!==m||e.onMouseEnter!==p}},{key:"render",value:function(){var e=this.x,t=this.y,n=this.props,r=n.xstart,i=n.ystart,a=n.handleRadius,o=n.handleColor,s=n.hover,c=n.down,l=n.background,u=n.handleStroke,d=n.xval,h=n.yval,p=n.onMouseEnter,m=n.onMouseLeave,v=n.onMouseDown,f=e(r),w=t(i),b=e(d),g=t(h),x=Math.atan2(g-w,b-f),y=b-a*Math.cos(x),O=g-a*Math.sin(x);return Object(j.jsxs)("g",{children:[Object(j.jsx)("line",{stroke:o,strokeWidth:s||c?1+u:u,x1:y,y1:O,x2:f,y2:w}),Object(j.jsx)("circle",{cx:b,cy:g,r:a,stroke:o,strokeWidth:c?2*u:u,fill:c?l:o,onMouseEnter:p,onMouseLeave:m,onMouseDown:v})]})}}]),n}(tt),it=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).rootRef=Object(r.createRef)(),i.positionForEvent=function(e){if(i.rootRef.current){var t=i.rootRef.current.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]}return[0,0]},i.x=function(e){},i.y=function(e){},i.inversex=function(e){},i.inversey=function(e){},i.onDownLeave=function(e){i.state.down&&(i.onDownMove(e),i.setState({down:-1,hover:-1}))},i.onDownMove=function(e){if(i.state.down>=0){e.preventDefault();var t=i.positionForEvent(e),n=Object(Ue.a)(t,2),r=n[0],a=n[1],o=new Q(i.props.value.functions),s=(i.props.width,i.state.curve),c=o.getFunction(s);if(0===i.state.down){var l=c.p[0];if(c.p[0]=(i.props.height-a)/i.props.height,c.p[1]+=c.p[0]-l,o.setStartX(s,r/i.props.width),s-1>=0){var u=o.getFunction(s-1);u.p[3]=(i.props.height-a)/i.props.height,u.p[2]+=c.p[0]-l,o.setFunction(s-1,o.getFunction(s-1).clone())}o.setFunction(s,c.clone())}if(3===i.state.down){var d=c.p[3];if(c.p[3]=(i.props.height-a)/i.props.height,c.p[2]+=c.p[3]-d,o.setEndX(s,r/i.props.width),s+1<o.numOfFunctions){var h=o.getFunction(s+1);h.p[0]=(i.props.height-a)/i.props.height,h.p[1]+=c.p[3]-d,o.setFunction(s+1,o.getFunction(s+1).clone())}o.setFunction(s,c.clone())}1===i.state.down&&(c.p[1]=(i.props.height-a)/i.props.height,o.setFunction(s,c.clone())),2===i.state.down&&(c.p[2]=(i.props.height-a)/i.props.height,o.setFunction(s,c.clone())),i.props.onChange&&i.props.onChange(o)}},i.onDownUp=function(){i.setState({down:-1})},i.state={curve:-1,down:-1,hover:-1},i}return Object(c.a)(n,[{key:"onEnterHandle",value:function(e,t){this.state.down||this.setState({hover:t,curve:e})}},{key:"onDownHandle",value:function(e,t,n){n.preventDefault(),this.setState({hover:-1,down:t,curve:e})}},{key:"onLeaveHandle",value:function(){this.state.down||this.setState({hover:-1})}},{key:"render",value:function(){for(var e=this,t=this.props,r=t.width,i=t.height,a=t.value,o=t.curveWidth,s=void 0===o?1:o,c=t.curveColor,l=void 0===c?"#000":c,u=t.handleRadius,d=void 0===u?n.defaultP.handleRadius:u,h=t.handleColor,p=void 0===h?"#f00":h,m=t.handleStroke,v=void 0===m?1:m,f=t.background,w=void 0===f?"#fff":f,b=this.state,g=b.curve,x=b.down,y=b.hover,O=[],S=function(t){var n=a.getStartX(t),o=a.getEndX(t),c=a.getFunction(t),u=c.getSlope(0),h=c.getSlope(1);O.push(Object(j.jsxs)("g",{children:[Object(j.jsx)(nt,{xFrom:n*r,xTo:o*r,yFrom:i,yTo:0,curveColor:l,curveWidth:s,value:c}),Object(j.jsx)(rt,{xFrom:n*r,xTo:o*r,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,0,n)},onMouseEnter:function(n){return e.onEnterHandle(t,0)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:0,ystart:c.p[0],xval:0,yval:c.p[0],handleRadius:d,handleColor:p,down:g===t&&0===x,hover:g===t&&0===y,handleStroke:v,background:w}),Object(j.jsx)(rt,{xFrom:n*r,xTo:o*r,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,1,n)},onMouseEnter:function(n){return e.onEnterHandle(t,1)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:0,ystart:c.p[0],xval:1/3,yval:1/3*u+c.p[0],handleRadius:d,handleColor:p,down:g===t&&1===x,hover:g===t&&1===y,handleStroke:v,background:w}),Object(j.jsx)(rt,{xFrom:n*r,xTo:o*r,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,2,n)},onMouseEnter:function(n){return e.onEnterHandle(t,2)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:1,ystart:c.p[3],xval:1-1/3,yval:c.p[3]-1/3*h,handleRadius:d,handleColor:p,down:g===t&&2===x,hover:g===t&&2===y,handleStroke:v,background:w}),Object(j.jsx)(rt,{xFrom:n*r,xTo:o*r,yFrom:i,yTo:0,onMouseDown:function(n){return e.onDownHandle(t,3,n)},onMouseEnter:function(n){return e.onEnterHandle(t,3)},onMouseLeave:function(t){return e.onLeaveHandle()},xstart:1,ystart:c.p[3],xval:1,yval:c.p[3],handleRadius:d,handleColor:p,down:g===t&&3===x,hover:g===t&&3===y,handleStroke:v,background:w})]},t))},C=0;C<a.numOfFunctions;C++)S(C);return Object(j.jsx)("div",{ref:this.rootRef,onMouseMove:this.onDownMove,onMouseUp:this.onDownUp,onMouseLeave:this.onDownLeave,children:Object(j.jsx)("svg",{width:r,height:i,children:O})})}}]),n}(r.PureComponent);it.defaultP={padding:[0,0,0,0],handleRadius:4};var at={value:["constant","intervalValue"],functionValue:["piecewiseBezier"],color:["color","randomColor"],functionColor:["colorRange","gradient"]},ot=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).changeEditor=function(e){var t=null;switch(e.target.value){case"constant":t=new G(0);break;case"color":t=new te(new k.x(1,1,1,1));break;case"intervalValue":t=new q(0,1);break;case"colorRange":t=new ee(new k.x(0,0,0,1),new k.x(1,1,1,1));break;case"randomColor":t=new K(new k.x(0,0,0,1),new k.x(1,1,1,1));break;case"piecewiseBezier":t=new Q}t&&r.props.updateGenerator(t)},r.changeValue=function(e){r.props.updateGenerator(new G(e))},r.changeColor=function(e){r.props.updateGenerator(new te(e))},r.changeValueA=function(e){var t=r.props.generator;r.props.updateGenerator(new q(e,t.b))},r.changeValueB=function(e){var t=r.props.generator;r.props.updateGenerator(new q(t.a,e))},r.changeColorRangeA=function(e){var t=r.props.generator;r.props.updateGenerator(new ee(e,t.b))},r.changeColorRangeB=function(e){var t=r.props.generator;r.props.updateGenerator(new ee(t.a,e))},r.changeRandomColorA=function(e){var t=r.props.generator;r.props.updateGenerator(new K(e,t.b))},r.changeRandomColorB=function(e){var t=r.props.generator;r.props.updateGenerator(new K(t.a,e))},r.changeCurve=function(e){r.props.updateGenerator(new Q(e.functions))};at[e.allowedType[0]][0];return r.state={open:!1},r}return Object(c.a)(n,[{key:"getEditorType",value:function(e){return e instanceof G?"constant":e instanceof q?"intervalValue":e instanceof Q?"piecewiseBezier":e instanceof te?"color":e instanceof K?"randomColor":e instanceof ee?"colorRange":e instanceof ke?"gradient":"constant"}},{key:"render",value:function(){var e,t=this.props,n=t.name,i=t.generator,a=t.allowedType,o=[],s=Object(He.a)(a);try{for(s.s();!(e=s.n()).done;){var c,l=e.value,u=Object(He.a)(at[l]);try{for(u.s();!(c=u.n()).done;){var d=c.value;o.push(d)}}catch(m){u.e(m)}finally{u.f()}}}catch(m){s.e(m)}finally{s.f()}var h,p=this.getEditorType(i);switch(p){case"constant":h=Object(j.jsx)(r.Fragment,{children:Object(j.jsx)(We,{value:i.value,onChange:this.changeValue})});break;case"color":h=Object(j.jsx)(r.Fragment,{children:Object(j.jsx)(Ze,{color:i.color,onChange:this.changeColor})});break;case"intervalValue":h=Object(j.jsxs)(r.Fragment,{children:[Object(j.jsx)(We,{value:i.a,onChange:this.changeValueA}),"-",Object(j.jsx)(We,{value:i.b,onChange:this.changeValueB})]});break;case"piecewiseBezier":h=Object(j.jsx)(r.Fragment,{children:Object(j.jsx)(it,{height:40,width:240,value:i,onChange:this.changeCurve})});break;case"colorRange":h=Object(j.jsxs)(r.Fragment,{children:[Object(j.jsx)(Ze,{color:i.a,onChange:this.changeColorRangeA}),"-",Object(j.jsx)(Ze,{color:i.b,onChange:this.changeColorRangeB})]});break;case"randomColor":h=Object(j.jsxs)(r.Fragment,{children:[Object(j.jsx)(Ze,{color:i.a,onChange:this.changeRandomColorA}),"-",Object(j.jsx)(Ze,{color:i.b,onChange:this.changeRandomColorB})]})}return Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:n}),h,Object(j.jsx)("select",{className:"editor-select",onChange:this.changeEditor,value:p,children:o.map((function(e){return Object(j.jsx)("option",{value:e,children:e},e)}))})]})}}]),n}(r.PureComponent),st=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeStartSpeed=function(e){console.log("change start speed"),r.props.particleSystem.startSpeed=e,r.props.updateProperties()},r.onChangeStartLife=function(e){console.log("change start life"),r.props.particleSystem.startLife=e,r.props.updateProperties()},r.onChangeStartSize=function(e){console.log("change start size"),r.props.particleSystem.startSize=e,r.props.updateProperties()},r.onChangeStartColor=function(e){console.log("change start color"),r.props.particleSystem.startColor=e,r.props.updateProperties()},r.OnChangeStartRotation=function(e){console.log("change start rotation"),r.props.particleSystem.startRotation=e,r.props.updateProperties()},r.OnChangeEmissionOverTime=function(e){console.log("change start rotation"),r.props.particleSystem.emissionOverTime=e,r.props.updateProperties()},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this;console.log("rendered objectProperties");var t=["value","functionValue"],n=["color","functionColor"];return Object(j.jsxs)("div",{className:"property-container",children:[Object(j.jsx)(Ve,{children:function(n){return n&&Object(j.jsx)(ot,{name:"Start Life",allowedType:t,generator:e.props.particleSystem.startLife,updateGenerator:e.onChangeStartLife})}}),Object(j.jsx)(Ve,{children:function(n){return n&&Object(j.jsx)(ot,{name:"Start Size",allowedType:t,generator:e.props.particleSystem.startSize,updateGenerator:e.onChangeStartSize})}}),Object(j.jsx)(Ve,{children:function(n){return n&&Object(j.jsx)(ot,{name:"Start Speed",allowedType:t,generator:e.props.particleSystem.startSpeed,updateGenerator:e.onChangeStartSpeed})}}),Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(ot,{name:"Start Color",allowedType:n,generator:e.props.particleSystem.startColor,updateGenerator:e.onChangeStartColor})}}),Object(j.jsx)(Ve,{children:function(n){return n&&Object(j.jsx)(ot,{name:"Start Rotation",allowedType:t,generator:e.props.particleSystem.startRotation,updateGenerator:e.OnChangeStartRotation})}}),Object(j.jsx)(Ve,{children:function(n){return n&&Object(j.jsx)(ot,{name:"Emission Over Time",allowedType:t,generator:e.props.particleSystem.emissionOverTime,updateGenerator:e.OnChangeEmissionOverTime})}})]})}}]),n}(r.PureComponent),ct=n(194),lt=n(15),ut=n(413),dt=n(414),ht=n(415),pt=n(186),mt=n.n(pt),vt=n(416),ft=n(417),wt=n(418),bt=n(419),gt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).handleChange=function(e){e.target.files&&r.props.onChange(e.target.files)},r}return Object(c.a)(n,[{key:"render",value:function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)("input",{accept:"image/*",type:"file",id:"contained-button-file",style:{display:"none"},onChange:this.handleChange}),Object(j.jsx)("label",{htmlFor:"contained-button-file",children:Object(j.jsx)(d.a,{variant:"contained",color:"primary",component:"span",children:"Upload"})})]})}}]),n}(r.Component),xt=(n(334),function(e){var t=e.children,n=e.onClose,r=Object(ct.a)(e,["children","onClose"]);return Object(j.jsxs)(ut.a,Object(Je.a)(Object(Je.a)({sx:{margin:0,padding:function(e){return e.spacing(2)}}},r),{},{children:[Object(j.jsx)(f.a,{variant:"h6",children:t}),n?Object(j.jsx)(w.a,{"aria-label":"close",sx:{position:"absolute",right:function(e){return e.spacing(1)},top:function(e){return e.spacing(1)},color:function(e){return e.palette.grey[500]}},onClick:n,children:Object(j.jsx)(mt.a,{})}):null]}))}),jt=Object(lt.a)(dt.a)((function(e){return{root:{padding:e.theme.spacing(2)}}})),yt=Object(lt.a)(ht.a)((function(e){return{root:{margin:0,padding:e.theme.spacing(1)}}})),Ot=function(e){var t=Object(r.useState)(0),n=Object(Ue.a)(t,2),i=n[0],a=n[1];return Object(j.jsxs)(vt.a,{onClose:e.handleClose,"aria-labelledby":"customized-dialog-title",open:e.open,children:[Object(j.jsx)(xt,{id:"customized-dialog-title",onClose:e.handleClose,children:"Picker Texture"}),Object(j.jsx)(jt,{dividers:!0,children:Object(j.jsx)(m.a,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:function(e){return e.palette.background.paper}},children:Object(j.jsx)(ft.a,{rowHeight:160,sx:{width:500,height:450},cols:3,children:e.textures.map((function(e,t){return Object(j.jsxs)(wt.a,{cols:1,onClick:function(){a(t)},className:t===i?"selected-tile":"",children:[Object(j.jsx)("img",{src:e.img,alt:e.texture.name}),Object(j.jsx)(bt.a,{title:e.texture.name,subtitle:Object(j.jsxs)("span",{children:["by: ",e.texture.name]})})]},e.img)}))})})}),Object(j.jsxs)(yt,{children:[Object(j.jsx)(gt,{onChange:e.handleUpload}),Object(j.jsx)(d.a,{variant:"contained",onClick:function(){e.handleSelect(e.textures[i]),e.handleClose()},children:"Confirm"})]})]})},St=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeSpeedFactor=function(e){r.props.particleSystem.speedFactor=e,r.props.updateProperties()},r.onChangeRenderOrder=function(e){r.props.particleSystem.renderOrder=e,r.props.updateProperties()},r.onChangeStartTile=function(e){r.props.particleSystem.startTileIndex=e,r.props.updateProperties()},r.onChangeUTileCount=function(e){r.props.particleSystem.uTileCount=e,r.props.updateProperties()},r.onChangeVTileCount=function(e){r.props.particleSystem.vTileCount=e,r.props.updateProperties()},r.onChangeBlending=function(e){switch(e.target.value){case"Normal":r.props.particleSystem.blending=k.m;break;case"Additive":r.props.particleSystem.blending=k.a}r.props.updateProperties()},r.getValueOfBlending=function(e){switch(e){case k.m:return"Normal";case k.a:return"Additive"}},r.onChangeRenderMode=function(e){switch(e.target.value){case"BillBoard":r.props.particleSystem.renderMode=le.BillBoard,r.props.particleSystem.speedFactor=0;break;case"LocalSpace":r.props.particleSystem.renderMode=le.LocalSpace,r.props.particleSystem.speedFactor=0;break;case"StretchedBillBoard":r.props.particleSystem.renderMode=le.StretchedBillBoard}r.props.updateProperties()},r.getValueOfRenderMode=function(e){switch(e){case le.BillBoard:return"BillBoard";case le.LocalSpace:return"LocalSpace";case le.StretchedBillBoard:return"StretchedBillBoard"}},r.onChangeWorldSpace=function(e){switch(e.target.value){case"True":r.props.particleSystem.worldSpace=!0;break;case"False":r.props.particleSystem.worldSpace=!1}r.props.updateProperties()},r.getValueOfBoolean=function(e){return e?"True":"False"},r.onUploadTexture=function(e){return function(t){console.log("upload texture");var n=document.createElement("img"),r=new k.t(n);if(n.onload=function(){r.needsUpdate=!0},t&&t[0]){var i=new FileReader;i.onload=function(e){n.src=i.result},i.readAsDataURL(t[0]),r.name=t[0].name;var a={img:URL.createObjectURL(t[0]),texture:r};e.actions.addTexture(a)}}},r.onChangeTexture=function(e){console.log("change texture"),r.props.particleSystem.texture=e.texture,r.props.updateProperties()},r.closeTexturePicker=function(){r.setState({texturePickerOpen:!1})},r.openTexturePicker=function(){r.setState({texturePickerOpen:!0})},r.state={texturePickerOpen:!1},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return console.log("rendered particleRendererProperties"),Object(j.jsxs)("div",{className:"property-container",children:[Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:"RenderMode"}),Object(j.jsxs)("select",{className:"editor-select",onChange:this.onChangeRenderMode,value:this.getValueOfRenderMode(this.props.particleSystem.renderMode),children:[Object(j.jsx)("option",{value:"BillBoard",children:"BillBoard"},0),Object(j.jsx)("option",{value:"LocalSpace",children:"Local Space BillBoard"},1),Object(j.jsx)("option",{value:"StretchedBillBoard",children:"Stretched BillBoard"},2)]})]}),this.props.particleSystem.renderMode===le.StretchedBillBoard&&Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:"SpeedFactor"}),Object(j.jsx)(We,{value:this.props.particleSystem.speedFactor,onChange:this.onChangeSpeedFactor})]}),Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:"World Space"}),Object(j.jsxs)("select",{className:"editor-select",onChange:this.onChangeWorldSpace,value:this.getValueOfBoolean(this.props.particleSystem.worldSpace),children:[Object(j.jsx)("option",{value:"True",children:"True"},0),Object(j.jsx)("option",{value:"False",children:"False"},1)]})]}),Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:"Blend Mode"}),Object(j.jsxs)("select",{className:"editor-select",onChange:this.onChangeBlending,value:this.getValueOfBlending(this.props.particleSystem.blending),children:[Object(j.jsx)("option",{value:"Normal",children:"Normal"},0),Object(j.jsx)("option",{value:"Additive",children:"Additive"},1)]})]}),Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:"RenderOrder:"}),Object(j.jsx)(We,{value:this.props.particleSystem.renderOrder,onChange:this.onChangeRenderOrder})]}),Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:"UVTile"}),Object(j.jsx)("label",{children:"Column:"}),Object(j.jsx)(We,{value:this.props.particleSystem.uTileCount,onChange:this.onChangeUTileCount}),Object(j.jsx)("label",{children:"Row:"}),Object(j.jsx)(We,{value:this.props.particleSystem.vTileCount,onChange:this.onChangeVTileCount})]}),Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:"Start Tile Index"}),Object(j.jsx)(We,{value:this.props.particleSystem.startTileIndex,onChange:this.onChangeStartTile})]}),Object(j.jsx)(Ve,{children:function(t){for(var n,r=0;r<t.textures.length;r++)t.textures[r].texture===e.props.particleSystem.texture&&(n=t.textures[r]);var i=1,a=1;return n&&n.texture.image&&(i=n.texture.image.width/e.props.particleSystem.uTileCount,a=n.texture.image.height/e.props.particleSystem.vTileCount),Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:"Texture"}),n&&Object(j.jsx)("img",{className:"texture-preview",src:n.img,alt:n.texture.name,style:{objectPosition:"-".concat(e.props.particleSystem.startTileIndex%e.props.particleSystem.uTileCount*i,"px -").concat(Math.floor(e.props.particleSystem.startTileIndex/e.props.particleSystem.uTileCount)*a,"px"),width:i,height:a}}),Object(j.jsx)(d.a,{onClick:e.openTexturePicker,variant:"contained",children:"Pick"})]})}}),Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(Ot,{handleClose:e.closeTexturePicker,handleSelect:e.onChangeTexture,handleUpload:e.onUploadTexture(t),open:e.state.texturePickerOpen,textures:t.textures})}})]})}}]),n}(r.PureComponent),Ct=n(187),kt=n.n(Ct),Tt=n(146),Bt=(n(335),function(e){var t=r.useState(e.value),n=Object(Ue.a)(t,2),i=n[0],a=n[1],o=r.useState(!1),s=Object(Ue.a)(o,2),c=s[0],l=s[1];return Object(j.jsx)(kt.a,{value:c?i:e.value,onValueChange:function(e){c&&a(e)},highlight:function(e){return Object(Tt.highlight)(e,Tt.languages.javascript,"javascript")},padding:10,onBlur:function(t){i!==e.value&&e.onChange(i),l(!1)},onFocus:function(t){i!==e.value&&a(e.value),l(!0)},style:{fontFamily:'"Consolas", monospace',fontSize:12}})}),Pt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onChangeScript=function(e){null===r.props.object3d.userData&&(r.props.object3d.userData={}),r.props.object3d.userData.script=e,r.props.object3d.userData.func=new Function("delta",e),r.props.updateProperties()},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(j.jsx)("div",{children:Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"script",children:"Script:"}),Object(j.jsx)(Bt,{value:e.props.object3d.userData.script||"",onChange:e.onChangeScript})]})}})})}}]),n}(r.PureComponent),Mt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).getValueOfShape=function(e){return r.props.particleSystem.emitterShape instanceof he?"PointEmitter":r.props.particleSystem.emitterShape instanceof ue?"ConeEmitter":r.props.particleSystem.emitterShape instanceof de?"SphereEmitter":r.props.particleSystem.emitterShape instanceof pe?"DonutEmitter":""},r.onChangeShape=function(e){switch(e.target.value){case"PointEmitter":r.props.particleSystem.emitterShape instanceof he||(r.props.particleSystem.emitterShape=new he,r.props.updateProperties());break;case"ConeEmitter":r.props.particleSystem.emitterShape instanceof ue||(r.props.particleSystem.emitterShape=new ue,r.props.updateProperties());break;case"SphereEmitter":r.props.particleSystem.emitterShape instanceof de||(r.props.particleSystem.emitterShape=new de,r.props.updateProperties());break;case"DonutEmitter":r.props.particleSystem.emitterShape instanceof pe||(r.props.particleSystem.emitterShape=new pe,r.props.updateProperties())}},r.onChangeKeyValue=function(e,t){r.props.particleSystem.emitterShape[e]=t,r.props.updateProperties()},r}return Object(c.a)(n,[{key:"renderShapeProperties",value:function(){var e=this,t=[],n=function(n){t.push(Object(j.jsxs)("div",{className:"property",children:[Object(j.jsxs)("label",{className:"name",children:[n,":"]}),Object(j.jsx)(We,{value:e.props.particleSystem.emitterShape[n],onChange:function(t){return e.onChangeKeyValue(n,t)}})]},n))};for(var r in this.props.particleSystem.emitterShape)n(r);return t}},{key:"render",value:function(){var e=this;return Object(j.jsxs)("div",{className:"property-container",children:[Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsxs)("div",{className:"property",children:[Object(j.jsx)("label",{className:"name",children:"Shape"}),Object(j.jsxs)("select",{className:"editor-select",onChange:e.onChangeShape,value:e.getValueOfShape(e.props.particleSystem.emitterShape),children:[Object(j.jsx)("option",{value:"PointEmitter",children:"PointEmitter"},0),Object(j.jsx)("option",{value:"ConeEmitter",children:"ConeEmitter"},1),Object(j.jsx)("option",{value:"SphereEmitter",children:"SphereEmitter"},2),Object(j.jsx)("option",{value:"DonutEmitter",children:"DonutEmitter"},3)]})]})}}),Object(j.jsx)(Ve,{children:function(t){return t&&e.renderShapeProperties()}})]})}}]),n}(i.a.PureComponent),zt=n(420),Lt=n(399),Rt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).getSystems=function(){var e=[];return r.props.object3d instanceof J&&e.push(r.props.object3d.system),r.props.object3d.traverse((function(t){t instanceof J&&e.push(t.system)})),e},r.checkPause=function(e){var t=!0;return e.forEach((function(e){e.paused||(t=!1)})),t},r.togglePause=function(){var e=r.getSystems();r.checkPause(e)?e.forEach((function(e){e.play()})):e.forEach((function(e){e.pause()})),r.props.updateProperties()},r.onRestart=function(){r.getSystems().forEach((function(e){e.restart()})),r.props.updateProperties()},r.onStop=function(){r.getSystems().forEach((function(e){e.restart(),e.pause()})),r.props.updateProperties()},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(j.jsxs)("div",{children:[Object(j.jsx)(Lt.a,{color:"primary","aria-label":"primary button group"}),Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsxs)(zt.a,{color:"primary","aria-label":"primary button group",children:[Object(j.jsx)(d.a,{disabled:!e.checkPause(e.getSystems()),onClick:e.togglePause,children:"Play"}),Object(j.jsx)(d.a,{disabled:e.checkPause(e.getSystems()),onClick:e.togglePause,children:"Pause"}),Object(j.jsx)(d.a,{onClick:e.onRestart,children:"Restart"}),Object(j.jsx)(d.a,{onClick:e.onStop,children:"Stop"})]})}})]})}}]),n}(r.PureComponent),It=n(407),Ft=n(408),Et=n(401),Nt=n(50),Dt=n.n(Nt),Vt=(n(336),n(188)),_t=n.n(Vt),At=n(32),Ut=n(412),Jt=n(396),Wt=n(390),Gt=n(391),qt=n(393);function Xt(e){var t=r.useState([0,1,2,3]),n=Object(Ue.a)(t,2),i=n[0],a=n[1],o=r.useState(1),s=Object(Ue.a)(o,2),c=s[0],l=s[1],u=r.useState(null),v=Object(Ue.a)(u,2),f=v[0],w=v[1],b=function(t){return function(){var n;switch(t){case"ColorOverLife":n=new re(new ee(new k.x(1,1,1,1),new k.x(0,0,0,1)));break;case"RotationOverLife":n=new ie(new Q([[new H(0,.3333,.6667,1),0]]));break;case"SizeOverLife":n=new ae(new Q([[new H(0,.3333,.6667,1),0]]));break;case"FrameOverLife":n=new se(new Q([[new H(0,.3333,.6667,1),0]]));break;case"OrbitOverLife":n=new ce(new Q([[new H(0,.3333,.6667,1),0]]));break;case"SpeedOverLife":n=new oe(new Q([[new H(1,.6667,.3333,0),0]]))}n&&(e.behaviors.push(n),e.updateProperties()),w(null)}},g=function(t){return function(n){var r=e.behaviors[t];switch(r.type){case"ColorOverLife":case"SizeOverLife":case"FrameOverLife":r.func=n;break;case"RotationOverLife":case"OrbitOverLife":r.angularVelocityFunc=n}console.log("changing"),e.updateProperties()}};return Object(j.jsxs)(m.a,{sx:{width:"100%"},children:[Object(j.jsxs)(zt.a,{color:"primary","aria-label":"primary button group",children:[Object(j.jsx)(d.a,{color:"inherit","aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){w(e.currentTarget)},id:"new-button",children:"New"}),Object(j.jsxs)(h.a,{id:"simple-menu",anchorEl:f,keepMounted:!0,open:Boolean(f),onClose:function(){w(null)},children:[Object(j.jsx)(p.a,{onClick:b("SizeOverLife"),children:"SizeOverLife"}),Object(j.jsx)(p.a,{onClick:b("ColorOverLife"),children:"ColorOverLife"}),Object(j.jsx)(p.a,{onClick:b("RotationOverLife"),children:"RotationOverLife"}),Object(j.jsx)(p.a,{onClick:b("FrameOverLife"),children:"FrameOverLife"}),Object(j.jsx)(p.a,{onClick:b("OrbitOverLife"),children:"OrbitOverLife"}),Object(j.jsx)(p.a,{onClick:b("SpeedOverLife"),children:"SpeedOverLife"})]}),Object(j.jsx)(d.a,{onClick:function(){e.behaviors.splice(c,1),e.updateProperties()},children:"Remove"})]}),Object(j.jsx)(Ut.a,{dense:!0,sx:{width:"100%",backgroundColor:function(e){return e.palette.background.paper}},children:Object(j.jsx)(Ve,{children:function(t){return t&&e.behaviors.map((function(e,t){var n,r,o,s="behavior-list-label-".concat(t),u=null;switch(e.type){case"ColorOverLife":n=["functionColor"],u=e.func;break;case"RotationOverLife":n=["functionValue","value"],u=e.angularVelocityFunc;break;case"SizeOverLife":case"FrameOverLife":case"SpeedOverLife":n=["functionValue"],u=e.func;break;case"OrbitOverLife":n=["functionValue"],u=e.angularVelocityFunc;break;default:n=["functionValue"]}return u&&(r=Object(j.jsx)(ot,{name:"Func",allowedType:n,generator:u,updateGenerator:g(t)})),Object(j.jsxs)(Jt.a,{selected:c===t,onClick:function(e){return function(e,t){l(t)}(0,t)},children:[Object(j.jsx)(Wt.a,{children:Object(j.jsx)(qt.a,{edge:"end",onChange:(o=t,function(){var e=i.indexOf(o),t=Object(At.a)(i);-1===e?t.push(o):t.splice(e,1),a(t)}),checked:-1!==i.indexOf(t),inputProps:{"aria-labelledby":s}})}),Object(j.jsx)(Gt.a,{id:s,primary:e.type,secondary:r})]},t)}))}})})]})}var Ht=r.memo(Xt),Qt=Object(lt.a)((function(e){return Object(j.jsx)(Et.a,Object(Je.a)({disableGutters:!0,elevation:0,square:!0},e))}))((function(e){var t=e.theme;return{border:"1px solid ".concat(t.palette.divider),"&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"}}})),Yt=Object(lt.a)((function(e){return Object(j.jsx)(It.a,Object(Je.a)({expandIcon:Object(j.jsx)(_t.a,{sx:{fontSize:"0.9rem"}})},e))}))((function(e){var t=e.theme;return{minHeight:0,backgroundColor:"dark"===t.palette.mode?"rgba(255, 255, 255, .05)":"rgba(0, 0, 0, .03)",flexDirection:"row-reverse","& .MuiAccordionSummary-content":{marginLeft:t.spacing(1),marginTop:t.spacing(1),marginBottom:t.spacing(1)},"& .MuiAccordionSummary-expandIconWrapper.Mui-expanded":{transform:"rotate(90deg)"}}})),Zt=Object(lt.a)(Ft.a)((function(e){return{padding:e.theme.spacing(2),borderTop:"1px solid rgba(0, 0, 0, .125)"}})),$t=Object(lt.a)(f.a)((function(e){return{fontWeight:e.theme.typography.fontWeightRegular}}));function Kt(e){var t=Object(r.useState)(["Object","EmitterShape","ParticleRenderer","ParticleEmitter","Behaviors","Script"]),n=Object(Ue.a)(t,2),i=n[0],a=n[1],o=function(e){return function(t,n){n?i.push(e):i.splice(i.indexOf(e),1),a(i)}};return Object(j.jsxs)(m.a,{sx:{width:"100%"},children:[Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(Rt,{object3d:e.object3d,updateProperties:t.updateProperties})}}),Object(j.jsxs)(Qt,{expanded:-1!==i.indexOf("Object"),onChange:o("Object"),children:[Object(j.jsx)(Yt,{expandIcon:Object(j.jsx)(Dt.a,{}),"aria-controls":"object-content",id:"object-header",children:Object(j.jsx)($t,{children:"Object"})}),Object(j.jsx)(Zt,{children:Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(Xe,{object3d:e.object3d,updateProperties:t.updateProperties})}})})]}),e.object3d instanceof J&&Object(j.jsxs)(Qt,{expanded:-1!==i.indexOf("EmitterShape"),onChange:o("EmitterShape"),children:[Object(j.jsx)(Yt,{expandIcon:Object(j.jsx)(Dt.a,{}),"aria-controls":"emitter-shape-content",id:"emitter-shape-header",children:Object(j.jsx)($t,{children:"Emitter Shape"})}),Object(j.jsx)(Zt,{children:Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(Mt,{particleSystem:e.object3d.system,updateProperties:t.updateProperties})}})})]}),e.object3d instanceof J&&Object(j.jsxs)(Qt,{expanded:-1!==i.indexOf("ParticleRenderer"),onChange:o("ParticleRenderer"),children:[Object(j.jsx)(Yt,{expandIcon:Object(j.jsx)(Dt.a,{}),"aria-controls":"particle-renderer-content",id:"particle-renderer-header",children:Object(j.jsx)($t,{children:"Particle Renderer"})}),Object(j.jsx)(Zt,{children:Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(St,{particleSystem:e.object3d.system,updateProperties:t.updateProperties})}})})]}),e.object3d instanceof J&&Object(j.jsxs)(Qt,{expanded:-1!==i.indexOf("ParticleEmitter"),onChange:o("ParticleEmitter"),children:[Object(j.jsx)(Yt,{expandIcon:Object(j.jsx)(Dt.a,{}),"aria-controls":"particle-emitter-content",id:"particle-emitter-header",children:Object(j.jsx)($t,{children:"Particle Emitter"})}),Object(j.jsx)(Zt,{children:Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(st,{particleSystem:e.object3d.system,updateProperties:t.updateProperties})}})})]}),e.object3d instanceof J&&Object(j.jsxs)(Qt,{expanded:-1!==i.indexOf("Behaviors"),onChange:o("Behaviors"),children:[Object(j.jsx)(Yt,{expandIcon:Object(j.jsx)(Dt.a,{}),"aria-controls":"behaviors-content",id:"behaviors-header",children:Object(j.jsx)($t,{children:"Behaviors"})}),Object(j.jsx)(Zt,{children:Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(Ht,{behaviors:e.object3d.system.behaviors,updateProperties:t.updateProperties})}})})]}),Object(j.jsxs)(Qt,{expanded:-1!==i.indexOf("Script"),onChange:o("Script"),children:[Object(j.jsx)(Yt,{expandIcon:Object(j.jsx)(Dt.a,{}),"aria-controls":"script-content",id:"script-header",children:Object(j.jsx)($t,{children:"Script"})}),Object(j.jsx)(Zt,{children:Object(j.jsx)(Ve,{children:function(t){return t&&Object(j.jsx)(Pt,{object3d:e.object3d,updateProperties:t.updateProperties})}})})]})]})}n(337),n(338);var en=n(34),tn=(n(347),n(422)),nn=n(398),rn=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"camelize",value:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")}},{key:"camelizeClass",value:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return e.toUpperCase()})).replace(/\s+/g,"")}},{key:"exportBezier",value:function(e){return"new Bezier(".concat(e.p[0],", ").concat(e.p[1],", ").concat(e.p[2],", ").concat(e.p[3],")")}},{key:"exportColor",value:function(e){return"new Vector4(".concat(e.x,", ").concat(e.y,", ").concat(e.z,", ").concat(e.w,")")}},{key:"exportFunction",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t instanceof G)return"new ConstantValue(".concat(t.value,")");if(t instanceof te)return"new ConstantColor(".concat(e.exportColor(t.color),")");if(t instanceof q)return"new IntervalValue(".concat(t.a,", ").concat(t.b,")");if(t instanceof ee)return"new ColorRange(".concat(e.exportColor(t.a),", ").concat(e.exportColor(t.b),")");if(t instanceof K)return"new RandomColor(".concat(e.exportColor(t.a),", ").concat(e.exportColor(t.b),")");if(t instanceof ke){for(var r="new Gradient(\n",i=0;i<t.functions.length-1;i++)r+=" ".repeat(n+4)+"[".concat(e.exportFunction(t.functions[i][0]),", ").concat(t.functions[i][1],"], ");return r+=" ".repeat(n+4)+"[".concat(e.exportFunction(t.functions[t.functions.length-1][0]),", ").concat(t.functions[t.functions.length-1][1],"]"),r+=" ".repeat(n)+")"}if(t instanceof Q){for(var a="new PiecewiseBezier(\n",o=0;o<t.functions.length-1;o++)a+=" ".repeat(n+4)+"[".concat(e.exportBezier(t.functions[o][0]),", ").concat(t.functions[o][1],"], ");return a+=" ".repeat(n+4)+"[".concat(e.exportBezier(t.functions[t.functions.length-1][0]),", ").concat(t.functions[t.functions.length-1][1],"]"),a+=" ".repeat(n)+")"}throw new Error}},{key:"exportParticleEmitter",value:function(t){var n=e.camelize(t.name),r=t.system,i="        this.".concat(n," = new ParticleSystem(renderer, {\n");i+="            duration: ".concat(r.duration,",\n"),i+="            looping: ".concat(r.looping,",\n"),i+="            startLife: ".concat(e.exportFunction(r.startLife),",\n"),i+="            startSpeed: ".concat(e.exportFunction(r.startSpeed),",\n"),i+="            startSize: ".concat(e.exportFunction(r.startSize),",\n"),i+="            startColor: ".concat(e.exportFunction(r.startColor),",\n"),i+="            worldSpace: ".concat(r.worldSpace,",\n"),i+="            maxParticle: ".concat(r.maxParticle,",\n"),i+="            emissionOverTime: ".concat(e.exportFunction(r.emissionOverTime),",\n"),i+="            emissionBursts: ".concat(r.emissionBursts,",\n"),i+="            shape: ".concat(e.exportShape(r.emitterShape),",\n"),i+="            texture: texture,\n",i+="            blending: ".concat(r.blending,",\n"),i+="            startTileIndex: ".concat(r.startTileIndex,",\n"),i+="            uTileCount: ".concat(r.uTileCount,",\n"),i+="            vTileCount: ".concat(r.vTileCount,",\n"),i+="            renderMode: ".concat(r.renderMode,",\n"),r.renderMode===le.StretchedBillBoard&&(i+="            speedFactor: ".concat(r.speedFactor,",\n")),i+="        });\n";for(var a=0;a<r.behaviors.length;a++)i+="        this.".concat(n,".addBehavior(").concat(e.exportBehavior(r.behaviors[a]),");\n");return i+="        this.".concat(n,".emitter.renderOrder = ").concat(r.emitter.renderOrder,";\n"),i+="        this.".concat(n,".emitter.name = '").concat(n,"';\n"),i+="        this.".concat(n,".emitter.rotation.set(").concat(r.emitter.rotation.x,", ").concat(r.emitter.rotation.y,", ").concat(r.emitter.rotation.z,");\n"),i+="        this.add(this.".concat(n,".emitter);\n"),i+="\n"}},{key:"exportShape",value:function(e){var t=e.toJSON();delete t.type;var n=JSON.stringify(t).replace(/"([^"]+)":/g,"$1:");return e instanceof he?"new PointEmitter()":e instanceof de?"new SphereEmitter("+n+")":e instanceof ue?"new ConeEmitter("+n+")":e instanceof pe?"new DonutEmitter("+n+")":void 0}},{key:"exportBehavior",value:function(t){var n;switch(t.type){case"ColorOverLife":case"SizeOverLife":case"SpeedOverLife":case"FrameOverLife":n=e.exportFunction(t.func);break;case"RotationOverLife":case"OrbitOverLife":n=e.exportFunction(t.angularVelocityFunc);break;default:n=t}return"new "+t.type+"("+n+")"}},{key:"exportCode",value:function(t){for(var n="export class ".concat(e.camelizeClass(t.name)," extends Group {\n"),r=0;r<t.children.length;r++)t.children[r]instanceof J&&(n+="    private ".concat(e.camelize(t.children[r].name),": ParticleSystem;\n"));n+="\n",n+="    constructor() {\n",n+="        super();\n",n+="        this.name = '".concat(t.name,"';\n"),n+='        let texture = new TextureLoader().load( "textures/texture1.png");\n',n+='        texture.name = "textures/texture1.png";\n';for(var i=0;i<t.children.length;i++)t.children[i]instanceof J&&(n+=e.exportParticleEmitter(t.children[i]));n+="    }\n",n+="\n",n+="    update(delta: number) {\n";for(var a=0;a<t.children.length;a++)t.children[a]instanceof J&&(n+="        this.".concat(e.camelize(t.children[a].name),".update(delta);\n"));return n+="    }\n",n+="}"}}]),e}();function an(e){i.a.useRef(null);return Object(j.jsx)("div",{children:Object(j.jsxs)(vt.a,{open:e.open,onClose:e.handleClose,scroll:"paper","aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:[Object(j.jsx)(ut.a,{id:"scroll-dialog-title",children:"Particle System Code"}),Object(j.jsx)(dt.a,{dividers:!0,children:Object(j.jsx)(Bt,{value:e.content,onChange:function(){}})}),Object(j.jsx)(ht.a,{children:Object(j.jsx)(d.a,{onClick:e.handleClose,color:"primary",children:"Confirm"})})]})})}var on=n(189),sn=n.n(on),cn=n(190),ln=n.n(cn),un=n(84),dn=n.n(un),hn=n(191),pn=n.n(hn),mn=function(e){var t,n,r=i.a.useState(""),a=Object(Ue.a)(r,2),o=a[0],s=a[1],c=i.a.useState(["1"]),l=Object(Ue.a)(c,2),u=l[0],d=l[1],h=i.a.useState(""),p=Object(Ue.a)(h,2),v=p[0],w=p[1],b=function e(t,n){if(0===t)return[n,0];t--;var r,i=Object(He.a)(n.children);try{for(i.s();!(r=i.n()).done;){var a=e(t,r.value),o=Object(Ue.a)(a,2),s=o[0],c=o[1];if(s)return[s,c];t=c}}catch(l){i.e(l)}finally{i.f()}return[null,t]},g=function(t,n){if(n.length>0){var r=parseInt(n),i=b(r,e.scene),a=Object(Ue.a)(i,1)[0];a&&e.context.actions.select(a)}s(n)},x=function(e,t){"svg"===e.target.tagName&&d(t)},y=function(e){var t="object";t=e instanceof J?"ParticleSystem":e.type;var n="unnamed";return e.name&&(n=e.name),"[".concat(t,"] ").concat(n)},O=function e(t,n,r){var a=[],o=r;r++;var s,c=Object(He.a)(n.children);try{for(c.s();!(s=c.n()).done;){var l=e(t,s.value,r);a.push(l[0]),r=l[1]}}catch(u){c.e(u)}finally{c.f()}if(0!==o){switch(n.type){default:Object(j.jsx)(dn.a,{});break;case"AmbientLight":Object(j.jsx)(sn.a,{});break;case"Group":Object(j.jsx)(ln.a,{})}return[Object(j.jsx)(nn.a,{nodeId:o+"",label:Object(j.jsx)(en.MenuProvider,{id:"scene-graph-menu",data:{object3d:n},children:y(n)+" "+o}),children:a},n.uuid),r]}return[Object(j.jsx)(i.a.Fragment,{children:a}),r]};return Object(j.jsxs)(m.a,{sx:{height:270,flexGrow:1,overflow:"auto"},children:[Object(j.jsx)(f.a,{sx:{fontSize:function(e){return e.typography.pxToRem(15)},fontWeight:function(e){return e.typography.fontWeightRegular}},children:" Scene Graph "}),(t=e.context,n=e.scene,Object(j.jsx)(tn.a,{sx:{height:240,flexGrow:1},selected:o,expanded:u,onNodeToggle:x,onNodeSelect:g,defaultCollapseIcon:Object(j.jsx)(Dt.a,{}),defaultExpandIcon:Object(j.jsx)(pn.a,{}),multiSelect:!1,children:O(t,n,0)[0]})),Object(j.jsxs)(en.Menu,{id:"scene-graph-menu",children:[Object(j.jsxs)(en.Submenu,{label:"Add",children:[Object(j.jsx)(en.Item,{onClick:function(t){t.event;var n=t.props;n.object3d&&e.context.actions.addObject3d("particle",n.object3d)},children:"Particle System"}),Object(j.jsx)(en.Item,{onClick:function(e){var t=e.event,n=e.props;return console.log(t,n)},children:"Ball"})]}),Object(j.jsx)(en.Separator,{}),Object(j.jsx)(en.Item,{onClick:function(t){t.event;var n=t.props;n.object3d&&e.context.actions.duplicateObject3d(n.object3d)},children:"Duplicate"}),Object(j.jsx)(en.Item,{onClick:function(t){t.event;var n=t.props;n.object3d&&e.context.actions.removeObject3d(n.object3d)},children:"Remove"}),Object(j.jsx)(en.Separator,{}),Object(j.jsx)(en.Item,{onClick:function(e){e.event;var t=e.props;if(console.log(t),t.object3d){var n=document.createElement("a"),r=t.object3d.toJSON(),i=new Blob([JSON.stringify(r)],{type:"application/json"});n.href=URL.createObjectURL(i),n.download="scene.json",n.click()}},children:"Export"}),Object(j.jsx)(en.Item,{onClick:function(e){e.event;var t=e.props;t.object3d&&w(rn.exportCode(t.object3d))},children:"Copy JS Code"})]}),Object(j.jsx)(an,{content:v,open:""!==v,handleClose:function(){w("")}})]})},vn=function(e){return Object(j.jsx)(_e,{children:Object(j.jsxs)("div",{className:"application",children:[Object(j.jsx)("div",{className:"main-menu",children:Object(j.jsx)(Ve,{children:function(e){return e&&Object(j.jsx)(y,{onSaveAs:e.actions.onSaveAs,onImport:e.actions.onImport,onOpenDemo:e.actions.onOpenDemo})}})}),Object(j.jsxs)("div",{className:"main",children:[Object(j.jsx)("div",{className:"viewport",children:Object(j.jsx)(Ae,{width:600,height:600})}),Object(j.jsxs)("div",{className:"sidebar",children:[Object(j.jsx)(Ve,{children:function(e){return e&&Object(j.jsx)(mn,{context:e,scene:e.scene})}}),Object(j.jsx)(Ve,{children:function(e){return e&&e.selection.length>0&&Object(j.jsx)(Kt,{object3d:e.selection[0]})}})]})]})]})})},fn=n(48),wn=n(49),bn=n(193),gn=n(402),xn=Object(bn.a)({palette:{primary:{main:fn.a[500]},secondary:{main:wn.a[500]}},typography:{fontSize:12}}),jn=function(){return Object(j.jsx)(gn.a,{theme:xn,children:Object(j.jsx)(vn,{})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(j.jsx)(jn,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[348,1,2]]]);
//# sourceMappingURL=main.a259d87e.chunk.js.map